(function(){return function(_a){var _b;this.registerScript(_a,function(){this.rMateChartH5License="8bcf6ea4e45993d188862879f69f55a2555e0381b7e0437d6a0428bea032436d:3600330b3848443a4f4220504c20564f3a3632302e36302d2032504656353a46432d35382d3345364e442d2d36302e3430372d42453a564c41204c312033452f4c303a31742f203243323a303232303a32453220302a373a324839";this.rMateChartCurrentChartObj;this.rMateChartChartIDArr=new Array();this.rMateChartScriptURLArr=new Array();this.rMateChartChartVarsArr=new Array();this.rMateChartLastInvokeID=new Array();this.rMateChartCreate=function(_c,_d,_e,_f){if(!this.rMateChartChartIDArr){this.rMateChartChartIDArr=new Array();}if(!this.rMateChartScriptURLArr){this.rMateChartScriptURLArr=new Array();}if(!this.rMateChartChartVarsArr){this.rMateChartChartVarsArr=new Array();}if(!this.rMateChartLastInvokeID){this.rMateChartLastInvokeID=new Array();}this.rMateChartChartIDArr.push(_c.name);this.rMateChartScriptURLArr.push(_d);this.rMateChartChartVarsArr[this.rMateChartChartVarsArr.length]=_f;this.rMateChartLastInvokeID.push("");_c.addEventHandler("onloadcompleted",this.rMateChart_DocumentComplete);_c.addEventHandler("onusernotify",this.rMateChart_UserNotify);_c.set_url(_e);};this.rMateChartClear=function(_c){if(_c==null){return;}_c.removeEventHandler("onloadcompleted",this.rMateChart_DocumentComplete);_c.removeEventHandler("onusernotify",this.rMateChart_UserNotify);_c.destroy();_c=null;};this.rMateChartSetTheme=function(_c,_d){if(_c._ifrm_elem._plugin_object){var _e=_c.getProperty("Document").getProperty("parentWindow");_e.callMethod("rMateChartSetTheme",_d);}else{_c._ifrm_elem._window.rMateChartSetTheme(_d);}};this.rMateChartSetLayout=function(_c,_d){if(_c._ifrm_elem._plugin_object){var _e=_c.getProperty("Document").getProperty("parentWindow");_e.callMethod("rMateChartSetLayout",_d);}else{_c._ifrm_elem._window.rMateChartSetLayout(_d);}};this.rMateChartSetLayoutURL=function(_c,_d){if(_c._ifrm_elem._plugin_object){var _e=_c.getProperty("Document").getProperty("parentWindow");_e.callMethod("rMateChartSetLayoutURL",_d);}else{_c._ifrm_elem._window.rMateChartSetLayoutURL(_d);}};this.rMateChartSetSlideLayoutSet=function(_c,_d){if(_c._ifrm_elem._plugin_object){var _e=_c.getProperty("Document").getProperty("parentWindow");if(typeof (_d)=="string"){_e.callMethod("rMateChartSetSlideLayoutSet",_d);}else{var _f="[";for(var _h=0;_h<_d.length;_h++ ){if(typeof (_d[_h])=="object"){_f+="{";var _g="";for(var _i in _d[_h]){if(_g!=""){_g+=",";}_g+=_i+":";if(typeof (_d[_h][_i])=="string"){_g+=this.rMateChartEncodeParamStr(_d[_h][_i]);}else{_g+=_d[_h][_i];}}_f+=_g+"}";}else{_f+=this.rMateChartEncodeParamStr(_d[_h].toString());}if(_h<_d.length-1){_f+=",";}}_f+="]";_e.callMethod("rMateChartSetSlideLayoutSet",_f);}}else{_c._ifrm_elem._window.rMateChartSetSlideLayoutSet(_d);}};this.rMateChartSetData=function(_c,_d){if(_c._ifrm_elem._plugin_object){var _e=_c.getProperty("Document").getProperty("parentWindow");if(typeof (_d)=="string"){_e.callMethod("rMateChartSetData",_d);}else{var _f="[";for(var _h=0;_h<_d.length;_h++ ){if(typeof (_d[_h])=="object"){_f+="{";var _g="";for(var _i in _d[_h]){if(_g!=""){_g+=",";}_g+=_i+":";if(typeof (_d[_h][_i])=="string"){_g+=this.rMateChartEncodeParamStr(_d[_h][_i]);}else{_g+=_d[_h][_i];}}_f+=_g+"}";}else{_f+=this.rMateChartEncodeParamStr(_d[_h].toString());}if(_h<_d.length-1){_f+=",";}}_f+="]";_e.callMethod("rMateChartSetData",_f);}}else{_c._ifrm_elem._window.rMateChartSetData(_d);}};this.rMateChartSetDataURL=function(_c,_d){if(_c._ifrm_elem._plugin_object){var _e=_c.getProperty("Document").getProperty("parentWindow");_e.callMethod("rMateChartSetDataURL",_d);}else{_c._ifrm_elem._window.rMateChartSetDataURL(_d);}};this.rMateChartSetSlideDataSet=function(_c,_d){if(_c._ifrm_elem._plugin_object){var _e=_c.getProperty("Document").getProperty("parentWindow");if(typeof (_d)=="string"){_e.callMethod("rMateChartSetSlideDataSet",_d);}else{var _f=this.rMateChartEncodeJavaScriptObj(_d);_e.callMethod("rMateChartSetSlideDataSet",_f);}}else{_c._ifrm_elem._window.rMateChartSetSlideDataSet(_d);}};this.rMateChartGetSnapshot=function(_c){if(_c._ifrm_elem._plugin_object){var _d=_c.getProperty("Document").getProperty("parentWindow");_d.callMethod("rMateChartGetSnapshot");var _e=_c.document.getElementById("invokeData");return _e.value;}else{return _c._ifrm_elem._window.rMateChartGetSnapshot();}};this.rMateChartSaveAsImage=function(_c){if(_c._ifrm_elem._plugin_object){var _d=_c.getProperty("Document").getProperty("parentWindow");_d.callMethod("rMateChartSaveAsImage");}else{_c._ifrm_elem._window.rMateChartSaveAsImage();}};this.rMateChartLegendAllCheck=function(_c,_d){if(_c._ifrm_elem._plugin_object){var _e=_c.getProperty("Document").getProperty("parentWindow");_e.callMethod("rMateChartLegendAllCheck",_d);}else{_c._ifrm_elem._window.rMateChartLegendAllCheck(_d);}};this.rMateChartShowAdditionalPreloader=function(_c){if(_c._ifrm_elem._plugin_object){var _d=_c.getProperty("Document").getProperty("parentWindow");_d.callMethod("rMateChartShowAdditionalPreloader");}else{_c._ifrm_elem._window.rMateChartShowAdditionalPreloader();}};this.rMateChartRemoveAdditionalPreloader=function(_c){if(_c._ifrm_elem._plugin_object){var _d=_c.getProperty("Document").getProperty("parentWindow");_d.callMethod("rMateChartRemoveAdditionalPreloader");}else{_c._ifrm_elem._window.rMateChartRemoveAdditionalPreloader();}};this.rMateChartShowDataEditor=function(_c){if(_c._ifrm_elem._plugin_object){var _d=_c.getProperty("Document").getProperty("parentWindow");_d.callMethod("rMateChartShowDataEditor");}else{_c._ifrm_elem._window.rMateChartShowDataEditor();}};this.rMateChartRemoveDataEditor=function(_c){if(_c._ifrm_elem._plugin_object){var _d=_c.getProperty("Document").getProperty("parentWindow");_d.callMethod("rMateChartRemoveDataEditor");}else{_c._ifrm_elem._window.rMateChartRemoveDataEditor();}};this.rMateChartGetChartData=function(_c){if(_c._ifrm_elem._plugin_object){var _d=_c.getProperty("Document").getProperty("parentWindow");return _d.callMethod("rMateChartGetChartData");}else{return _c._ifrm_elem._window.rMateChartGetChartData();}};this.rMateChartHasNoData=function(_c,_d){if(_c._ifrm_elem._plugin_object){var _e=_c.getProperty("Document").getProperty("parentWindow");_e.callMethod("rMateChartHasNoData",_d);}else{_c._ifrm_elem._window.rMateChartHasNoData(_d);}};this.rMateChartDownloadlToLocal=function(_c,_d,_e,_f){if(_c._ifrm_elem._plugin_object){var _g=_c.getProperty("Document").getProperty("parentWindow");_g.callMethod("rMateChartDownloadlToLocal",_d,_e,_f);}else{_c._ifrm_elem._window.rMateChartDownloadlToLocal(_d,_e,_f);}};this.rMateChartEncodeParamStr=function(_c){if(_c==null){return "null";}var _d="'";var _e=/'/g;var _f=/\n/g;_d+=_c.replace(_e,"\\'").replace(_f,"");_d+="'";return _d;};this.rMateChartEncodeJavaScriptObj=function(_b){switch(typeof (_b)){case "number":return _b.toString();case "boolean":return _b.toString();case "string":return this.rMateChartEncodeParamStr(_b);case "null":return "null";case "undefined":return "undefined";case "object":var _c="";if(_b.length){_c="[";for(var _e=0;_e<_b.length;_e++ ){if(_e>0){_c+=",";}_c+=this.rMateChartEncodeJavaScriptObj(_b[_e]);}_c+="]";}else{_c+="{";var _d="";for(var _f in _b){if(_d!=""){_d+=",";}_d+=_f+":";_d+=this.rMateChartEncodeJavaScriptObj(_b[_f]);}_c+=_d+"}";}return _c;default:trace("rMateChartEncodeXML unknown type:"+typeof (_b));return "undefined";}return "undefined";};this.rMateChartFindChartIDArr=function(_c){if(_c==null){return  -1;}for(var _d=0;_d<this.rMateChartChartIDArr.length;_d++ ){if(_c==this.rMateChartChartIDArr[_d]){return _d;}}return  -1;};this.rMateChart_DocumentComplete=function(_b,_c){var _d;if(_b["rMateChartCreate"]){_d=_b;}else{_d=_b;while(_d["parent"]){if(_d["parent"]["rMateChartCreate"]){_d=_d.parent;break;}_d=_d.parent;}}if(!_d){trace("rMateChart_UserNotify Can't find parent Form:"+_b.name);return;}var _e=_d.rMateChartFindChartIDArr.call(_d,_b.name);if(_e<0){trace("rMateChart_DocumentComplete Can't find chart id:"+_b.name);return;}if(_b._ifrm_elem._plugin_object){var _f=_b.getProperty("Document").getProperty("parentWindow");_f.callMethod("rMateChartSetLicense",_d.rMateChartH5License);_f.callMethod("rMateChartCreate",_b.name,_d.rMateChartScriptURLArr[_e],_d.rMateChartChartVarsArr[_e],"100%","100%","#FFFFFF");}else{_b._ifrm_elem._window.rMateChartSetLicense(_d.rMateChartH5License);_b._ifrm_elem._window.rMateChartCreate(_b.name,_d.rMateChartScriptURLArr[_e],_d.rMateChartChartVarsArr[_e],'100%','100%','#FFFFFF');}};this.rMateChart_UserNotify=function(_b,_c){var _d;if(_b["rMateChartCreate"]){_d=_b;}else{_d=_b;while(_d["parent"]){if(_d["parent"]["rMateChartCreate"]){_d=_d.parent;break;}_d=_d.parent;}}if(!_d){trace("rMateChart_UserNotify Can't find parent Form:"+_b.name);return;}_d.rMateChartCurrentChartObj=_b;var _e=_c.userdata;if(_e.indexOf("invoked")!=0){return;}var _f=_d.rMateChartFindChartIDArr.call(_d,_b.name);if(_f<0){trace("rMateChart_UserNotify Can't find chart id:"+_b.name);return;}if(_e==_d.rMateChartLastInvokeID[_f]){return;}_d.rMateChartLastInvokeID[_f]=_e;if(_b._ifrm_elem._plugin_object){var _g=_b.getProperty("Document").getProperty("parentWindow");var _h=_g.getProperty("invokeData");_e=_h;}else{var _g=_b.document;var _h=_g.getElementById("invokeData");_e=_h.value;}var _i;var _j;if(_e==null){return;}if(_e.indexOf("<")!=0){return;}var _k,_l;var _m,_n;var _o,_p;if(_g){_l=new DomParser;_l.onParseError=_d.rMateChartParseErrorHandler;_k=_l.parseFromString(_e,"text/xml");_m=_k.getElementsByTagName("invoke");if(_m.length>0){_n=_m[0].getAttribute("name");}_o=_k.getElementsByTagName("arguments");if(_o.length>0&&_o[0].childNodes&&_o[0].childNodes.length>0){_p=[];for(i=0;i<_o[0].childNodes.length;i++ ){if(_o[0].childNodes[i]){var _q=_d.rMateChartParseArgNode.call(_d,_o[0].childNodes[i]);_p[i]=_q;}}}}else{if(eval("window.DOMParser")){_l=eval("new DOMParser()");_k=_l.parseFromString(_e,"text/xml");}else{_k=eval("new ActiveXObject('Microsoft.XMLDOM')");eval("xmlDoc.async = false;");_k.loadXML(_e);if(_k.parseError.errorCode!=0){trace("rMateChart_UserNotify Parse Error: "+_k.parseError.reason+" (line: "+_k.parseError.line+", linepos: "+_k.parseError.linepos+")");_k=null;return;}}_m=_k.getElementsByTagName("invoke");if(_m.length>0){_n=_m[0].getAttribute("name");}_o=_k.getElementsByTagName("arguments");if(_o.length>0&&_o[0].childNodes&&_o[0].childNodes.length>0){_p=[];for(i=0;i<_o[0].childNodes.length;i++ ){if(_o[0].childNodes[i]){var _q=_d.rMateChartParseArgNode.call(_d,_o[0].childNodes[i]);_p[i]=_q;}}}}if(typeof (_d[_n])=="function"){var _r=_d[_n];if(_p&&_p.length>0){_i=_r.apply(_d,_p);}else{_i=_r.apply(_d);}_j=0;}else{trace("rMateChart_UserNotify error : invalid invoke name "+_n);}_l=null;_k=null;return _j;};this.rMateChartEncodeXML=function(_c){var _d;switch(typeof (_c)){case "number":return "<number>"+_c+"</number>";case "string":return "<string><"+"![CDATA["+_c+"]]"+"></string>";case "null":return "<null/>";case "undefined":return "<undefined/>";case "boolean":if(_c){return "<true/>";}else{return "<false/>";}case "object":if(_c.length){_d="<array>";for(var _e=0;_e<_c.length;_e++ ){_d+="<property id=\""+_e+"\">";_d+=this.rMateChartEncodeXML(_c[_e]);_d+="</property>";}_d+="</array>";}else{_d="<object>";for(var _f in _c){_d+="<property id=\""+_f+"\">";_d+=this.rMateChartEncodeXML(_c[_f]);_d+="</property>";}_d+="</object>";}return _d;default:trace("rMateChartEncodeXML unknown type:"+typeof (_c));return "<undefined/>";}return "<undefined/>";};this.getNodeText=function(_c){if(_c.childNodes.length>0){_c=_c.childNodes[0];}if(_c.nodeValue){return _c.nodeValue;}else if(_c.text){return _c.text;}else if(_c.textContent){return _c.textContent;}return null;};this.rMateChartParseArgNode=function(_c){var _d=_c.nodeName;switch(_d){case "number":return Number(this.getNodeText(_c));case "string":return unescape(this.getNodeText(_c));case "undefined":return undefined;case "null":return null;case "true":return true;case "false":return false;case "bool":if(this.getNodeText(_c)=="true"){return true;}else{return false;}case "object":var _b={};if(_c.childNodes&&_c.childNodes.length>0){for(var _f=0;_f<_c.childNodes.length;_f++ ){if(_c.childNodes[_f].nodeName=="property"){_b[_c.childNodes[_f].attributes.getNamedItem("id").value]=this.rMateChartParseArgNode(_c.childNodes[_f].childNodes[0]);}}}return _b;case "array":var _e=[];if(_c.childNodes&&_c.childNodes.length>0){for(var _g=0;_g<_c.childNodes.length;_g++ ){if(_c.childNodes[_g].nodeName=="property"){_e[_g]=this.rMateChartParseArgNode(_c.childNodes[_g].childNodes[0]);}}}return _e;default:trace("rMateChartParseArgNode unknown type:"+_d);}return null;};this.rMateChartParseErrorHandler=function(_c,_d){trace("rMateChartParseErrorHandler Parse Error: "+_d.message+" (line: "+_d.line+", column: "+_d.column+")");};this.rMateChartDataSetToXml=function(_b){var _c="<items>\n";for(var _d=0;_d<_b.rowcount;_d++ ){_c+="<item>\n";for(var _e=0;_e<_b.getColCount();_e++ ){if(_b.getColumn(_d,_e)!=null){_c+=" <"+_b.getColID(_e)+">"+this.rMateChartXmlEncoder(_b.getColumn(_d,_e).toString())+"</"+_b.getColID(_e)+">\n";}}_c+="</item>\n";}_c+="</items>";return _c;};this.rMateChartDataSetToXmlWithColumn=function(_c,_d){if(_d==null){return this.rMateChartDataSetToXml(_c);}var _e=_d.split(",");var _f="<items>";for(var _g=0;_g<_c.rowcount;_g++ ){_f+="<item>";for(var _h=0;_h<_e.length;_h++ ){_f+="<"+_e[_h]+">"+this.rMateChartXmlEncoder(_c.getColumn(_g,_e[_h]).toString())+"</"+_e[_h]+">";}_f+="</item>\n";}_f+="</items>";return _f;};this.rMateChartDataSetToArray=function(_b){var _c=[];for(var _e=0;_e<_b.rowcount;_e++ ){var _d={};for(var _f=0;_f<_b.getColCount();_f++ ){if(_b.getColumn(_e,_f)!=null){_d[_b.getColID(_f)]=this.rMateChartXmlEncoder(_b.getColumn(_e,_f).toString());}}_c.push(_d);}return _c;};this.rMateChartDataSetToArrayWithColumn=function(_c,_d){if(_d==null){return this.rMateChartDataSetToXml(_c);}var _e=_d.split(",");var _f=[];for(var _h=0;_h<_c.rowcount;_h++ ){var _g={};for(var _i=0;_i<_e.length;_i++ ){_g[_e[_i]]=this.rMateChartXmlEncoder(_c.getColumn(_h,_e[_i]).toString());}_f.push(_g);}return _f;};this.rMateChartXmlEncoder=function(_c){var _d="";if(_c!=null&&_c.length>0){_d=_c.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;");}return _d;};});this.loadIncludeScript(_a);_b=null;};})();