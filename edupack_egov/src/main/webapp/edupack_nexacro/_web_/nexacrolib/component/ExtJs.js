var pForm=nexacro.Form.prototype;pForm.cfnFormLoad=function(_a){var _b=_a.components;for(var _c=0;_c<_b.length;_c++ ){if(_b[_c] instanceof nexacro.Div){pForm.cfnFormLoad(_b[_c].form);}else{if(_b[_c] instanceof nexacro.Calendar){if(_b[_c].uCalType=="Month"){_b[_c].addEventHandler("ondropdown",this.cfn_calendarMonth,this);}}}}};pForm.cfn_calendarMonth=function(_a){var _b=this.gfnGetCompId(_a);if(this.gfnIsNull(this.components[_b])){var _c=new PopupDiv();_c.init(_b,0,0,200,190);this.addChild(_b,_c);_c.set_cssclass("pdiv_WF_Area");_c.set_url("Work::EduComm_CalMonth_Sub.xfdl");_c.show();_c.calObj=_a;}else{var _c=this.components[_b];}_c.trackPopupByComponent(_a,0,_a.height);};pForm.cfnSetMultiCombo=function(_a){var _b=_a.innerdataset;var _c=_a.codecolumn;var _d=_a.datacolumn;var _e=_a.displayrowcount;if(this.gfnIsNull(_e)){_e=10;}if(this.gfnIsNull(_b)||this.gfnIsNull(_c)||this.gfnIsNull(_d)){alert("InnerDataset Error");return;}var _f=this.all[_b];if(this.gfnIsNull(_f)){alert("InnerDataset Object Error");return;}var _g=this.gfnGetCompId(_a);var _h=_g.substr(this.name.length+1);var _i=nexacro.replaceAll(_h,".","_");var _j="ds_"+_b+_i;var _k=this.all[_j];if(this.gfnIsNull(_k)){_k=new Dataset();this.addChild(_j,_k);_k.addColumn("_CHK","STRING");_k.addColumn(_c,"STRING");_k.addColumn(_d,"STRING");_k.set_enableevent(false);var _l=_f.getRowCount();for(var _y=0;_y<_l;_y++ ){_k.addRow();_k.setColumn(_y,"_CHK","0");_k.setColumn(_y,_c,_f.getColumn(_y,_c));_k.setColumn(_y,_d,_f.getColumn(_y,_d));}_k.set_enableevent(true);if(_l<_e){_e=_l;}}var _m="_pdv_"+_i;var _n=this.components[_m];if(this.gfnIsNull(_n)){_n=new PopupDiv();_n.init(_m,_a.getOffsetLeft(),_a.getOffsetBottom(),100,100);this.addChild(_m,_n);_n.set_cssclass("pdiv_WF_Area");_n.show();var _o={combo:_a,dataset:_k,innerdataset:_b,codecolumn:_c,datacolumn:_d};_n.uParam=_o;_n.addEventHandler("oncloseup",this._pdivMultiComboClose,this);}var _p=_n.form.components["_grdCombo"];if(this.gfnIsNull(_p)){_p=new Grid();_p.init("_grdCombo",0,0,null,null,0,0);_n.addChild("_grdCombo",_p);_p.set_binddataset(_k.name);_p.createFormat();_p.setFormatRowProperty(0,"size",30);_p.setFormatRowProperty(1,"size",30);_p.mergeCell(1,2, -1, -1);_p.setCellProperty("head",0,"displaytype","checkboxcontrol");_p.setCellProperty("head",0,"text","0");_p.setCellProperty("head",1,"text","Select All");_p.setCellProperty("body",0,"displaytype","checkboxcontrol");_p.setCellProperty("body",0,"edittype","checkbox");_p.set_border("0px none");_p.set_autosizingtype("col");_p.set_scrollbarsize(10);_p.show();_p.addEventHandler("onheadclick",this._gfnHeadCheckSelectAll,this);var _q=_p.getRealColFullSize();var _r=_p.getRealColSize(0);var _s=_p.getRealColSize(1);var _t=_p.getRealColSize(2);var _u=_p.getRealRowSize( -1);var _v=_p.getRealRowSize(0);var _w=_p.scrollbarsize;var _x=_a.getOffsetWidth()-2;if(_x>_q){_p.set_autosizingtype("none");_p.setRealColSize("body",0,_r+10);_p.setRealColSize("body",1,_s+10);if(_l>_e){_p.setRealColSize("body",2,_x-_r-_s-_w-20);}else{_p.setRealColSize("body",2,_x-_r-_s-20);}_n.set_width(_x+2);}else{_n.set_width(_q+_w+2);}_n.set_height(_u+(_v* _e)+2);}_a.set_text("멀티선택");_n.trackPopupByComponent(_a,0,_a.height);};pForm._pdivMultiComboClose=function(_a,_b){var _c=_a.uParam.dataset;var _d=_a.uParam.combo;var _e=[];var _f=[];for(var _k=0;_k<_c.getRowCount();_k++ ){if(_c.getColumn(_k,"_CHK")=="1"){_e.push(_c.getColumn(_k,_a.uParam.datacolumn));_f.push(_c.getColumn(_k,_a.uParam.codecolumn));}}var _g=_e.toString();var _h=_f.toString();this._setComboText(_a.uParam,_e,_f);var _i=_d.getEventHandler("oncloseup",0);var _j=new nexacro.ComboCloseUpEventInfo();_j.posttext=_g;_j.postvalue=_h;_i.call(this,_d,_j);};pForm._setComboText=function(_a,_b,_c){var _d=_b.toString();var _e=nexacro.getTextSize(_d,"normal 14px/normal 'Verdana,Malgun Gothic'");var _f=_a.combo.getOffsetWidth()-_a.combo.getOffsetHeight();_a.combo.returntext=_d;_a.combo.returnvalue=_c.toString();_a.combo.set_innerdataset("");_a.combo.set_codecolumn("");_a.combo.set_datacolumn("");if(_f>_e.nx){_a.combo.set_text(_d);}else{_a.combo.set_text(_b.length+"개 선택");_a.combo.set_tooltiptext(_d);_a.combo.set_tooltiptype("hover");}if(this.gfnIsNull(_d)){_a.combo.set_text("멀티선택");}_a.combo.set_innerdataset(_a.innerdataset);_a.combo.set_codecolumn(_a.codecolumn);_a.combo.set_datacolumn(_a.datacolumn);};var pCombo=nexacro.Combo.prototype;pCombo.get_value=function(){return this.returnvalue;};pCombo.get_text=function(){return this.returntext;};
var pForm=nexacro.Form.prototype;pForm.FRAME_MDI_MAX_CNT=15;pForm.FRAME_IS_COMBTN_USE=false;pForm.FRAME_IS_AUTOKILLFOCUS=false;pForm.FRAME_REAL_TRACE_FN=trace;pForm.FRAME_MENUCOLUMNS={menuId:"MENU_ID",menuNm:"MENU_NAME",pageUrl:"MENU_URL",pageId:"PAGE_ID",winId:"WIN_ID",title:"TITLE",menuUrl:"MENU_URL",groupId:"MENU_GROUP",menuLevel:"MENU_LEVEL",upMenuId:"MENU_PID",menuPath:"MENU_PATH"};pForm.gfnFormOnLoad=function(_a){if(_a.parent.name=="divWork"){var _b=_a.gfnGetApplication();var _c=_b.sStartDate;var _d=_b.nStartTime;var _e=new Date();var _f=_e.getYear()+"-"+String(_e.getMonth()).padLeft(2,'0')+"-"+String(_e.getDate()).padLeft(2,'0')+" "+String(_e.getHours()).padLeft(2,'0')+":"+String(_e.getMinutes()).padLeft(2,'0')+":"+String(_e.getSeconds()).padLeft(2,'0')+" "+_e.getMilliseconds();var _g=(_e.getTime()-_d)/1000;_a.parent.parent.staLodingTime.set_text("해당 화면의 loading 시간은 "+ +_g+" Sec 입니다.");_a.addEventHandler("onkeydown",this.gfnOnkeydown,this);if(this.FRAME_IS_AUTOKILLFOCUS){this.gfnSetAutoKillfocus(_a);}}if(_a.opener){if(_a.parent instanceof nexacro.ChildFrame){_a.addEventHandler("onkeydown",this.gfnOnkeydown,this);}if(this.FRAME_IS_AUTOKILLFOCUS){this.gfnSetAutoKillfocus(_a);}}if(nexacro.getEnvironmentVariable("evQuikView")=="Y"){if(this.gfnIsNull(_a.opener)&&_a.parent instanceof nexacro.ChildFrame){_a.addEventHandler("onkeydown",this.gfnOnkeydown,this);}}this.gfnInitComp(_a);this.gfnInitLang(_a);};pForm.gfnInitComp=function(_a){var _b=_a.components;var _c=_b.length;for(var _e=0;_e<_c;_e++ ){if(_b[_e] instanceof nexacro.Div){if(this.gfnIsNull(_b[_e].url)){this.gfnInitComp(_b[_e].form);}}else if(_b[_e] instanceof nexacro.Tab){var _d=_b[_e].tabpages.length;for(var _f=0;_f<_d;_f++ ){if(this.gfnIsNull(_b[_e].tabpages[_f].url)){this.gfnInitComp(_b[_e].tabpages[_f].form);}}}else{if(_b[_e] instanceof nexacro.Grid){this.gfnSetGrid(_b[_e]);}if(_b[_e] instanceof nexacro.Edit){if(_b[_e]._ms_clear=="true"){this._gfnSetEditMsClear(_b[_e]);}}if(_b[_e] instanceof nexacro.Calendar){if(_b[_e].uCalType=="MM"){_b[_e].addEventHandler("ondropdown",this.gfnCalMMOndropdown,this);}}}}};pForm.gfnOnkeydown=function(_a,_b){if(_b.ctrlkey&&_b.keycode==81){var _c={};var _d={popuptype:"modeless",title:"디 버 그",width:"850",height:"600"};this.gfnOpenPopup("debugging","Cmm::CmmDebug.xfdl",_c,"",_d);}};pForm.gfnCall=function(_a){if(!this.gfnIsNull(_a)&&typeof (_a)!="object"){return;}var _b=pForm.gfnGetApplication();var _c=_b.gdsOpenMenu;var _d=_a.ds;var _e=_a.nRow;var _f=_a.oArgs;var _g;if(!this.gfnIsNull(_a.sMenuId)){_g=_a.sMenuId;}else{_g=_d.getColumn(_e,this.FRAME_MENUCOLUMNS.menuId);}var _h=_c.lookup(this.FRAME_MENUCOLUMNS.menuId,_g,this.FRAME_MENUCOLUMNS.winId);if(!this.gfnIsNull(_h)){_b.avWorkFrame.frames[_h].setFocus();return;}if(this.FRAME_MDI_MAX_CNT<=_c.getRowCount()){alert(this.FRAME_MDI_MAX_CNT+"개 초과하여 화면을 열수 없습니다");return false;}this.gfnNewMdi(_g,_e,_f);};pForm.gfnCallSDI=function(_a){if(!this.gfnIsNull(_a)&&typeof (_a)!="object"){return;}var _b=pForm.gfnGetApplication();var _c=_b.gdsOpenMenu;var _d=_a.ds;var _e=_a.nRow;var _f=_a.oArgs;var _g;if(!this.gfnIsNull(_a.sMenuId)){_g=_a.sMenuId;}else{_g=_d.getColumn(_e,this.FRAME_MENUCOLUMNS.menuId);}if(system.navigatorname!="nexacro"){var _h="menu:"+_g;var _i={oArg:_a.oArgs};MyHistory.setLocationHash(_h,_i);}this.gfnNewSdi(_g,_f);};pForm.gfnNewMdi=function(_a,_b,_c){var _d=pForm.gfnGetApplication();var _e=_d.gdsOpenMenu;var _f=_d.gdsMenu;var _g="win"+_a+"_"+_e.getRowCount()+"_"+parseInt(Math.random()* 1000);var _h=_f.lookupAs(this.FRAME_MENUCOLUMNS.menuId,_a,this.FRAME_MENUCOLUMNS.pageUrl);var _i=_f.lookupAs(this.FRAME_MENUCOLUMNS.menuId,_a,this.FRAME_MENUCOLUMNS.groupId);var _j=new Date();var _k=_j.getTime();var _l=_j.getYear()+"-"+String(_j.getMonth()).padLeft(2,'0')+"-"+String(_j.getDate()).padLeft(2,'0')+" "+String(_j.getHours()).padLeft(2,'0')+":"+String(_j.getMinutes()).padLeft(2,'0')+":"+String(_j.getSeconds()).padLeft(2,'0')+" "+_j.getMilliseconds();_d.nStartTime=_k;_d.sStartDate=_l;var _m=this.FRAME_MENUCOLUMNS.menuNm;var _n=nexacro.getEnvironmentVariable("evLanguage");if(_n!="KO"){_m=_m+"_"+_n;}var _o=_f.lookupAs(this.FRAME_MENUCOLUMNS.menuId,_a,_m);var _p=_f.lookupAs(this.FRAME_MENUCOLUMNS.menuId,_a,this.FRAME_MENUCOLUMNS.menuPath);if(this.gfnIsNull(_h)){return;}this.gfnSetOpenMenuDs(_g,_a,_o,_h,_i);var _q=new ChildFrame();_q.init(_g,0,0,_d.avWorkFrame.getOffsetWidth(),_d.avWorkFrame.getOffsetHeight());_d.avWorkFrame.addChild(_g,_q);_q.arguments=[];_q.set_dragmovetype("all");_q.set_showtitlebar(false);_q.set_resizable(true);_q.set_openstatus("maximize");_q.set_titletext(_o);_q.set_showcascadetitletext(false);_q.arguments["winKey"]=_g;_q.arguments["menuId"]=_a;_q.arguments["menuNm"]=_o;_q.arguments["pageUrl"]=_h;_q.arguments["menuPath"]=_p;_q.arguments["oArgs"]=_c;_q.set_formurl("Frame::FrameWork.xfdl");_q.addEventHandler("onsize",_d.afnChildFrameOnSize,_d);_d.avMdiFrame.form.fnAddTab(_g,_o);_q.show();};pForm.gfnNewSdi=function(_a,_b){var _c=pForm.gfnGetApplication();var _d=_c.gdsOpenMenu;var _e=_c.gdsMenu;var _f=_e.lookupAs(this.FRAME_MENUCOLUMNS.menuId,_a,this.FRAME_MENUCOLUMNS.pageUrl);var _g=_e.lookupAs(this.FRAME_MENUCOLUMNS.menuId,_a,this.FRAME_MENUCOLUMNS.groupId);if(this.gfnIsNull(_f)){return;}var _h=new Date();var _i=_h.getTime();var _j=_h.getYear()+"-"+String(_h.getMonth()).padLeft(2,'0')+"-"+String(_h.getDate()).padLeft(2,'0')+" "+String(_h.getHours()).padLeft(2,'0')+":"+String(_h.getMinutes()).padLeft(2,'0')+":"+String(_h.getSeconds()).padLeft(2,'0')+" "+_h.getMilliseconds();_c.nStartTime=_i;_c.sStartDate=_j;var _k=this.FRAME_MENUCOLUMNS.menuNm;var _l=nexacro.getEnvironmentVariable("evLanguage");if(_l!="KO"){_k=_k+"_"+_l;}var _m=_e.lookupAs(this.FRAME_MENUCOLUMNS.menuId,_a,_k);var _n=_e.lookupAs(this.FRAME_MENUCOLUMNS.menuId,_a,this.FRAME_MENUCOLUMNS.menuPath);var _o=_c.avWorkFrame;_o.arguments=[];_o.arguments["winKey"]=_o.name;_o.arguments["menuId"]=_a;_o.arguments["menuNm"]=_m;_o.arguments["pageUrl"]=_f;_o.arguments["oArgs"]=_b;_o.arguments["menuPath"]=_n;trace(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>> "+_o.arguments["pageUrl"]);_o.set_url("SDIFrame::SDIFrameWork.xfdl");_o.form.fnSetLoad();};pForm.gfnSetOpenMenuDs=function(_a,_b,_c,_d,_e){var _f=pForm.gfnGetApplication();var _g=_f.gdsOpenMenu;var _h=_g.addRow();_g.setColumn(_h,this.FRAME_MENUCOLUMNS.winId,_a);_g.setColumn(_h,this.FRAME_MENUCOLUMNS.menuId,_b);_g.setColumn(_h,this.FRAME_MENUCOLUMNS.title,_c);_g.setColumn(_h,this.FRAME_MENUCOLUMNS.groupId,_e);_g.setColumn(_h,"MENU_URL",_d);};pForm.gfnGetArgument=function(_a){return this.getOwnerFrame().arguments[_a];};pForm.gfnGetServerUrl=function(){var _a="";if(system.navigatorname=="nexacro"){var _b=nexacro.getEnvironment();_a=_b.services["SvcUrl"].url;}else{_a=window.location.protocol+"//"+window.location.host;_a+="/edupack_egov/";}trace("urlPath : "+_a);return _a;};pForm.gfnGetApplication=function(){var _a=nexacro.getApplication();return _a;};pForm.gfnSetAutoKillfocus=function(_a){if(_a.u_autOnkillYn!="Y"){_a.addEventHandler("onlbuttonup",function(_a,_b){_a.u_autOnkillYn="Y";var _c=_a.getFocus();if(_c==null){return;}if(_c==_b.fromreferenceobject){return;}if(String(_b.fromreferenceobject)!="[object Static]"&&String(_b.fromreferenceobject)!="[object Div]"&&String(_b.fromreferenceobject)!="[object Tab]"&&String(_b.fromreferenceobject)!="[object Form]"){return;}var _d=this._gfnGetKiilFocusObj(_c);_d.setFocus(false);},_a);}};pForm._gfnGetKiilFocusObj=function(_a){var _b=_a.getOffsetLeft();var _c=_a.getOffsetTop();var _d="sImgKillFocus";var _e=_a.parent[_d];if(_e==null){var _f=new ImageViewer(_d,"absolute",_b,_c,0,0,null,null);_a.parent.addChild(_d,_f);_f.show();_f.set_tabstop(false);_f.set_taborder(parseInt(_a.taborder)+1);_e=_f;}else{_e.move(_b,_c);}return _e;};
var pForm=nexacro.Form.prototype;pForm.gfnIsNull=function(_a){if(new String(_a).valueOf()=="undefined"){return true;}if(_a==null){return true;}var _b=new String(_a);if(_b==null){return true;}if(_b.toString().length==0){return true;}return false;};pForm.gfnNvl=function(_a,_b){if(_a==null){_a=_b;}return _a;};pForm.gfnIsBoolean=function(_a){var _b=_a+"";if(_b=="true"||_b=="false"){return true;}else{return false;}};pForm.gfnDecode=function(){var _a=null;var _b=this.gfnDecode.arguments;var _c=_b[0];var _d=false;var _e=0;if((_b.length%2)==0){_e=_b.length-1;_d=true;}else{_e=_b.length;_d=false;}for(var _f=1;_f<_e;_f+=2){if(_c==_b[_f]){_a=_b[_f+1];_f=_e;}}if(_a==null&&_d){_a=_b[_b.length-1];}return _a;};pForm.gfnTrim=function(_a){if(this.gfnIsNull(_a)){return "";}return nexacro.trim(_a);};pForm.gfnAllTrim=function(_a){var _b=new String(_a);var _c="";var _d;if(_a!=null){for(var _d=0;_d<_b.length;_d++ ){if(_b.charAt(_d)!=" "){_c=_c+_b.charAt(_d);}}}else{return  -1;}return _c;};pForm.gfnLeft=function(_a,_b){return new String(_a).substr(0,_b);};pForm.gfnRight=function(_a,_b){if(this.gfnIsNull(_a)||this.gfnIsNull(_b)){return "";}if(_a.length<_b){return _a;}else{return _a.substr(_a.length-_b,_b);}};pForm.gfnLengthByte=function(_a){var _b=0;if(this.gfnIsNull(_a)){return  -1;}for(var _c=0;_c<_a.length;_c++ ){if(_a.charCodeAt(_c)>127){_b+=2;}else{_b+=1;}}return _b;};pForm.gfnPosReverse=function(_a,_b,_c){var _d;if(this.gfnIsNull(_a)||this.gfnIsNull(_b)){return  -1;}if(this.gfnIsNull(_c)){_c=_a.length-1;}for(_d=_c;_d>=0;_d-- ){if(_a.substr(_d,_b.length)==_b){break;}}return _d;};pForm.gfnAppendComma=function(_a,_b){if(_a==null){return "";}if(_b==null){_b=0;}_a=parseFloat(_a);_a=nexacro.round(_a,_b);var _c=new String(_a);var _d=_c.split(".");var _e="";var _f=0;for(i=_d[0].length-1;i>=0;i-- ){if(i!=_c.length&&_f==3){_e=_d[0].charAt(i)+","+_e;_f=0;}else{_e=_d[0].charAt(i)+_e;}_f++ ;}if(_d.length>1){_e=_e+"."+_d[1];}return _e;};pForm.gfnRemoveComma=function(_a){return _a.replace(/\,/g,"");};pForm.gfnGetDigit=function(_a){var _b=new RegExp("\\D","g");var _c=_a.replace(_b,"");return _c;};pForm.gfnRemoveSpecialChar=function(_a){var _b="~!@#$%^&*-+./=_`{|}()\\?<>";for(i=0;i<_a.length;i++ ){for(j=0;j<_b.length;j++ ){if(_a.charAt(i)==_b.charAt(j)){_a=_a.replace(_a.charAt(i),"");}}}return _a;};pForm.gfnRemoveHtmlTag=function(_a,_b){if(this.gfnIsNull(_b)){_a=nexacro.replaceAll(_a,"<br>","\n");_a=nexacro.replaceAll(_a,"<BR>","\n");var _c=new RegExp("<(/)?([0-9a-zA-Z]*)(\\s[0-9a-zA-Z]*=[^>]*)?(\\s)*(/)?>","g");_a=_a.replace(_c,"");}else if(_b.toUpperCase()=="<BR>"){_a=nexacro.replaceAll(_a,"<br>","\n");_a=nexacro.replaceAll(_a,"<BR>","\n");}else{_a=nexacro.replaceAll(_a,_b.toUpperCase(),"");_a=nexacro.replaceAll(_a,_b.toLowerCase(),"");}return _a;};pForm.gfnIsExistInArray=function(_a,_b){var _c=false;var _d=_a.length;for(var _e=0;_e<_d;_e++ ){if(_a[_e]==_b){_c=true;break;}}return _c;};pForm.gfn10To16=function(_a){var _b;_b=(_a).toString(16);return _b;};pForm.gfn16To10=function(_a){var _b;_b=(_a).toString(10);return _b;};pForm.gfnTypeOf=function(_a){var _b;if(_a&&(typeof _a=="object")){var _c=_a.toString();if(_c=="[object Object]"){return _b;}_b=_c.substr(8,_c.length-9);}else{_b=typeof (_a);}return _b;};pForm.gfnIsNexaComponent=function(_a){if(_a===null||_a===undefined){return false;}return _a instanceof nexacro.Component;};pForm.gfnObjView=function(_a,_b){for(var _c in _a){if(this.gfnIsNull(_b)==false){if(_c==_b){trace("name : "+_c+" / value : "+_a[_c]);}}else{trace("name : "+_c+" / value : "+_a[_c]);}}};pForm.gfnLookup=function(_a,_b){var _c;while(_a){_c=_a.components;if(_c&&_c[_b]){return _c[_b];}_c=_a.objects;if(_c&&_c[_b]){return _c[_b];}_a=_a.parent;}return null;};pForm.gfnLastIndexOfProp=function(_a,_b,_c,_d,_e){var _f,_g,_h;if(_d==null){_d=_a.length-1;}else if(_d<0){_d=Math.max(0,_a.length+_d);}var _e=_e||false;if(_e){for(_f=_d;_f>=0;_f-- ){if(_f in _a&&_a[_f]){_g=_a[_f],_h=_g[_b];if(_h===_c){return _f;}}}}else{for(_f=_d;_f>=0;_f-- ){if(_f in _a&&_a[_f]){_g=_a[_f],_h=_g[_b];if(_h==_c){return _f;}}}}return  -1;};pForm.gfnRemoveAt=function(_a,_b){_a.splice(_b,1);};pForm._ALPHA_CHAR_CODES=[48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102];pForm.gfnGetUniqueId=function(_a,_b){if(this.gfnIsNull(_a)){_a="";}if(this.gfnIsNull(_b)){_b=45;}else{_b=_b.charCodeAt(0);}var _c=this,_d=this._ALPHA_CHAR_CODES,_e=Math;var _f=0;var _g;var _h=new Array(36);var _i= -1;while(_f<8){_h[ ++_i]=_d[_e.random()* 16|0];_f++ ;}_f=0;while(_f<3){_h[ ++_i]=_b;_g=0;while(_g<4){_h[ ++_i]=_d[_e.random()* 16|0];_g++ ;}_f++ ;}_h[ ++_i]=_b;var _j=(new Date()).getTime();_j=("0000000"+_j.toString(16)).substr( -8);_f=0;while(_f<8){_h[ ++_i]=_j.charCodeAt(_f);_f++ ;}_f=0;while(_f<4){_h[ ++_i]=_d[_e.random()* 16|0];_f++ ;}return _a+String.fromCharCode.apply(null,_h);};pForm.gfnConvertXY=function(_a,_b,_c){var _d,_e;var _f,_g;if(_c){_d=system.clientToScreenX(_c,_b[0]);_e=system.clientToScreenY(_c,_b[1]);_f=system.screenToClientX(_a,_d)+this.gfnGetScrollLeft(_a);_g=system.screenToClientY(_a,_e)+this.gfnGetScrollTop(_a);}else{_f=_b[0];_g=_b[1];}return [_f,_g];};pForm.gfnGetScrollLeft=function(_a){if(_a instanceof nexacro.Div){_a=_a.form;}return (_a.hscrollbar&&_a.hscrollbar.visible?_a.hscrollbar.pos:0);};pForm.gfnGetScrollTop=function(_a){if(_a instanceof nexacro.Div){_a=_a.form;}return (_a.vscrollbar&&_a.vscrollbar.visible?_a.vscrollbar.pos:0);};pForm.gfnCopyProperties=function(_a,_b){if(_a&&_b){var _c,_d;for(_c in _b){if(_b.hasOwnProperty(_c)){_d=_b[_c];_a[_c]=_d;}}}};pForm.gfnGetSequenceId=function(_a,_b){if(this.gfnIsNull(_a)){trace("getSequenceId :: 1st argument doesn't exist !!");return null;}if(this.gfnIsNull(_b)){trace("getSequenceId :: 2nd argument doesn't exist !!");return null;}if(!(_a instanceof Form)){trace("getSequenceId :: 1st argument must be a Form !!");return null;}var _c=_a._sequenceIdCache;if(this.gfnIsNull(_c)){_c=_a._sequenceIdCache={};}var _d=_c[_b];if(this.gfnIsNull(_d)){_d= -1;}_d++ ;_c[_b]=_d;return _b+_d;};pForm.gfnEach=function(_a,_b,_c){var _d,_c=_c||_a;for(_d in _a){if(_a.hasOwnProperty(_d)){if(_b.call(_c,_d,_a[_d],_a)===false){return;}}}};pForm.gfnGetTopLevelForm=function(_a){var _b=_a;while(_b&&!(_b instanceof ChildFrame)){_b=_b.parent;}return _b.form;};pForm.gfnContains=function(_a,_b,_c){if(this.gfnIndexOf(_a,_b,null,_c)=== -1){return false;}else{return true;}};pForm.gfnIndexOf=function(_a,_b,_c,_d){var _e=_a.length;if(_c==null){_c=0;};_d==!!_d;_c=(_c<0)?Math.ceil(_c):Math.floor(_c);if(_c<0){_c+=_e;}if(_d){for(;_c<_e;_c++ ){if(_a[_c]===_b){return _c;}}}else{for(;_c<_e;_c++ ){if(_a[_c]==_b){return _c;}}}return  -1;};pForm.gfnUpdateToDataset=function(){var _a=this.getFocus();if(_a!=null){try{_a.updateToDataset();}catch(e){}}};pForm.gfnDsIsUpdated=function(_a){if(_a.getDeletedRowCount()>0){return true;}for(var _b=0;_b<_a.getRowCount();_b++ ){if(_a.getRowType(_b)==2||_a.getRowType(_b)==4||_a.getRowType(_b)==8){return true;}}return false;};pForm.gfnIsUpdatedRow=function(_a,_b){if(_a.updatecontrol==true){if(_a.getRowType(_b)==2||_a.getRowType(_b)==4){return true;}return false;}else{for(var _c=0;_a.getColCount();_c++ ){if(this.gfnIsUpdateColumn(_a,_b,_c)==true){return true;}}}return false;};pForm.gfnIsUpdateColumn=function(_a,_b,_c){if(_a.getRowType(_b)==2){if(this.gfnIsNull(_a.getColumn(_b,_c))){return false;}}else{if(_a.getColumn(_b,_c)==_a.getOrgColumn(_b,_c)){return false;}}return true;};pForm.gfnPostSearch=function(_a){var _b=nexacro.getApplication();if(!this.components[_a.name+"_webPost"]){var _c=new WebBrowser();_c.init(_a.name+"_webPost",_a.left,_a.top+_a.height+10,500,500,null,null);this.addChild(_a.name+"_webPost",_c);_c.show();}else{var _c=this.components[_a.name+"_webPost"];}var _d=nexacro.getEnvironment().services["SvcUrl"].url+"external/PostCall.jsp";_c.set_url(_d);_c.addEventHandler("onusernotify",this.gfnWebPost_onusernotify,this);};pForm.gfnWebPost_onusernotify=function(_a,_b){var _c=_b.userdata;if(_c.indexOf("OK!!!:::")==0){var _d=_c.split(":::");if(this["fnPostCallBack"]){this.lookupFunc("fnPostCallBack").call((_a.name).replace("_webPost",""),_d);}}};pForm.gfnPostSearchDaum=function(_a){var _b;_b=nexacro.getEnvironment().services["SvcUrl"].url+"external/PostPopWeb.html";_a.set_url(_b);};pForm.gfnIsDate=function(_a){if(this.gfnIsNull(_a)){return false;}var _b;switch(_a.length){case 6:_b=this.gfnIsYM(_a);break;case 8:_b=this.gfnIsYMD(_a);break;default:_b=false;break;}return _b;};pForm.gfnIsYMD=function(_a){var _b=this.gfnGetDigit(_a);if(_b.length!=8){return false;}var _c=_a.substr(0,6);if(!this.gfnIsYM(_c)){return false;}var _d=Number(_a.substr(6,2));var _e=Number(this.gfnGetLastDate(_c).substr(6,2));if(_d<1||_d>_e){return false;}return true;};pForm.gfnIsYM=function(_a){var _b=this.gfnGetDigit(_a);var _b=this.gfnGetDigit(_a);if(_b.length!=6){return false;}var _c=Number(_a.substr(0,4));var _d=Number(_a.substr(4,2));if((_d<1)||(_d>12)){return false;}return true;};pForm.gfnIsTime=function(_a){if(_a.length!=6||!isNumber(_a)){return false;}var _b=Number(_a.slice(0,2));var _c=Number(_a.slice(2,2));var _d=Number(_a.slice(4,2));if((_b<0||_b>23)||(_c<0||_c>59)||(_d<0||_d>59)){return false;}else{return true;}};pForm.gfnGetDate=function(_a){if(this.gfnIsNull(_a)){_a="date";}var _b=new Date();var _c;if(_a=="date"){_c=_b.getFullYear()+((_b.getMonth()+1)+"").padLeft(2,'0')+(_b.getDate()+"").padLeft(2,'0');}else if(_a=="time"){_c=_b.getFullYear()+((_b.getMonth()+1)+"").padLeft(2,'0')+(_b.getDate()+"").padLeft(2,'0')+(_b.getHours()+"").padLeft(2,'0')+(_b.getMinutes()+"").padLeft(2,'0')+(_b.getSeconds()+"").padLeft(2,'0');}else if(_a=="milli"){_c=_b.getFullYear()+((_b.getMonth()+1)+"").padLeft(2,'0')+(_b.getDate()+"").padLeft(2,'0')+(_b.getHours()+"").padLeft(2,'0')+(_b.getMinutes()+"").padLeft(2,'0')+(_b.getSeconds()+"").padLeft(2,'0')+(_b.getMilliseconds()+"").padLeft(3,'0');}return (_c);};pForm.gfnGetLastDate=function(_a){var _b="";if(_a==null){var _c=(new Date()).addMonth(1);}else{var _c=new Date(parseInt(_a.substr(0,4)),parseInt(_a.substr(4,2)),1);}_c=(new Date(_c)).addDate((new Date(_c)).getDate()*  -1);_b=(new Date(_c)).getFullYear()+(((new Date(_c)).getMonth()+1)+"").padLeft(2,'0')+((new Date(_c)).getDate()+"").padLeft(2,'0');return (_b);};pForm.gfnGetFirstDate=function(_a){var _b="";if(_a==null){var _c=new Date();_b=_c.getFullYear().toString()+(_c.getMonth()+1).toString().padLeft(2,"0")+"01";}else{var _d=new Date(parseInt(_a.substr(0,4)),parseInt(_a.substr(4,2))-1,1);_b=(new Date(_d)).getFullYear()+(((new Date(_d)).getMonth()+1)+"").padLeft(2,'0')+((new Date(_d)).getDate()+"").padLeft(2,'0');}return (_b);};pForm.gfnGetDay=function(_a){var _b=new Date();var _c=parseInt(_a.substr(0,4));var _d=parseInt(_a.substr(4,2)-1);var _e=parseInt(_a.substr(6,2));_b.setFullYear(_c,_d,_e);return _b.getDay();};pForm.gfnGetDiffDate=function(_a,_b){var _c=new Date(parseInt(_b.substring(0,4),10),parseInt(_b.substring(4,6)-1,10),parseInt(_b.substring(6,8),10));var _d=new Date(parseInt(_a.substring(0,4),10),parseInt(_a.substring(4,6)-1,10),parseInt(_a.substring(6,8),10));return parseInt((_c-_d)/(1000* 60* 60* 24));};pForm.gfnGetDiffMonth=function(_a,_b){var _c,_d;_c=parseInt(_a.substr(0,4),10)* 12+parseInt(_a.substr(4,2),10);_d=parseInt(_b.substr(0,4),10)* 12+parseInt(_b.substr(4,2),10);return (_d-_c);};pForm.gfnAddDate=function(_a,_b){var _c=new Date();var _d=parseInt(_a.substr(0,4));var _e=parseInt(_a.substr(4,2)-1);var _f=parseInt(_a.substr(6,2)-(_b*  -1));_c.setFullYear(_d,_e,_f);return this.gfnDateToStr(_c);};pForm.gfnAddMonth=function(_a,_b){var _c,_d,_e,_f,_g;var _h=function(_n){var _o;var _p=parseInt(_n.substr(0,4),10);var _q=parseInt(_n.substr(4,2),10);switch(_q){case 2:if(((_p%4)==0)&&((_p%100)!=0)||((_p%400)==0)){_o=29;}else{_o=28;}break;case 4:case 6:case 9:case 11:_o=30;break;default:_o=31;break;}return _o;};if(_a){_c=this.gfnStrToDate(_a);_d=(new Date(_c)).addMonth(_b);}else{_c=this.gfnStrToDate(this.gfnGetDate());_d=(new Date(_c)).addMonth(_b);}if(_h(_a)==_c.getDate()){var _i=new Date(_d).getFullYear();var _j=new Date(_d).getMonth();var _k=_c.getFullYear();var _l=_c.getMonth();_f= -((_k-_i)* 12+(_l-_j));if(_f!=_b){_g=_b-_f;_d=(new Date(_d)).addMonth( -1);}var _m=new Date((new Date(_d)).getFullYear(),(new Date(_d)).getMonth(),_h(this.gfnDateToStr(new Date(_d))));_e=(new Date(_m)).getFullYear()+(((new Date(_m)).getMonth()+1)+"").padLeft(2,'0')+(((new Date(_m)).getDate())+"").padLeft(2,'0');}else{_e=(new Date(_d)).getFullYear()+(((new Date(_d)).getMonth()+1)+"").padLeft(2,'0')+(((new Date(_d)).getDate())+"").padLeft(2,'0');}return (_e);};pForm.gfnGetHolidays=function(_a){var _a;var _b=new Array();_b[0]=this.gfnLunarToSolar((_a-1)+"1230",false)+"설날";_b[1]=this.gfnAddDate(_b[0].substring(0,8),1)+"설날";_b[2]=this.gfnAddDate(_b[1].substring(0,8),1)+"설날";_b[3]=this.gfnLunarToSolar(_a+"0408",false)+"석가탄신일";_b[4]=this.gfnLunarToSolar(_a+"0814",false)+"추석";_b[5]=this.gfnAddDate(_b[4].substring(0,8),1)+"추석";_b[6]=this.gfnAddDate(_b[5].substring(0,8),1)+"추석";_b[7]=_a+"0101"+"신정";_b[8]=_a+"0301"+"삼일절";_b[9]=_a+"0505"+"어린이날";_b[10]=_a+"0606"+"현충일";_b[11]=_a+"0815"+"광복절";_b[12]=_a+"1003"+"개천절";_b[13]=_a+"1009"+"한글날";_b[14]=_a+"1225"+"성탄절";return _b.sort();};pForm.gfnSolarToLunar=function(_a){var _b="31,0,31,30,31,30,31,31,30,31,30,31";var _c=[];var _d=[];var _e=[];var _f;var _g;var _h;var _i;var _j,_k,_l;var _m;var _n,_o,_p;_n=parseInt(_a.substr(0,4),10);_o=parseInt(_a.substr(4,2),10);_p=parseInt(_a.substr(6,2),10);if(_n<1841||_n>2043){return null;}_d=this.gfnSolarBase();_c=_b.split(",");_c[1]=28;if((_n%4)==0){if((_n%100)!=0||(_n%400)==0){_c[1]=29;}}_g=672069;_h=(_n-1)* 365+parseInt((_n-1)/4)-parseInt((_n-1)/100)+parseInt((_n-1)/400);for(var _r=0;_r<=_o-2;_r++ ){_h=_h+parseInt(_c[_r]);}_h=_h+_p;_f=_h-_g+1;for(var _r=0;_r<=_n-1841;_r++ ){_e[_r]=0;for(var _s=0;_s<=11;_s++ ){switch(parseInt(_d[_r* 12+_s])){case 1:_i=29;break;case 2:_i=30;break;case 3:_i=58;break;case 4:_i=59;break;case 5:_i=59;break;case 6:_i=60;break;}_e[_r]=_e[_r]+_i;}}_j=0;do{_f=_f-_e[_j];_j=_j+1;}while(_f>_e[_j])_k=0;_m="0";do{if(parseInt(_d[_j* 12+_k])<=2){_i=parseInt(_d[_j* 12+_k])+28;if(_f>_i){_f=_f-_i;_k=_k+1;}else{break;}}else{switch(parseInt(_d[_j* 12+_k])){case 3:m1=29;m2=29;break;case 4:m1=29;m2=30;break;case 5:m1=30;m2=29;break;case 6:m1=30;m2=30;break;}if(_f>m1){_f=_f-m1;if(_f>m2){_f=_f-m2;_k=_k+1;}else{_m="1";}}else{break;}}}while(1)_j=_j+1841;_k=_k+1;_l=_f;var _q=_m+_j;_q=_q+_k.toString().padLeft(2,"0");_q=_q+_l.toString().padLeft(2,"0");return _q;};pForm.gfnLunarToSolar=function(_a,_b){var _c="31,0,31,30,31,30,31,31,30,31,30,31";var _d=[];var _e=[];var _f=0;var _g,_h,_i;var _j,_k,_l,_m,_n;var _o;var _p,_q,_r;_p=parseInt(_a.substr(0,4),10);_q=parseInt(_a.substr(4,2),10);_r=parseInt(_a.substr(6,2),10);if(_p<1841||_p>2043){return null;}_e=this.gfnSolarBase();_d=_c.split(",");_d[1]=28;if((_p%4)==0){if((_p%100)!=0||(_p%400)==0){_d[1]=29;}}_j=_p-1841;_k=_q-1;_o=0;if(parseInt(_e[_j* 12+_k])>2){if((_p%4)==0){if((_p%100)!=0||(_p%400)==0){_o=1;}}}if(_o==1){switch(parseInt(_e[_j* 12+_k])){case 3:_n=29;break;case 4:_n=30;break;case 5:_n=29;break;case 6:_n=30;break;}}else{switch(parseInt(_e[_j* 12+_k])){case 1:_n=29;break;case 2:_n=30;break;case 3:_n=29;break;case 4:_n=29;break;case 5:_n=30;break;case 6:_n=30;break;}}var _s=_j-1;for(var _w=0;_w<=_s;_w++ ){for(var _x=0;_x<=11;_x++ ){switch(parseInt(_e[_w* 12+_x])){case 1:_f=_f+29;break;case 2:_f=_f+30;break;case 3:_f=_f+58;break;case 4:_f=_f+59;break;case 5:_f=_f+59;break;case 6:_f=_f+60;break;}}}var _t=_k-1;for(var _x=0;_x<=_t;_x++ ){switch(parseInt(_e[_j* 12+_x])){case 1:_f=_f+29;break;case 2:_f=_f+30;break;case 3:_f=_f+58;break;case 4:_f=_f+59;break;case 5:_f=_f+59;break;case 6:_f=_f+60;break;}}if(_o==1){switch(parseInt(_e[_j* 12+_k])){case 3:_n=29;break;case 4:_n=29;break;case 5:_n=30;break;case 6:_n=30;break;}}_f=_f+_r+22;if(_b){switch(parseInt(_e[_j* 12+_k])){case 3:_f=_f+29;break;case 4:_f=_f+30;break;case 5:_f=_f+29;break;case 6:_f=_f+30;break;}}_j=1840;do{_j=_j+1;_o=0;if((_j%4)==0){if((_j%100)!=0||(_j%400)==0){_o=1;}}if(_o==1){_l=366;}else{_l=365;}if(_f<=_l){break;}_f=_f-_l;}while(1)_g=_j;_d[1]=_l-337;_k=0;do{_k=_k+1;if(_f<=parseInt(_d[_k-1])){break;}_f=_f-parseInt(_d[_k-1]);}while(1)_h=_k;_i=_f;_m=_g;_f=_m* 365+parseInt(_m/4)-parseInt(_m/100)+parseInt(_m/400);var _u=_h-1;for(var _w=0;_w<=_u;_w++ ){_f=_f+parseInt(_d[_w]);}_f=_f+_i;var _v=_m;_v=_v+_h.toString().padLeft(2,"0");_v=_v+_i.toString().padLeft(2,"0");return _v;};pForm.gfnSolarBase=function(){var _a;_a="1,2,4,1,1,2,1,2,1,2,2,1,";_a+="2,2,1,2,1,1,2,1,2,1,2,1,";_a+="2,2,2,1,2,1,4,1,2,1,2,1,";_a+="2,2,1,2,1,2,1,2,1,2,1,2,";_a+="1,2,1,2,2,1,2,1,2,1,2,1,";_a+="2,1,2,1,5,2,1,2,2,1,2,1,";_a+="2,1,1,2,1,2,1,2,2,2,1,2,";_a+="1,2,1,1,2,1,2,1,2,2,2,1,";_a+="2,1,2,3,2,1,2,1,2,1,2,2,";_a+="2,1,2,1,1,2,1,1,2,2,1,2,";_a+="2,2,1,2,1,1,2,1,2,1,5,2,";_a+="2,1,2,2,1,1,2,1,2,1,1,2,";_a+="2,1,2,2,1,2,1,2,1,2,1,2,";_a+="1,2,1,2,1,2,5,2,1,2,1,2,";_a+="1,1,2,1,2,2,1,2,2,1,2,1,";_a+="2,1,1,2,1,2,1,2,2,2,1,2,";_a+="1,2,1,1,5,2,1,2,1,2,2,2,";_a+="1,2,1,1,2,1,1,2,2,1,2,2,";_a+="2,1,2,1,1,2,1,1,2,1,2,2,";_a+="2,1,6,1,1,2,1,1,2,1,2,2,";_a+="1,2,2,1,2,1,2,1,2,1,1,2,";_a+="2,1,2,1,2,2,1,2,2,3,1,2,";_a+="1,2,2,1,2,1,2,2,1,2,1,2,";_a+="1,1,2,1,2,1,2,2,1,2,2,1,";_a+="2,1,1,2,4,1,2,2,1,2,2,1,";_a+="2,1,1,2,1,1,2,2,1,2,2,2,";_a+="1,2,1,1,2,1,1,2,1,2,2,2,";_a+="1,2,2,3,2,1,1,2,1,2,2,1,";_a+="2,2,2,1,1,2,1,1,2,1,2,1,";_a+="2,2,2,1,2,1,2,1,1,5,2,1,";_a+="2,2,1,2,2,1,2,1,2,1,1,2,";_a+="1,2,1,2,2,1,2,1,2,2,1,2,";_a+="1,1,2,1,2,4,2,1,2,2,1,2,";_a+="1,1,2,1,2,1,2,1,2,2,2,1,";_a+="2,1,1,2,1,1,2,1,2,2,2,1,";_a+="2,2,1,1,5,1,2,1,2,2,1,2,";_a+="2,2,1,1,2,1,1,2,1,2,1,2,";_a+="2,2,1,2,1,2,1,1,2,1,2,1,";_a+="2,2,4,2,1,2,1,1,2,1,2,1,";_a+="2,1,2,2,1,2,2,1,2,1,1,2,";_a+="1,2,1,2,1,2,5,2,2,1,2,1,";_a+="1,2,1,2,1,2,1,2,2,1,2,2,";_a+="1,1,2,1,1,2,1,2,2,2,1,2,";_a+="2,1,1,2,3,2,1,2,2,1,2,2,";_a+="2,1,1,2,1,1,2,1,2,1,2,2,";_a+="2,1,2,1,2,1,1,2,1,2,1,2,";_a+="2,2,1,5,2,1,1,2,1,2,1,2,";_a+="2,1,2,2,1,2,1,1,2,1,2,1,";_a+="2,1,2,2,1,2,1,2,1,2,1,2,";_a+="1,5,2,1,2,2,1,2,1,2,1,2,";_a+="1,2,1,2,1,2,1,2,2,1,2,2,";_a+="1,1,2,1,1,5,2,2,1,2,2,2,";_a+="1,1,2,1,1,2,1,2,1,2,2,2,";_a+="1,2,1,2,1,1,2,1,2,1,2,2,";_a+="2,1,2,1,5,1,2,1,2,1,2,1,";_a+="2,2,2,1,2,1,1,2,1,2,1,2,";_a+="1,2,2,1,2,1,2,1,2,1,2,1,";_a+="2,1,5,2,2,1,2,1,2,1,2,1,";_a+="2,1,2,1,2,1,2,2,1,2,1,2,";_a+="1,2,1,1,2,1,2,5,2,2,1,2,";_a+="1,2,1,1,2,1,2,1,2,2,2,1,";_a+="2,1,2,1,1,2,1,2,1,2,2,2,";_a+="1,2,1,2,3,2,1,1,2,2,1,2,";_a+="2,2,1,2,1,1,2,1,1,2,2,1,";_a+="2,2,1,2,2,1,1,2,1,2,1,2,";_a+="1,2,2,4,1,2,1,2,1,2,1,2,";_a+="1,2,1,2,1,2,2,1,2,1,2,1,";_a+="2,1,1,2,2,1,2,1,2,2,1,2,";_a+="1,5,1,2,1,2,1,2,2,2,1,2,";_a+="1,2,1,1,2,1,2,1,2,2,2,1,";_a+="2,1,2,1,1,5,1,2,2,1,2,2,";_a+="2,1,2,1,1,2,1,1,2,2,1,2,";_a+="2,2,1,2,1,1,2,1,1,2,1,2,";_a+="2,2,1,2,5,1,2,1,2,1,1,2,";_a+="2,1,2,2,1,2,1,2,1,2,1,2,";_a+="1,2,1,2,1,2,2,1,2,1,2,1,";_a+="2,3,2,1,2,2,1,2,2,1,2,1,";_a+="2,1,1,2,1,2,1,2,2,2,1,2,";_a+="1,2,1,1,2,1,5,2,2,1,2,2,";_a+="1,2,1,1,2,1,1,2,2,1,2,2,";_a+="2,1,2,1,1,2,1,1,2,1,2,2,";_a+="2,1,2,2,3,2,1,1,2,1,2,2,";_a+="1,2,2,1,2,1,2,1,2,1,1,2,";_a+="2,1,2,1,2,2,1,2,1,2,1,1,";_a+="2,1,2,5,2,1,2,2,1,2,1,2,";_a+="1,1,2,1,2,1,2,2,1,2,2,1,";_a+="2,1,1,2,1,2,1,2,2,1,2,2,";_a+="1,5,1,2,1,1,2,2,1,2,2,2,";_a+="1,2,1,1,2,1,1,2,1,2,2,2,";_a+="1,2,2,1,1,5,1,2,1,2,2,1,";_a+="2,2,2,1,1,2,1,1,2,1,2,1,";_a+="2,2,2,1,2,1,2,1,1,2,1,2,";_a+="1,2,2,1,6,1,2,1,2,1,1,2,";_a+="1,2,1,2,2,1,2,2,1,2,1,2,";_a+="1,1,2,1,2,1,2,2,1,2,2,1,";_a+="2,1,4,1,2,1,2,1,2,2,2,1,";_a+="2,1,1,2,1,1,2,1,2,2,2,1,";_a+="2,2,1,1,2,1,4,1,2,2,1,2,";_a+="2,2,1,1,2,1,1,2,1,2,1,2,";_a+="2,2,1,2,1,2,1,1,2,1,2,1,";_a+="2,2,1,2,2,4,1,1,2,1,2,1,";_a+="2,1,2,2,1,2,2,1,2,1,1,2,";_a+="1,2,1,2,1,2,2,1,2,2,1,2,";_a+="1,1,2,4,1,2,1,2,2,1,2,2,";_a+="1,1,2,1,1,2,1,2,2,2,1,2,";_a+="2,1,1,2,1,1,2,1,2,2,1,2,";_a+="2,5,1,2,1,1,2,1,2,1,2,2,";_a+="2,1,2,1,2,1,1,2,1,2,1,2,";_a+="2,2,1,2,1,2,3,2,1,2,1,2,";_a+="2,1,2,2,1,2,1,1,2,1,2,1,";_a+="2,1,2,2,1,2,1,2,1,2,1,2,";_a+="1,2,1,2,4,2,1,2,1,2,1,2,";_a+="1,2,1,1,2,2,1,2,2,1,2,2,";_a+="1,1,2,1,1,2,1,2,2,1,2,2,";_a+="2,1,4,1,1,2,1,2,1,2,2,2,";_a+="1,2,1,2,1,1,2,1,2,1,2,2,";_a+="2,1,2,1,2,1,1,5,2,1,2,2,";_a+="1,2,2,1,2,1,1,2,1,2,1,2,";_a+="1,2,2,1,2,1,2,1,2,1,2,1,";_a+="2,1,2,1,2,5,2,1,2,1,2,1,";_a+="2,1,2,1,2,1,2,2,1,2,1,2,";_a+="1,2,1,1,2,1,2,2,1,2,2,1,";_a+="2,1,2,3,2,1,2,1,2,2,2,1,";_a+="2,1,2,1,1,2,1,2,1,2,2,2,";_a+="1,2,1,2,1,1,2,1,1,2,2,1,";_a+="2,2,5,2,1,1,2,1,1,2,2,1,";_a+="2,2,1,2,2,1,1,2,1,2,1,2,";_a+="1,2,2,1,2,1,5,2,1,2,1,2,";_a+="1,2,1,2,1,2,2,1,2,1,2,1,";_a+="2,1,1,2,2,1,2,1,2,2,1,2,";_a+="1,2,1,1,5,2,1,2,2,2,1,2,";_a+="1,2,1,1,2,1,2,1,2,2,2,1,";_a+="2,1,2,1,1,2,1,1,2,2,2,1,";_a+="2,2,1,5,1,2,1,1,2,2,1,2,";_a+="2,2,1,2,1,1,2,1,1,2,1,2,";_a+="2,2,1,2,1,2,1,5,2,1,1,2,";_a+="2,1,2,2,1,2,1,2,1,2,1,1,";_a+="2,2,1,2,1,2,2,1,2,1,2,1,";_a+="2,1,1,2,1,6,1,2,2,1,2,1,";_a+="2,1,1,2,1,2,1,2,2,1,2,2,";_a+="1,2,1,1,2,1,1,2,2,1,2,2,";_a+="2,1,2,3,2,1,1,2,2,1,2,2,";_a+="2,1,2,1,1,2,1,1,2,1,2,2,";_a+="2,1,2,2,1,1,2,1,1,5,2,2,";_a+="1,2,2,1,2,1,2,1,1,2,1,2,";_a+="1,2,2,1,2,2,1,2,1,2,1,1,";_a+="2,1,2,2,1,5,2,2,1,2,1,2,";_a+="1,1,2,1,2,1,2,2,1,2,2,1,";_a+="2,1,1,2,1,2,1,2,2,1,2,2,";_a+="1,2,1,1,5,1,2,1,2,2,2,2,";_a+="1,2,1,1,2,1,1,2,1,2,2,2,";_a+="1,2,2,1,1,2,1,1,2,1,2,2,";_a+="1,2,5,2,1,2,1,1,2,1,2,1,";_a+="2,2,2,1,2,1,2,1,1,2,1,2,";_a+="1,2,2,1,2,2,1,5,2,1,1,2,";_a+="1,2,1,2,2,1,2,1,2,2,1,2,";_a+="1,1,2,1,2,1,2,2,1,2,2,1,";_a+="2,1,1,2,3,2,2,1,2,2,2,1,";_a+="2,1,1,2,1,1,2,1,2,2,2,1,";_a+="2,2,1,1,2,1,1,2,1,2,2,1,";_a+="2,2,2,3,2,1,1,2,1,2,1,2,";_a+="2,2,1,2,1,2,1,1,2,1,2,1,";_a+="2,2,1,2,2,1,2,1,1,2,1,2,";_a+="1,5,2,2,1,2,1,2,2,1,1,2,";_a+="1,2,1,2,1,2,2,1,2,2,1,2,";_a+="1,1,2,1,2,1,5,2,2,1,2,2,";_a+="1,1,2,1,1,2,1,2,2,2,1,2,";_a+="2,1,1,2,1,1,2,1,2,2,1,2,";_a+="2,2,1,1,5,1,2,1,2,1,2,2,";_a+="2,1,2,1,2,1,1,2,1,2,1,2,";_a+="2,1,2,2,1,2,1,1,2,1,2,1,";_a+="2,1,6,2,1,2,1,1,2,1,2,1,";_a+="2,1,2,2,1,2,1,2,1,2,1,2,";_a+="1,2,1,2,1,2,1,2,5,2,1,2,";_a+="1,2,1,1,2,1,2,2,2,1,2,2,";_a+="1,1,2,1,1,2,1,2,2,1,2,2,";_a+="2,1,1,2,3,2,1,2,1,2,2,2,";_a+="1,2,1,2,1,1,2,1,2,1,2,2,";_a+="2,1,2,1,2,1,1,2,1,2,1,2,";_a+="2,1,2,5,2,1,1,2,1,2,1,2,";_a+="1,2,2,1,2,1,2,1,2,1,2,1,";_a+="2,1,2,1,2,2,1,2,1,2,1,2,";_a+="1,5,2,1,2,1,2,2,1,2,1,2,";_a+="1,2,1,1,2,1,2,2,1,2,2,1,";_a+="2,1,2,1,1,5,2,1,2,2,2,1,";_a+="2,1,2,1,1,2,1,2,1,2,2,2,";_a+="1,2,1,2,1,1,2,1,1,2,2,2,";_a+="1,2,2,1,5,1,2,1,1,2,2,1,";_a+="2,2,1,2,2,1,1,2,1,1,2,2,";_a+="1,2,1,2,2,1,2,1,2,1,2,1,";_a+="2,1,5,2,1,2,2,1,2,1,2,1,";_a+="2,1,1,2,1,2,2,1,2,2,1,2,";_a+="1,2,1,1,2,1,5,2,2,2,1,2,";_a+="1,2,1,1,2,1,2,1,2,2,2,1,";_a+="2,1,2,1,1,2,1,1,2,2,1,2,";_a+="2,2,1,2,1,4,1,1,2,1,2,2,";_a+="2,2,1,2,1,1,2,1,1,2,1,2,";_a+="2,2,1,2,1,2,1,2,1,1,2,1,";_a+="2,2,1,2,5,2,1,2,1,2,1,1,";_a+="2,1,2,2,1,2,2,1,2,1,2,1,";_a+="2,1,1,2,1,2,2,1,2,2,1,2,";_a+="1,5,1,2,1,2,1,2,2,2,1,2,";_a+="1,2,1,1,2,1,1,2,2,1,2,2";var _b=[];_b=_a.split(",");return _b;};pForm.gfnStrToDate=function(_a){var _b=new Date(parseInt(_a.substr(0,4)),parseInt(_a.substr(4,2))-1,parseInt(_a.substr(6,2)));return _b;};pForm.gfnDateToStr=function(_a){var _b=_a.getYear().toString();var _c=(_a.getMonth()+1).toString();var _d=_a.getDate().toString();if(_b.length==2){_b='19'+_b;}else if(_b.length==1){_b='190'+_b;}if(_c.length==1){_c='0'+_c;}if(_d.length==1){_d='0'+_d;}return _b+_c+_d;};pForm.gfnGetWeek=function(_a){if(_a.length!=8||!this.gfnIsDigit(_a)){return "";}var _b=parseInt(_a.substr(0,4));var _c=parseInt(_a.substr(4,2));var _d=parseInt(_a.substr(6,8));var _e=1;if(_e==0){_d=_d+1;}var _f=Math.floor((14-_c)/12);var _g=_b+4800-_f;var _h=_c+(12* _f)-3;var _i=Math.floor(_g/4)-Math.floor(_g/100)+Math.floor(_g/400);var _j=_d+Math.floor(((153* _h)+2)/5)+(365* _g)+_i-32045;var _k=(((_j+31741-(_j%7))%146097)%36524)%1461;var _l=Math.floor(_k/1460);var _m=((_k-_l)%365)+_l;var _n=Math.floor(_m/7)+1;_n=_n.toString();return _b+_n.padLeft(2,"0");};pForm.gfnGetBirthDateBySSN=function(_a){var _b;_a=_a.replace("-","");if(!isNumber(_a)||_a.length<6){return _b;}var _c=_a.substr(0,6);var _d;if(_a.length>6){var _e=Number(_a.substr(6,1));switch(_e){case 1:case 2:case 5:case 6:_d="19";break;case 3:case 4:case 7:case 8:_d="20";break;case 9:case 0:_d="18";break;}}else{var _f=this.gfnGetDate();if(_f.substr(2,6)<=_c){_d="19";}else{_d="20";}}_b=_d+_c;if(!this.gfnIsDate(_b)){_b=null;}return _b;};pForm.gfnGetBirthYear=function(_a){if(_a.toString().length!=13){return "N";}if(!(_a).match(/^\d{6}\d{7}$/)){return "N";}var _b=_a.substr(6,1);if(_b=='1'||_b=='2'||_b=='5'||_b=='6'){return '19';}else if(_b=='3'||_b=='4'||_b=='7'||_b=='8'){return '20';}};pForm.gfnGetAge=function(_a,_b){var _c= -1;if(gfnIsEmpty(_b)){_b=gfn_getDate();}if(gfn_isDate(_a)&&gfn_isDate(_b)){var _d=Number(_b.substr(0,4))-Number(_a.substr(0,4));var _e=Number(_b.substr(4,4))-Number(_a.substr(4,4));_c=_d;if(_e<0){_c=_c-1;}}return _c;};
var pForm=nexacro.Form.prototype;pForm.gfnTransaction=function(_a,_b,_c,_d,_e,_f,_g){if(this.gfnIsNull(_a)||this.gfnIsNull(_b)){trace("Error : gfnTransaction() 함수의 인자값이 부족합니다.");return false;}if(this.gfnIsNull(_f)){_f="fnCallback";}var _h=new Date();var _i=_h.getTime();var _j=_h.getYear()+"-"+String(_h.getMonth()).padLeft(2,'0')+"-"+String(_h.getDate()).padLeft(2,'0')+" "+String(_h.getHours()).padLeft(2,'0')+":"+String(_h.getMinutes()).padLeft(2,'0')+":"+String(_h.getSeconds()).padLeft(2,'0')+" "+_h.getMilliseconds();if((_g!=true)&&(_g!=false)){_g=true;}var _k={svcId:_a,svcUrl:_b,callback:_f,isAsync:_g,startDate:_j,startTime:_i};var _l="";if(_b.substr(0,6)=="EduUrl"){_l=_b;}else{_l="SvcUrl::"+_b;}var _m="";if(this.gfnIsNull(_e)){_m="";}else{_m=_e;}var _n;if(nexacro.getEnvironmentVariable("evRunMode")=="R"){_n=2;}else{_n=0;}this.transaction(JSON.stringify(_k),_l,_c,_d,_m,"gfnCallback",_g,_n,false);};pForm.gfnCallback=function(_a,_b,_c){var _d=JSON.parse(_a);var _e=_d.startDate;var _f=_d.startTime;var _g=new Date();var _h=_g.getYear()+"-"+String(_g.getMonth()).padLeft(2,'0')+"-"+String(_g.getDate()).padLeft(2,'0')+" "+String(_g.getHours()).padLeft(2,'0')+":"+String(_g.getMinutes()).padLeft(2,'0')+":"+String(_g.getSeconds()).padLeft(2,'0')+" "+_g.getMilliseconds();var _i=(_g.getTime()-_f)/1000;var _j="";if(nexacro.getEnvironmentVariable("evRunMode")=="S"){if(_b==0){_j="gfnCallback : svcID>>"+_d.svcId+",  svcUrl>>"+_d.svcUrl+",  errorCode>>"+_b+", errorMsg>>"+_c+", isAsync>>"+_d.isAsync+", sStartDate>>"+_e+", sEndDate>>"+_h+", nElapseTime>>"+_i;trace(_j);}else{_j="gfnCallback : svcID>>"+_d.svcId+",  svcUrl>>"+_d.svcUrl+",  errorCode>>"+_b+", isAsync>>"+_d.isAsync+", sStartDate>>"+_e+", sEndDate>>"+_h+", nElapseTime>>"+_i;_j+="\n==================== errorMsg =======================\n"+_c+"\n==================================================";trace(_j);}}if(_b!=0){switch(_b){case  -1:this.gfnAlert("msg.server.error");break;case  -2463215:break;}}if(_d.svcId.split(":")[0]=="svcCommonCode"){var _k=_d.callback;var _l=pForm.gfnGetApplication();var _m=_l.gdsTemp;this.gfnGetCommonCode(this._commCodeArg,_m);this._commCodeArg=null;}if(!this.gfnIsNull(_d.svcId)){if(this[_d.callback]){this.lookupFunc(_d.callback).call(_d.svcId,_b,_c);}}};this._commCodeArg=null;pForm.gfnSearchCode=function(_a,_b,_c){var _d=pForm.gfnGetApplication();var _e=_d.gdsTemp;var _f=new Array();for(var _l=0;_l<_a.length;_l++ ){_f.push(_a[_l].codeGroup);}this._commCodeArg=_a;var _g="svcCommonCode";var _h="selectCommCode.do";var _i="";var _j=_e.name+"=ds_commonCode";var _k="codeGroup="+nexacro.wrapQuote(_f.toString());if(!pForm.gfnIsNull(_b)){_g=_g+":"+_b;}if(pForm.gfnIsNull(_c)){_c=true;}this.gfnTransaction(_g,_h,_i,_j,_k,_b);};pForm.gfnGetCommonCode=function(_a,_b){if(this.gfnIsNull(_b)){_b=this.gfnGetApplication().gdsComCode;}var _c=null;var _d=null;for(var _h=0;_h<_a.length;_h++ ){var _e=_a[_h].obj;if(_e instanceof nexacro.Combo||_e instanceof nexacro.Radio||_e instanceof nexacro.ListBox){_c=_e.getInnerDataset();_d=_e;}else if(_e instanceof Dataset){_c=_e;_d=null;}if(_c==null){trace("gfnGetCommonCode : Dataset is Null");return;}var _f="GROUP_CODE=="+nexacro.wrapQuote(_a[_h].codeGroup);if(!this.gfnIsNull(_a[_h].filter)){_f=_f+" && "+_a[_h].filter;}_b.set_enableevent(false);_c.set_enableevent(false);_b.filter(_f);_c.copyData(_b,true);if(!this.gfnIsNull(_a[_h].first)){_c.insertRow(0);var _g=_a[_h].first.split(":");if(_g[0]=="0"){_c.setColumn(0,"CODE","ALL");_c.setColumn(0,"CODE_NAME","All");}else if(_g[0]=="1"){_c.setColumn(0,"CODE","");_c.setColumn(0,"CODE_NAME","Selected...");}else if(_g[0]=="2"){_c.setColumn(0,"CODE",_g[1]);_c.setColumn(0,"CODE_NAME",_g[2]);}}_b.filter("");_c.set_enableevent(true);_b.set_enableevent(true);if(!this.gfnIsNull(_d)){_d.set_index(0);}}};
var pForm=nexacro.Form.prototype;pForm.useErrorClass=false;pForm.gfnClearValidation=function(_a){_a.validationRuleSet="";};pForm.gfnRemoveValidation=function(_a,_b){var _c=new Array();if(!this.gfnIsNull(_a.validationRuleSet)){validObj=JSON.parse(_a.validationRuleSet);for(var _e in validObj){var _d=validObj[_e];if(_d.name!=_b){_c.push(_d);}}}_a.validationRuleSet=JSON.stringify(_c);};pForm.gfnSetValidation=function(_a,_b,_c,_d){var _e=new Array();if(_c.indexOf(",")!= -1){_c=nexacro.replaceAll(_c,",","^_^");}if(!this.gfnIsNull(_a.validationRuleSet)){_e=JSON.parse(_a.validationRuleSet);for(var _g in _e){if(_e[_g].name==_b){_e[_g].title=_c;_e[_g].value=_d;if(""+_d.indexOf("required")> -1){_e[_g].notnull=true;}else{_e[_g].notnull=false;}_a.validationRuleSet=JSON.stringify(_e);return true;}}}var _f={name:_b,title:_c,value:_d};if(""+_d.indexOf("required")> -1){_f.notnull=true;}else{_f.notnull=false;}_e.push(_f);_a.validationRuleSet=JSON.stringify(_e);};pForm.gfnValidation=function(){var _a=0;var _b=new Array();var _c="U";for(var _r=0;_r<arguments.length;_r++ ){if(this.gfnTypeOf(arguments[_r])=="string"){if(arguments[_r]=="A"||arguments[_r]=="U"){_c=arguments[_r];}}else{_b.push(arguments[_r]);}}for(var _r=0;_r<_b.length;_r++ ){var _d;var _e="";var _f=new Array();if(_b[_r] instanceof Dataset){_d=_b[_r];_e="dataset";}else if(_b[_r] instanceof Grid){_d=_b[_r].getBindDataset();_e="grid";}else{continue;}var _g=new Array();if(!this.gfnIsNull(_d.validationRuleSet)){_g=JSON.parse(_d.validationRuleSet);}else{continue;}_a+=parseInt(_d.getDeletedRowCount());for(var _s=0;_s<_d.getRowCount();_s++ ){var _h=_d.getRowType(_s);if(_h==8){ ++_a;continue;}if(_c=="U"){if(_h==1){continue;}if(_h==2||_h==4){ ++_a;}}else{ ++_a;}for(var _t=0;_t<_g.length;_t++ ){var _i=_g[_t].name;var _j=new String(_g[_t].title);var _k=_d.getColumn(_s,_i);var _f=(""+_g[_t].value).split(",");var _l=_g[_t].notnull;if(_l==true){if(this.gfnIsNull(_k)){if(this.useErrorClass){this.gfnResetValidationCss(arguments);}_d.set_rowposition(_s);this.validationObject=arguments[_r];this.validationColumn=_i;var _m="";if(_j.indexOf("^_^")!= -1){_m=_j.split("^_^")[0];}else{_m=_j;}this.gfnAlert("msg.err.validator.required",[_m],null,"gfnValidationCallback");return false;}}if(!this.gfnIsNull(_k)){for(var _u=0;_u<_f.length;_u++ ){var _n="";var _o=_f[_u].split(":")[0];if(_o=="equalto"||_o=="fromto"||_o=="comparebig"||_o=="comparesmall"){var _p;var _q;if(_f[_u].split(":").length==3){_p=_d.getColumn(_s,_f[_u].split(":")[1]);_q=_d.getColumn(_s,_f[_u].split(":")[2]);}else{_p=_d.getColumn(_s,_i);_q=_d.getColumn(_s,_f[_u].split(":")[1]);}_n=this.gfnValidationCheckRule(_j,_k,_f[_u],_p,_q);}else{_n=this.gfnValidationCheckRule(_j,_k,_f[_u]);}if(!this.gfnIsNull(_n)){if(this.useErrorClass){this.gfnResetValidationCss(arguments);}_d.set_rowposition(_s);this.validationObject=arguments[_r];this.validationColumn=_i;this.gfnAlert("msg.err.validator",[_n],null,"gfnValidationCallback");return false;}}}}}}if(this.useErrorClass){this.gfnResetValidationCss(arguments);}if(_a==0){trace("정합성 체크 대상이 없어 Validation을 체크가 되지 않았습니다.");return false;}return true;};pForm.gfnValidationCheckRule=function(_a,_b,_c,_d,_e){var _f="";var _g="";var _h="";if(_a.indexOf("^_^")!= -1){_f=_a.split("^_^")[0];_g=_a.split("^_^")[0];_h=_a.split("^_^")[1];}else{_f=_a;}var _i=_c.split(":");var _j=_i[0];_j=_j.toLowerCase();switch(_j){case "length":if((_b+"").length!=parseInt(_i[1])){return this.gfnGetMessage("msg.err.validator.length",[_f,_i[1]]);}break;case "rangelength":if((_b+"").length<parseInt(_i[1])||(_b+"").length>parseInt(_i[2])){return this.gfnGetMessage("msg.err.validator.rangelength",[_f,_i[1],_i[2]]);}break;case "maxlength":if(_b.length>parseInt(_i[1])){return this.gfnGetMessage("msg.err.validator.maxlength",[_f,_i[1]]);}break;case "minlength":if(_b.length<parseInt(_i[1])){return this.gfnGetMessage("msg.err.validator.minlength",[_f,_i[1]]);}break;case "maxlengthbyte":if(this.lookupFunc("gfnLengthByte").call(_b)>parseInt(_i[1])){return this.gfnGetMessage("msg.err.validator.maxlength",[_f,_i[1]]);}break;case "minlengthbyte":if(this.lookupFunc("gfnLengthByte").call(_b)<parseInt(_i[1])){return this.gfnGetMessage("msg.err.validator.minlength",[_f,_i[1]]);}break;case "digits":if(!this.lookupFunc("gfnIsDigit").call(_b)){return this.gfnGetMessage("msg.err.validator.digits",[_f]);}break;case "min":if(parseFloat(_b)<parseFloat(_i[1])){return this.gfnGetMessage("msg.err.validator.min",[_f,_i[1]]);}break;case "max":if(parseFloat(_b)>parseFloat(_i[1])){return this.gfnGetMessage("msg.err.validator.max",[_f,_i[1]]);}break;case "declimit":var _k=(""+_b).indexOf(".");if(_k== -1){return this.gfnGetMessage("msg.err.validator.declimit",[_f,_i[1]]);}else{var _l=(""+_b).substr(_k+1,_b.length);if(_l.length!=parseInt(_i[1])){return this.gfnGetMessage("msg.err.validator.declimit",[_f,_i[1]]);}}break;case "date":if(!this.lookupFunc("gfnIsYMD").call(_b)){return this.gfnGetMessage("msg.err.validator.date",[_f]);}break;case "dateym":if(!this.lookupFunc("gfnIsYM").call(_b)){return this.gfnGetMessage("msg.err.validator.dateym",[_f]);}break;case "range":if(parseInt(_b)<parseInt(_i[1])||parseInt(_b)>parseInt(_i[2])){return this.gfnGetMessage("msg.err.validator.range",[_f,_i[1],_i[2]]);}break;case "code":for(var _m=1;_m<_i.length;_m++ ){if(parseInt(_b)==parseInt(_i[_m])){return "";}}return this.gfnGetMessage("msg.err.validator.code",[_f,nexacro.replaceAll(_c.split("code:")[1],":",",")]);break;case "equalto":if(_d!=_e){if(_a.indexOf("^_^")!= -1){return this.gfnGetMessage("msg.err.validator.equalto",[_g,_h]);}else{return this.gfnGetMessage("msg.err.validator.equalto",[_f,_e]);}}break;case "fromto":if(_d<_e){if(_a.indexOf("^_^")> -1){return this.gfnGetMessage("msg.err.validator.fromto",[_g,_h]);}else{return this.gfnGetMessage("msg.err.validator.fromto",[_f,_e]);}}break;case "comparebig":if(parseFloat(_d)<parseFloat(_e)){if(_a.indexOf("^_^")!= -1){return this.gfnGetMessage("msg.err.validator.comparebig",[_g,_h]);}else{return this.gfnGetMessage("msg.err.validator.comparebig",[_f,_e]);}}break;case "comparesmall":if(parseFloat(_d)>parseFloat(_e)){if(_a.indexOf("^_^")!= -1){return this.gfnGetMessage("msg.err.validator.comparesmall",[_g,_h]);}else{return this.gfnGetMessage("msg.err.validator.comparesmall",[_f,_e]);}}break;case "isssn":if(!this.lookupFunc("gfnIsSSN").call(_b)){return this.gfnGetMessage("msg.err.validator.ssn",[_f]);}break;case "isfrn":if(!this.lookupFunc("gfnIsFrnrIdNo").call(_b)){return this.gfnGetKoreanTarget(_f,"은(는)")+" 올바른 외국인등록번호가 아닙니다.";}break;case "isbzid":if(!this.lookupFunc("gfnIsBzIdNo").call(_b)){return this.gfnGetKoreanTarget(_f,"은(는)")+" 올바른 사업자등록번호가 아닙니다.";}break;case "isfirmid":if(!this.lookupFunc("gfnIsFirmIdNo").call(_b)){return this.gfnGetKoreanTarget(_f,"은(는)")+" 올바른 법인등록번호가 아닙니다.";}break;case "iscardno":if(!this.lookupFunc("gfnIsCardNo").call(_b)){return this.gfnGetKoreanTarget(_f,"은(는)")+" 올바른 신용카드번호가 아닙니다.";}break;case "isemail":if(!this.lookupFunc("gfnIsEmail").call(_b)){return this.gfnGetMessage("msg.err.validator.email",[_f]);}break;default:return "";break;}return "";};pForm.gfnValidationCallback=function(_a,_b){this.gfnSetValidationFocus(this.validationObject,this.validationColumn);};pForm.gfnSetValidationFocus=function(_a,_b){var _c;if(_a instanceof Grid){_c=_a.getBindDataset();}else{_c=_a;}for(var _g=0;_g<this.binds.length;_g++ ){if(eval("this."+this.binds[_g].datasetid)==_c&&this.binds[_g].columnid==_b){var _d=eval("this."+this.binds[_g].compid);if(this.useErrorClass){var _e=_d.valueOf();if(_e=="[object Edit]"){_d.orgcssclass=_d.cssclass;_d.set_cssclass("edt_WF_Error");}else if(_e=="[object MaskEdit]"){_d.orgcssclass=_d.cssclass;_d.set_cssclass("msk_WF_Error");}else if(_e=="[object Combo]"){_d.orgcssclass=_d.cssclass;_d.set_cssclass("cmb_WF_Error");}else if(_e=="[object Calendar]"){_d.orgcssclass=_d.cssclass;_d.set_cssclass("cal_WF_Error");}else if(_e=="[object TextArea]"){_d.orgcssclass=_d.cssclass;_d.set_cssclass("txt_WF_Error");}else if(_e=="[object Spin]"){_d.orgcssclass=_d.cssclass;_d.set_cssclass("spn_WF_Error");}else if(_e=="[object Radio]"){_d.orgcssclass=_d.cssclass;_d.set_cssclass("rdo_WF_Error");}else if(_e=="[object CheckBox]"){_d.orgcssclass=_d.cssclass;_d.set_cssclass("chk_WF_Error");}}_d.setFocus();return;}}if(_a instanceof Grid){_a.setCellPos(_a.getBindCellIndex("Body",_b));_a.showEditor(true);_a.setFocus();}else{if(!this.gfnIsNull(_a.bindgrid)){var _f=_a.bindgrid;_f.setCellPos(_f.getBindCellIndex("Body",_b));_f.showEditor(true);_f.setFocus();}}};pForm.gfnResetValidationCss=function(_a){for(var _e=0;_e<_a.length;_e++ ){var _b;if(_a[_e] instanceof Dataset){_b=_a[_e];}else if(_a[_e] instanceof Grid){_b=_a[_e].getBindDataset();}else{continue;}for(var _f=0;_f<this.binds.length;_f++ ){var _c=this.binds[_f].datasetid;if(this.gfnIsNull(_c)==true){continue;}if(eval("this."+this.binds[_f].datasetid)==_b){try{var _d=eval("this."+this.binds[_f].compid);if(_d.cssclass.indexOf("Error")!= -1){_d.set_cssclass(_d.orgcssclass);_d.orgcssclass="";}}catch(e){}}}}};pForm.gfnGetKoreanTarget=function(_a,_b){if(_b=="은(는)"){if(_a[_a.length-1].toKorChars().length==2){return _a+"는";}else{return _a+"은";}}else if(_b=="이(가)"){if(_a[_a.length-1].toKorChars().length==2){return _a+"가";}else{return _a+"이";}}else if(_b=="을(를)"){if(_a[_a.length-1].toKorChars().length==2){return _a+"를";}else{return _a+"은";}}else{_a;}};String.prototype.toKorChars=function(){var _a=['ㄱ','ㄲ','ㄴ','ㄷ','ㄸ','ㄹ','ㅁ','ㅂ','ㅃ','ㅅ','ㅆ','ㅇ','ㅈ','ㅉ','ㅊ','ㅋ','ㅌ','ㅍ','ㅎ'],_b=['ㅏ','ㅐ','ㅑ','ㅒ','ㅓ','ㅔ','ㅕ','ㅖ','ㅗ','ㅘ','ㅙ','ㅚ','ㅛ','ㅜ','ㅝ','ㅞ','ㅟ','ㅠ','ㅡ','ㅢ','ㅣ'],_c=['','ㄱ','ㄲ','ㄳ','ㄴ','ㄵ','ㄶ','ㄷ','ㄹ','ㄺ','ㄻ','ㄼ','ㄽ','ㄾ','ㄿ','ㅀ','ㅁ','ㅂ','ㅄ','ㅅ','ㅆ','ㅇ','ㅈ','ㅊ','ㅋ','ㅌ','ㅍ','ㅎ'],_d,_e,_f;var _g=this,_h=_g.length,_i=[],_j;for(var _k=0;_k<_h;_k++ ){_j=_g.charCodeAt(_k);if(_j==32){continue;}if(_j<0xAC00||_j>0xD7A3){_i.push(_g.charAt(_k));continue;}_j=_g.charCodeAt(_k)-0xAC00;_f=_j%28;_e=((_j-_f)/28)%21;_d=(((_j-_f)/28)-_e)/21;_i.push(_a[_d],_b[_e]);if(_c[_f]!==''){_i.push(_c[_f]);}}return _i;};pForm.gfnIsDigit=function(_a){var _b;var _c=0;var _d=true;if(this.gfnIsNull(_a)){return false;}for(var _e=0;_e<_a.length;_e++ ){_b=_a.charAt(_e);if(_e==0&&(_b=="+"||_b=="-")){}else if(_b>="0"&&_b<="9"){}else if(_b=="."){_c++ ;if(_c>1){_d=false;break;}}else{_d=false;break;}}return _d;};pForm.gfnIsKoreanChar=function(_a){var _b=true;for(i=0;i<_a.length;i++ ){if(!((_a.charCodeAt(i)>0x3130&&_a.charCodeAt(i)<0x318F)||(_a.charCodeAt(i)>=0xAC00&&_a.charCodeAt(i)<=0xD7A3))){_b=false;}}return _b;};pForm.gfnIsSpecialChar=function(_a){var _b=false;if(_a.search(/\W|\s/g)> -1){_b=true;}return _b;};pForm.gfnIsSSN=function(_a){var _b=this.gfnGetBirthYear(_a);_b+=_a.substr(0,2);var _c=_a.substr(2,2)-1;var _d=_a.substr(4,2);var _e=new Date(_b,_c,_d);if(_e.getYear()%100!=_a.substr(0,2)||_e.getMonth()!=_c||_e.getDate()!=_d){return false;}buf=new Array(13);for(i=0;i<6;i++ ){buf[i]=parseInt(_a.charAt(i));}for(i=6;i<13;i++ ){buf[i]=parseInt(_a.charAt(i));}multipliers=[2,3,4,5,6,7,8,9,2,3,4,5];for(i=0,sum=0;i<12;i++ ){sum+=(buf[i]*=multipliers[i]);}if((11-(sum%11))%10!=buf[12]){return false;}else{return true;}};pForm.gfnIsFrnrIdNo=function(_a){if(_a.length!=13||!isNumber(_a)){return false;}var _b=Number(_a.substr(2,2));var _c=Number(_a.substr(4,2));if(_b<1||_b>12){return false;}if(_c<1||_c>31){return false;}var _d=0;var _e=0;var _f=array(13);var _g=[2,3,4,5,6,7,8,9,2,3,4,5];for(var _h=0;_h<13;_h++ ){_f[_h]=Number(_a.charAt(_h));}if(_f[11]<6){return false;}_e=_f[7]* 10+_f[8];if((_e%2)!=0){return false;}for(var _h=0;_h<12;_h++ ){_d+=(_f[_h]* _g[_h]);}_d=11-(_d%11);if(_d>=10){_d-=10;}_d+=2;if(_d>=10){_d-=10;}if(_f[12]==_d){return true;}else{return false;}};pForm.gfnIsBzIdNo=function(_a){if(_a.length!=10){return false;}else{var _b=new Array(1,3,7,1,3,7,1,3,5,1);var _c,_d,_e=0,_f,_g;for(_d=0;_d<=7;_d++ ){_e+=_b[_d]* _a.charAt(_d);}_f="0"+(_b[8]* _a.charAt(8));_f=_f.substring(_f.length-2,_f.length);_e+=Math.floor(_f.charAt(0))+Math.floor(_f.charAt(1));_g=(10-(_e%10))%10;if(Math.floor(_a.charAt(9))==_g){return true;}return false;}return true;};pForm.gfnIsFirmIdNo=function(_a){if(_a.length!=13||!isNumber(_a)){return false;}var _b=0;var _c=new Array(13);var _d=[1,2,1,2,1,2,1,2,1,2,1,2];for(var _e=0;_e<13;_e++ ){_c[_e]=Number(_a.charAt(_e));}for(var _e=0;_e<12;_e++ ){_b+=(_c[_e]* _d[_e]);}_b=(10-(_b%10))%10;if(_c[12]==_b){return true;}else{return false;}};pForm.gfnIsCardNo=function(_a){if(_a.length<13||_a.length>19||!nexacro.isNumeric(_a)){return false;}var _b=0;var _c=new Array();for(var _e=0;_e<_a.length;_e++ ){_c[_e]=Number(_a.charAt(_e));}var _d;for(var _e=_c.length-1,_f=0;_e>=0;_e-- ,_f++ ){_d=_c[_e]* ((_f%2)+1);if(_d>=10){_d=_d-9;}_b+=_d;}if((_b%10)==0){return true;}else{return false;}};pForm.gfnIsEmail=function(_a){var _b=false;var _c="";var _d="[a-z0-9]+[a-z0-9.,]+@[a-z0-9]+[a-z0-9.,]+\\.[a-z0-9]+";var _e=new RegExp(_d,"ig");_c=_e.exec(_a);if(_c==null){_b=false;}else{if((_c.index==0)&&(_c[0].length==_a.length)){_b=true;}else{_b=false;}}return _b;};
var pForm=nexacro.Form.prototype;pForm.gfnOpenPopup=function(_a,_b,_c,_d,_e){var _f=this.gfnGetApplication();var _g= -1;var _h= -1;var _i= -1;var _j= -1;var _k=true;var _l=false;var _m="modal";var _n=false;var _o=100;var _p=false;var _q=false;var _d=(this.gfnIsNull(_d)&&this["fnPopupCallback"])?"fnPopupCallback":_d;var _r="";for(var _aa in _e){if(_e.hasOwnProperty(_aa)){switch(_aa){case "top":_h=parseInt(_e[_aa]);break;case "left":_g=parseInt(_e[_aa]);break;case "width":_i=parseInt(_e[_aa]);break;case "height":_j=parseInt(_e[_aa]);break;case "popuptype":_m=_e[_aa];break;case "layered":_n=_e[_aa];break;case "opacity":_o=_e[_aa];break;case "autosize":_p=_e[_aa];break;case "titlebar":if(""+_e[_aa]=="false"){_k=false;}break;case "title":_r=_e[_aa];break;}}}var _s="";if(_g== -1&&_h== -1){_s="center middle";if(system.navigatorname=="nexacro"){var _t=_f.mainframe.left;var _u=_f.mainframe.top;}else{var _t=window.screenLeft;var _u=window.screenTop;}_g=_t+(_f.mainframe.width/2)-Math.round(_i/2);_h=_u+(_f.mainframe.height/2)-Math.round(_j/2);}else{_g=this.getOffsetLeft()+_g;_h=this.getOffsetTop()+_h;}if(_i== -1||_j== -1){_p=true;}if(this.gfnIsNull(_c)==true){_c={};}_c["popupType"]=_m;_c["popupId"]=_a;_c["callback"]=_d;var _v=this.getOwnerFrame();if(_m=="modeless"){var _w="showtitlebar=true showstatusbar=false showontaskbar=true showcascadetitletext=false resizable=true autosize="+_p+" titletext='"+_r+"'";var _x=nexacro.getPopupFrames();if(_x[_a]){if(system.navigatorname=="nexacro"){_x[_a].setFocus();}else{_x[_a]._getWindowHandle().focus();}}else{nexacro.open(_a,_b,_v,_c,_w,_g,_h,_i,_j,this);}}else{var _y=new nexacro.ChildFrame;_y.init(_a,_g,_h,_i,_j,null,null,_b);_y.set_dragmovetype("all");_y.set_showcascadetitletext(false);_y.set_showtitlebar(_k);_y.set_autosize(_p);_y.set_resizable(_q);if(!this.gfnIsNull(_r)){_y.set_titletext(_r);}_y.set_showstatusbar(_l);_y.set_openalign(_s);_y.set_layered(_n);_y.set_overlaycolor("RGBA(0, 0, 0, 0.2)");if(_m=="modalsync"){system.showModalSync(_y,_v,_c);var _z=_v.form["rtnVal"];return _z;}else if(_m=="modalwindow"){var _z=system.showModalWindow(_y,_a,_v,_c);return _z;}else{_y.showModal(_v,_c,this,_d);}}};pForm.gfnClosePopup=function(_a){this.opener["rtnVal"]=_a;if(this.opener){var _b=this.getOwnerFrame();if(_b.popupType=="modeless"){var _c=_b.popupId;var _d=_b.callback;if(this.gfnIsNull(_d)==false){if(typeof (_d)=="function"){_d.call(this.opener,_c,_a);}else{this.opener.lookupFunc(_d).call(_c,_a);}}}}this.close(_a);};
var pForm=nexacro.Form.prototype;pForm.gfnInitLang=function(_a){var _b=nexacro.getEnvironmentVariable("evLanguage");var _c=nexacro.getEnvironmentVariable("evLanguageChange");if(_b=="KO"&&_b==_c){return;}var _d=_a.components;var _e=_d.length;for(var _g=0;_g<_e;_g++ ){if(_d[_g] instanceof nexacro.Div){if(this.gfnIsNull(_d[_g].url)){this.gfnInitLang(_d[_g].form);}}else if(_d[_g] instanceof nexacro.Tab){var _f=_d[_g].tabpages.length;for(var _h=0;_h<_f;_h++ ){if(this.gfnIsNull(_d[_g].tabpages[_h].url)){this.gfnChangeLang(_d[_g].tabpages[_h]);this.gfnInitLang(_d[_g].tabpages[_h].form);}}}else{this.gfnChangeLang(_d[_g]);}}_a.resetScroll();};pForm.gfnChangeLang=function(_a){var _b="";var _c="";if(_a instanceof nexacro.Button||_a instanceof nexacro.Static||_a instanceof nexacro.CheckBox||_a instanceof nexacro.Tabpage){_b=_a.uWord;if(this.gfnIsNull(_b)||this.gfnIsNull(_a.text)){return;}_c=this.gfnGetWord(_b);_a.set_text(_c);}else if(_a instanceof nexacro.ImageViewer){_b=_a.uWord;if(this.gfnIsNull(_b)||_b!="true"){return;}var _d=_a.image;var _e=_d.split(".");var _f=_e[_e.length-1].replace("\")","");var _g=nexacro.getEnvironmentVariable("evLanguage");var _h=nexacro.getEnvironmentVariable("evLanguageChange");if(_g!="KO"&&_h=="KO"){_d=_d.replace("_"+_g+"."+_f,"."+_f);}else{var _i=this.gfnPosReverse(_d,"."+_f);_d=_d.substr(0,_i)+"_"+nexacro.getEnvironmentVariable("evLanguageChange")+"."+_f+"\")";}_a.set_image(_d);}else if(_a instanceof nexacro.Grid){_a.set_enableevent(false);var _j=_a.getCellCount("head");for(var _k=0;_k<_j;_k++ ){_b=_a.getCellProperty("Head",_k,"expandchar");if(this.gfnIsNull(_b)){continue;}_c=this.gfnGetWord(_b);_a.setCellProperty("Head",_k,"text",String(_c));}_a.set_enableevent(true);}};pForm.gfnGetWord=function(_a){var _b=pForm.gfnGetApplication();var _c=_b.gdsWord;var _d=nexacro.getEnvironmentVariable("evLanguageChange");var _e=_a;var _f=_c.findRow("WORD",_a);if(_f!= -1){_e=_c.getColumn(_f,_d);}return _e;};
var pForm=nexacro.Form.prototype;pForm.fileConfig={uploadUrl:"file/saveFile.jsp?path=nexacro",downloadUrl:"file/downloadFile.jsp?path=nexacro&fileName=",deleteUrl:"file/deleteFile.jsp?path=nexacro",downImage:"theme://img_file.png",delImage:"theme://btn_del.png",allowTypes:["jpg","jpeg","gif","png","bmp","txt","zip","7z","gzip","doc","docx","ppt","pptx","xls","xlsx","pdf"],maxCount:10,maxSize:"20MB",maxTotalSize:"200MB"};pForm.iconInfo={file_icon_ZIP:["zip","rar","7z"],file_icon_IMG:["jpg","jpeg","gif","png","bmp"],file_icon_TXT:["txt","xml"],file_icon_DOC:["doc","docx"],file_icon_XLS:["xls","xlsx"],file_icon_PPT:["ppt","pptx"],file_icon_PDF:["pdf"],file_icon_ETC:["etc"]};pForm.extToIcon={};pForm.gfnFileUpload=function(_a,_b,_c){var _d=this.gfnGetServerUrl();if(this.gfnIsNull(_b)){_b=_d;}var _e=_b+"fileUpload.jsp";if(this.gfnIsNull(_c)){_c="PATH=upload";}var _f=_a.upload(_e+"?"+_c);trace("bSucc >> "+_f);};pForm.gfnFileDownload=function(_a,_b,_c,_d){var _e=this.gfnGetServerUrl();if(this.gfnIsNull(_c)){_c=_e;}var _f=_c+"fileDownload.jsp";if(this.gfnIsNull(_d)){_d="PATH=upload";}_a.download(_f+"?"+_d+"&file="+_b);};pForm.gfnGetFileName=function(_a,_b){var _c,_d,_e,_f;if(this.gfnIsNull(_a)){return "";}if(this.gfnIsNull(_b)){_b=false;}_c=Math.max(this.gfnPosReverse(_a,"\\"),this.gfnPosReverse(_a,"/"));_e=this.gfnPosReverse(_a,"::");if(_e>0){_e++ ;}_c=Math.max(_c,_e);if(_b==false){_d=this.gfnPosReverse(_a,".");if(_d<0){_d=_a.length;}_f=_a.substr(_c+1,_d-_c-1);}else{_f=_a.substr(_c+1);}return _f;};pForm.gfnInitExtToIcon=function(){var _a=this.extToIcon;var _b=this.iconInfo;for(var _d in _b){var _c=_b[_d].length;for(var _e=0;_e<_c;_e++ ){_a[_b[_d][_e]]=_d;}}};pForm.gfnGetFileIcon=function(_a){if(this.gfnIsNull(_a)){return;}_a=_a.toLowerCase();var _b=(/[.]/.exec(_a))?/[^.]+$/.exec(_a):undefined;var _c=this.extToIcon[_b];if(_c==undefined){_b="etc";}return "theme://"+this.extToIcon[_b]+".png";};pForm.gfnSizeToByte=function(_a){var _b=_a.match(/[^\d]+/g),_c=_a.match(/\d+/);_b=_b?_b[0].toLowerCase():"";_c=_c?_c[0]:_a;if(_b=="mb"){return _c* 1024* 1024;}else if(_b=="gb"){return _c* 1024* 1024* 1024;}else if(_b=="tb"){return _c* 1024* 1024* 1024* 1024;}else if(_b==""){return _c;}else{return _a;}};
var pForm=nexacro.Form.prototype;pForm.gfnAlert=function(_a,_b,_c,_d){var _e=pForm.gfnGetApplication();if(_e.gdsMessage.findRow("MSG_ID",_a)<0){return false;}var _f=nexacro.getEnvironmentVariable("evLanguage");var _g="MSG_TEXT";if(_f!="KO"){_g=_g+"_"+_f;}var _h=_e.gdsMessage.lookup("MSG_ID",_a,_g);if(this.gfnIsNull(_h)){_h="확인";}_h=_h.replace(/\\n/g,String.fromCharCode(10));_h=pForm.gfnConvertMessage(_h,_b);var _i=_e.gdsMessage.lookup("MSG_ID",_a,"MSG_TYPE");if(this.gfnIsNull(_c)){_c=_a;}var _j="";switch(_i){case "A":_j="Cmm::CmmAlert.xfdl";break;case "C":_j="Cmm::CmmConfirm.xfdl";if(this.gfnIsNull(_d)){trace("callback함수를 지정하지 않았습니다");}break;}var _k={paramContents:_h};var _l={titlebar:"false"};if(nexacro.getEnvironmentVariable("evMessagePopup")=="true"){this.gfnOpenPopup(_c,_j,_k,_d,_l);}else{if(_i=="A"){alert(_h);}else{confirm(_h);}}};pForm.gfnConvertMessage=function(_a,_b){return _a.replace(/\{(\d+)\}/g,function(){return _b[arguments[1]];});};pForm.gfnGetMessage=function(_a,_b){var _c=pForm.gfnGetApplication();if(_c.gdsMessage.findRow("MSG_ID",_a)<0){return false;}var _d=nexacro.getEnvironmentVariable("evLanguage");var _e="MSG_TEXT";if(_d!="KO"){_e=_e+"_"+_d;}var _f=_c.gdsMessage.lookup("MSG_ID",_a,_e);_f=_f.replace(/\\n/g,String.fromCharCode(10));_f=pForm.gfnConvertMessage(_f,_b);return _f;};
var pForm=nexacro.Form.prototype;pForm.defaultmenulis="sort,colfix,rowfix,filter,initial";pForm.selectmenulist="no,status,checkbox,replace,colhide,export,import,personal,cellcopypaste,userheader";pForm.popupmenulist="colfix,rowfix,filter,replace,colhide,export,import,personal,initial";pForm.SORT_TOGGLE_CANCEL=true;pForm.MARKER_TYPE="text";pForm.MARKER=["▲","▼"];pForm.tragetGrid="";pForm.gfnSetGrid=function(_a){var _b=_a.getBindDataset();if(this.gfnIsNull(_b)){return;}else{_b.bindgrid=_a;}var _c=this._getGridUserProperty(_a);if(this.gfnIsNull(_c)){return;}_a.orgformat=_a.getCurFormatString();_a.set_enableevent(false);_a.set_enableredraw(false);_b.set_enableevent(false);var _d=pForm.gfnGetApplication();var _e=_d.gdsGridPersonal;var _f=this._getUniqueId(_a);var _g;var _h=_e.findRow("sFormatId",_f);if(_h> -1){_a.orgformat2=_e.getColumn(_h,"sOrgFormat");_g="<Formats>"+_e.getColumn(_h,"sFormat")+"</Formats>";_a.set_formats(_g);}else{_a.orgformat2=_a.getFormatString();}_a.arrprop=_c;this._gfnGridAddProp(_a);this._gfnMakeGridPopupMenu(_a,_c);_a.addEventHandler("onheadclick",this.gfnGrid_onheadclick,this);for(var _j=0;_j<_c.length;_j++ ){var _i=this.popupmenulist.split(",");for(var _k=0;_k<_i.length;_k++ ){if(_c[_j]==_i[_k]){_a.addEventHandler("onrbuttondown",this.gfnGrid_onrbuttondown,this);break;}}if(_c[_j]=="cellcopypaste"){_a.addEventHandler("onkeydown",this.gfnGrid_onkeydown,this);}}_a.set_enableevent(true);_a.set_enableredraw(true);_b.set_enableevent(true);};pForm._gfnGridAddProp=function(_a){var _b=_a.arrprop;var _c=_a.getBindDataset();for(var _d=0;_d<_b.length;_d++ ){switch(_b[_d]){case "checkbox":this._gfnGridCheckboxNoStatusAdd(_a,_c,"checkbox");break;case "no":this._gfnGridCheckboxNoStatusAdd(_a,_c,"no");break;case "status":this._gfnGridCheckboxNoStatusAdd(_a,_c,"status");break;case "sort":_a.sort="true";break;default:break;}}};pForm._gfnGridCheckboxNoStatusAdd=function(_a,_b,_c){var _d;if(this.gfnIsNull(_b.insertheadcell)){_d=0;}else{_d=_b.insertheadcell;}var _e;if(this.gfnIsNull(_b.insertbodycell)){_e=0;}else{_e=_b.insertbodycell;}var _f=_a.getFormatRowCount();var _g= -1;var _h= -1;for(var _u=0;_u<_f;_u++ ){if(_a.getFormatRowProperty(_u,"band")=="head"){_g++ ;}if(_a.getFormatRowProperty(_u,"band")=="body"){_h++ ;}}var _i=this.gfnGetWord("cmm.no");var _j=this.gfnGetWord("cmm.status");if(_c=="checkbox"){_b.set_enableevent(false);var _k= -1;for(var _v=0;_v<_b.getColCount();_v++ ){var _l=_b.getColID(_v);if(_l=="gridcmmcheck"){_k=_v;}}if(_k<0){_b.addColumn("gridcmmcheck","STRING",1);}for(var _u=0;_u<_a.getCellCount("head");_u++ ){var _m=_a.getCellProperty("head",_u,"text");if(_m=="0"){var _n=this._gfnGridGetBodyCellIndex(_a,_u);var _o=this._gfnGridGetBindColumnNameByIndex(_a,_n);if(_o=="gridcmmcheck"){_a.deleteContentsCol("body",_u);}}}_a.insertContentsCol(_e);_a.setFormatColProperty(_e,"size","40");_a.setCellProperty("head",_d,"displaytype","checkboxcontrol");_a.setCellProperty("head",_d,"edittype","checkbox");_a.setCellProperty("head",_d,"text","0");_a.setCellProperty("body",_e,"displaytype","checkboxcontrol");_a.setCellProperty("body",_e,"edittype","checkbox");_a.setCellProperty("body",_e,"text","bind:gridcmmcheck");_a.mergeContentsCell("head",0,_e,_g,_e,_d,false);_a.mergeContentsCell("body",0,_e,_h,_e,_e,false);_d++ ;_e++ ;}if(_c=="no"){for(var _u=0;_u<_a.getCellCount("head");_u++ ){var _m=_a.getCellProperty("head",_u,"text");if(_m=="NO"||_m=="순번"){_a.deleteContentsCol("body",_u);}}_a.insertContentsCol(_e);_a.setFormatColProperty(_e,"size","50");_a.setCellProperty("head",_d,"text",_i);_a.setCellProperty("head",_d,"textAlign","center");_a.setCellProperty("body",_e,"text","expr:currow+1");_a.setCellProperty("body",_e,"textAlign","center");_a.mergeContentsCell("head",0,_e,_g,_e,_d,false);_a.mergeContentsCell("body",0,_e,_h,_e,_e,false);_d++ ;_e++ ;}if(_c=="status"){for(var _u=0;_u<_a.getCellCount("head");_u++ ){var _m=_a.getCellProperty("head",_u,"text");if(_m=="상태"||_m=="Status"){_a.deleteContentsCol("body",_u);}}var _p=nexacro.wrapQuote(this.gfnGetWord("insert"));var _q=nexacro.wrapQuote(this.gfnGetWord("modify"));var _r=nexacro.wrapQuote(this.gfnGetWord("delete"));var _s="expr:"+"dataset.getRowType(currow)==2?"+_p+":dataset.getRowType(currow)==4?"+_q+":dataset.getRowType(currow)==8?"+_r+":''";var _t=50;if(nexacro.getEnvironmentVariable("evLanguage")=="EN"){_t=80;}_a.insertContentsCol(_e);_a.setFormatColProperty(_e,"size",_t);_a.setCellProperty("head",_d,"text",_j);_a.setCellProperty("head",_d,"textAlign","center");_a.setCellProperty("body",_e,"displaytype","expr:dataset.getRowType(currow) != 1 ? 'text' : ''");_a.setCellProperty("body",_e,"text",_s);_a.setCellProperty("body",_e,"textAlign","center");_a.mergeContentsCell("head",0,_e,_g,_e,_d,false);_a.mergeContentsCell("body",0,_e,_h,_e,_e,false);_d++ ;_e++ ;}};pForm.gfnGrid_onheadclick=function(_a,_b){var _c=_a.getCellProperty("head",_b.cell,"displaytype");if(_c=="checkboxcontrol"){this._gfnHeadCheckSelectAll(_a,_b);}else{if(this.gfnIsNull(_a.sort)||_a.sort=="false"){return;}else if(_a.sort=="true"){var _d=_a.arrprop;var _e=this._gfnGridUserHeaderFlg(_a);var _f=false;if(_b.ctrlkey){_f=true;}if(!_e){var _g=this._gfnGridSetSortStatus(_a,_b.cell,_f);if(_g){this._gfnGridExecuteSort(_a);}}else{this._gfnGirdUserHeaderExcuteSort(_a,_b.cell,_f);}}}};pForm.gfnGrid_onkeydown=function(_a,_b){var _c=_b.keycode;var _d=system.navigatorname;if(_b.ctrlkey){if(_c==67){if(_d=="nexacro"||_d=="IE"){this._gfnGridCopyEventForRuntime(_a,_b);}else{this._gfnGridCopyEventForChrome(_a,_b);}}else if(_c==86){this._gfnGridPasteEvent(_a,_b);}}};pForm._gfnGridUserHeaderFlg=function(_a){var _b=_a.arrprop;var _c=false;for(var _d=0;_d<_b.length;_d++ ){if(_b[_d]=="userheader"){_c=true;}}return _c;};pForm._gfnGirdUserHeaderExcuteSort=function(_a,_b,_c){var _d=_a.getCellProperty("head",_b,"calendarweekformat");if(this.gfnIsNull(_d)){return false;}var _e=0;var _f=_a.getCellCount("body");for(var _i=0;_i<_f;_i++ ){var _g=_a.getCellProperty("body",_i,"text");if(_g==_d){_e=_i;break;}}var _h=this._gfnGridSetSortStatus(_a,_b,_c,"",_e);if(_h){this._gfnGridExecuteSort(_a);}};pForm._gfnGridSetSortStatus=function(_a,_b,_c,_d,_e){if(this.gfnIsNull(_e)){_e=this._gfnGridGetBodyCellIndex(_a,_b);}if(_e<0){return false;}var _f=this._gfnGridGetBindColumnNameByIndex(_a,_e);if(this.gfnIsNull(_f)){trace("Check Grid body cell bind value");return false;}if(this.gfnIsNull(_c)){_c=false;}if(this.gfnIsNull(_d)){_d= -1;}if(this.gfnIsNull(_a.sortInfos)){_a.sortInfos={};}if(this.gfnIsNull(_a.sortItems)){_a.sortItems=[];}var _g=_a.sortInfos,_h=_a.sortItems,_i=_g[_f],_j,_k;if(this.gfnIsNull(_i)){var _l=_a.getCellText( -1,_b);var _m=this._gfnGridGetGridCellObject(_a,"head",_b);_i=_g[_f]={status:0,text:_l,refCell:_m};}if(_c){_k=_i.status;if(_d== -1){if(_k==0){_i.status=1;}else if(_k==1){_i.status=2;}else if(_k==2){_i.status=(this.SORT_TOGGLE_CANCEL?0:1);}}else{_i.status=_d;}}else{for(var _o in _g){if(_g.hasOwnProperty(_o)){_i=_g[_o];if(_o==_f){_k=_i.status;if(_d== -1){if(_k==0){_i.status=1;}else if(_k==1){_i.status=2;}else if(_k==2){_i.status=(this.SORT_TOGGLE_CANCEL?0:1);}}else{_i.status=_d;}}else{_i.status=0;}if(_i.status==0){for(var _p=0,_q=_h.length;_p<_q;_p++ ){if(_h[_p]!==_f){_h.splice(_p,1);break;}}}}}}var _n=false;for(var _r=0,_s=_h.length;_r<_s;_r++ ){if(_h[_r]==_f){_n=true;break;}}if(!_n){_h.push(_f);}return true;};pForm._gfnGridGetBodyCellIndex=function(_a,_b,_c){if(this.gfnIsNull(_c)){_c=false;}var _d=0;for(var _p=0,_q=_a.getCellCount("head");_p<_q;_p++ ){var _e=_a.getCellProperty("head",_p,"row");if(_d<_e){_d=_e;}}var _f=0;for(var _p=0,_q=_a.getCellCount("body");_p<_q;_p++ ){var _e=_a.getCellProperty("body",_p,"row");if(_f<_e){_f=_e;}}if(_d==0&&_f==0){_c=true;}var _g= -1;var _h= -1;var _i=parseInt(_a.getCellProperty("head",_b,"row"));var _j=parseInt(_a.getCellProperty("head",_b,"col"));var _k=parseInt(_a.getCellProperty("head",_b,"colspan"));if(_d>_f){_h=_i-(_d-_f);_h=(_h<0?0:_h);}else{_h=_i;}var _l,_m,_n,_o;for(var _p=0,_q=_a.getCellCount("body");_p<_q;_p++ ){_l=parseInt(_a.getCellProperty("body",_p,"row"));_m=parseInt(_a.getCellProperty("body",_p,"col"));_n=parseInt(_a.getCellProperty("body",_p,"colspan"));_o=parseInt(_a.getCellProperty("body",_p,"rowspan"));if(_o>1){if(_c){if(_h>=_l&&_j<=_m&&_m<(_j+_k)){_g=_p;break;}}else{if(_h>=_l&&_j==_m&&_k==_n){_g=_p;break;}}}else{if(_c){if(_h==_l&&_j<=_m&&_m<(_j+_k)){_g=_p;break;}}else{if(_h==_l&&_j==_m&&_k==_n){_g=_p;break;}}}}return _g;};pForm._gfnGridGetBindColumnNameByIndex=function(_a,_b){var _c="";var _d="";var _e=_a.getCellProperty("body",_b,"subcell");if(_e>0){_c=_a.getSubCellProperty("body",_b,0,"text");}else{_c=_a.getCellProperty("body",_b,"text");}if(!this.gfnIsNull(_c)){if(_c.search(/^BIND\(/)> -1){_d=_c.replace(/^BIND\(/,"");_d=_d.substr(0,_d.length-1);}else if(_c.search(/^bind:/)> -1){_d=_c.replace(/^bind:/,"");}}return _d;};pForm._gfnGridExecuteSort=function(_a){var _b,_c,_d=_a.sortInfos,_e=_a.sortItems,_f,_g,_h,_i="";if(this.gfnIsNull(_d)||this.gfnIsNull(_e)){return;}for(var _u=0;_u<_e.length;_u++ ){_f=_e[_u];_b=_d[_f];_g=_b.status;_h=_b.refCell;if(this.gfnIsNull(_h)||_a.getBindCellIndex("body",_f)<0){_e.splice(_u,1);_d[_f]=null;delete _d[_f];_u-- ;}else if(_g>0){_i+=(_g==1?"+":"-")+_f;}}var _j=_a.getBindDataset();var _k=_j.keystring;var _l="";if(_k.length>0&&_k.indexOf(",")<0){var _m=_k.indexOf("S:");var _n=_k.indexOf("G:");if(_m> -1){_l="";}else{if(_n<0){_l="G:"+_k;}else{_l=_k;}}}else{var _o=_k.split(",");var _p;for(var _u=0,_v=_o.length;_u<_v;_u++ ){_p=_o[_u];if(_p.length>0&&_p.indexOf("S:")<0){if(_p.indexOf("G:")<0){_l="G:"+_p;}else{_l=_p;}}}}if(_i.length>0){var _q="S:"+_i;if(_l.length>0){_j.set_keystring(_q+","+_l);}else{_j.set_keystring(_q);}_a.sortKeyString=_q;}else{_j.set_keystring(_l);_a.sortKeyString="";}var _r=this.MARKER_TYPE;var _s,_t;for(var _w in _d){if(_d.hasOwnProperty(_w)){_b=_d[_w];_h=_b.refCell;if(_h){_s=_h._cellidx;_t=this.gfnDecode(_b.status,1,this.MARKER[0],2,this.MARKER[1],"");_a.setCellProperty("head",_s,"text",_b.text+_t);}}}};pForm._gfnGridGetGridCellObject=function(_a,_b,_c){var _d;var _e=_a._curFormat;if(_e){if(_b=="head"){_d=_e._headcells[_c];}else if(_b=="body"){_d=_e._bodycells[_c];}else if(_b=="summ"||_b=="summary"){_d=_e._summcells[_c];}}return _d;};pForm._gfnClearSortMark=function(_a){var _b=_a.sortInfos;var _c=_a.sortItems;if(this.gfnIsNull(_b)||this.gfnIsNull(_c)){return;}for(var _f=0;_f<_c.length;_f++ ){var _d=_c[_f];var _e=_b[_d];_e.status=0;}this._gfnGridExecuteSort(_a);_a.sortInfos={};_a.sortItems=[];};pForm.gfnGrid_onrbuttondown=function(_a,_b){var _c=pForm.gfnGetApplication();_a.popupMenu.grid=_a;_a.popupMenu.cellindex=_b.cell;_a.popupMenu.rowindex=_b.row;var _d=nexacro.toNumber(system.getCursorX())-nexacro.toNumber(system.clientToScreenX(_a,0));var _e=nexacro.toNumber(system.getCursorY())-nexacro.toNumber(system.clientToScreenY(_a,0));var _f=nexacro.getEnvironmentVariable("evRunMode");if(_f=="S"){_e+=83;}_a.popupMenu.trackPopupByComponent(_a,_d,_e);};pForm.gfnPopupmenu_onmenuclick=function(_a,_b){var _c=_b.id;var _d=_a.grid;var _e=_a.cellindex;var _f=_a.rowindex;switch(_c){case "colfix":this.fv_CellIndex=_e;this._gfnGridcellFix(_d,this.fv_CellIndex,_f);break;case "colfixfree":this._gfnGridCellFree(_d);break;case "rowfix":if(_f<0){return;}_d.fixedRow=_f;this._gfnGridSetCssclass(_d);break;case "rowfixfree":_d.fixedRow= -1;this._gfnGridSetCssclass(_d);break;case "filter":this._gfnGridFilter(_d);break;case "filterfree":this._gfnGridCellFilterFree(_d);break;case "replace":this._gfnGridCellReplace(_d,_e,_f);break;case "colhide":this._gfnGridColHideShow(_d,_f);break;case "export":this._gfnGridExcelExport(_d,_f);break;case "import":this._gfnGridExcelImport(_d,_f);break;case "personal":this._gfnGridPersonalize(_d);break;case "initial":_d.set_formats("<Formats>"+_d.orgformat2+"</Formats>");this._gfnGridAddProp(_d);break;default:break;}};pForm._gfnGridSetCssclass=function(_a){var _b="Cell_WF_Fixed";_b=nexacro.wrapQuote(_b);_a.set_enableredraw(false);for(var _d=0;_d<_a.getFormatColCount();_d++ ){var _c="";if(_a.fixedRow>=0){_c="expr:comp.fixedRow==currow?"+_b+":''";}_a.setCellProperty("body",_d,"cssclass",_c);}_a.set_enableredraw(true);_a.setFixedRow(_a.fixedRow);};pForm._gfnHeadCheckSelectAll=function(_a,_b){if(_a.readonly==true){return;}var _c;var _d;var _e;var _f;var _g;var _h=_b.cell;var _i;var _j=_a.getSubCellCount("head",_h);_g=_a.getBindDataset();if(_g.getRowCount()<1){return;}if(_a.getCellCount("body")!=_a.getCellCount("head")){_i=parseInt(_a.getCellProperty("head",_h,"col"));}else{_i=_b.cell;}_f=_a.getCellProperty("body",_i,"text");_f=_f.toString().replace("bind:","");_c=_a.getCellProperty("head",_h,"displaytype");if(_c!="checkboxcontrol"){return;}_e=_a.getCellProperty("head",_h,"text");if(_e=="1"){_a.setCellProperty("head",_h,"text","0");var _k=this._gfnGridGetBodyCellIndex(_a,_h);var _l=this._gfnGridGetBindColumnNameByIndex(_a,_k);if(_l=="gridcmmcheck"){_d="";}else{_d="0";}}else{_a.setCellProperty("head",_h,"text","1");_d="1";}_g.set_enableevent(false);for(var _m=0;_m<_g.rowcount;_m++ ){_g.setColumn(_m,_f,_d);}_g.set_enableevent(true);};pForm._gfnMakeGridPopupMenu=function(_a,_b){var _c=pForm.gfnGetApplication();var _d=_c.gdsGridPopupMenu;var _e=_a.parent;var _f="dsPopupMenu_"+_a.name+"_"+this.name;var _g=new Dataset(_f);_e.addChild(_f,_g);_g.copyData(_c.gdsGridPopupMenu);for(var _n=0;_n<_b.length;_n++ ){for(var _o=0;_o<_g.rowcount;_o++ ){var _h=_g.getColumn(_o,"id");if(this.gfnIsNull(_h)){continue;}if(_h.indexOf(_b[_n])> -1){_g.setColumn(_o,"enable","true");if(_g.getColumn(_o,"level")==1){var _i=_g.getColumn(_o,"upmenu");var _j=_g.findRow("id",_i);if(_j> -1){_g.setColumn(_j,"enable","true");}}}}}var _k="popMenu_"+_a.name+"_"+this.name;var _l=new PopupMenu(_k,0,0,100,100);var _m=nexacro.getEnvironmentVariable("evLanguage");_e.addChild(_l.name,_l);_l.set_innerdataset(_f);if(_m=="KO"){_l.set_captioncolumn("caption");}else{_l.set_captioncolumn("captionEN");}_l.set_enablecolumn("enable");_l.set_idcolumn("id");_l.set_levelcolumn("level");_l.addEventHandler("onmenuclick",this.gfnPopupmenu_onmenuclick,_e);_l.show();_l.grid=_a;_a.popupMenu=_l;};pForm._getGridUserProperty=function(_a){var _b=_a.griduserproperty;var _c=this.defaultmenulis.split(",");var _d=[];if(!this.gfnIsNull(_b)){_d=_b.split(",");for(var _f=0;_f<_d.length;_f++ ){if(_d[_f].indexOf("!")==0){for(var _g=0;_g<_c.length;_g++ ){if(_c[_g]==_d[_f].substr(1)){_c[_g]="";}}_d[_f]="";}}}var _e=[];for(var _f=0;_f<_c.length;_f++ ){if(!this.gfnIsNull(_c[_f])){_e.push(_c[_f]);}}for(var _f=0;_f<_d.length;_f++ ){if(!this.gfnIsNull(_d[_f])){_e.push(_d[_f]);}}return _e;};pForm._gfnGridcellFix=function(_a,_b,_c){var _d;if(_c== -1){_d="Head";}else if(_c== -2){_d="Summary";}else{_d="Body";}var _e=nexacro.toNumber(_a.getCellProperty(_d,_b,"col"));var _f=nexacro.toNumber(_a.getCellProperty(_d,_b,"colspan"));var _g=nexacro.toNumber(_a.getCellProperty(_d,_b,"rowspan"));var _h=_a.getCellpos;var _i=0;var _j;var _k;var _l;var _m;_a.set_enableredraw(false);_a.setFormatColProperty(0,"band","body");for(_j=0;_j<_a.getCellCount("Head");_j++ ){_k=nexacro.toNumber(_a.getCellProperty("Head",_j,"col"));_l=nexacro.toNumber(_a.getCellProperty("Head",_j,"colspan"));_m=_k+_l-1;if(_k==_e||_m==_e){if(_l>1){_e=_m;}else{_e=_m;}}else{_a.setCellProperty("Head",_j,"line","");}}for(_j=0;_j<_a.getCellCount("Body");_j++ ){if(_a.getCellProperty("Body",_j,"col")==_e){_a.setCellProperty("Body",_j,"border","1px solid #dbdee2 , 2px solid aqua , 1px solid #dbdee2 , 1px solid #dbdee2");}else{_a.setCellProperty("Body",_j,"border","");}}_a.setFormatColProperty(_e,"band","left");_a.set_enableredraw(true);};pForm._gfnGridCellFree=function(_a){for(i=0;i<_a.getFormatColCount();i++ ){_a.setFormatColProperty(i,"band","body");}for(i=0;i<_a.getCellCount("Body");i++ ){_a.setCellProperty("Body",i,"border","");}this.gv_CellIndex= -1;};pForm._gfnGridFilter=function(_a){var _b=this.gfnGetWord("popup.datafiltersetting");var _c={pvGrid:_a};var _d={title:_b};var _e="gfnGridFilterCallback";this.gfnOpenPopup("cmmGridFilter","Cmm::CmmGridFilter.xfdl",_c,_e,_d);};pForm._gfnGridCellFilterFree=function(_a){var _b=_a.getBindDataset();_b.set_filterstr("");};pForm._gfnGridCellReplace=function(_a,_b,_c){var _d=this.gfnGetWord("popup.datafindreplace");var _e=_a.selecttype;var _f={pvGrid:_a,pvStrartRow:_c,pvSelectCell:_b,pvSelectType:_e};var _g={title:_d};var _h="gfnReplaceCallback";this.gfnOpenPopup("cmmFindReplace","Cmm::CmmFindReplace.xfdl",_f,_h,_g);};pForm._gfnGridColHideShow=function(_a){var _b=this.gfnGetWord("popup.colshwohide");var _c={pvGrid:_a};var _d={title:_b};var _e="gfnColumnHidCallback";this.gfnOpenPopup("cmmColumnHide","Cmm::CmmColumnHide.xfdl",_c,_e,_d);};pForm._gfnGridExcelExport=function(_a){this.gfnExcelExport(_a,"*?*?*?*?*?*?*?","");};pForm._gfnGridExcelImport=function(_a){var _b=_a.binddataset;this.gfnExcelImport(_b,"sheet1","A2","fnImportCallback",_a.name+_b,this);};pForm._gfnGridPersonalize=function(_a){var _b=_a.orgformat2;var _c=_a.getCurFormatString();this._gfnGridPersonalizeExcute(_a);};pForm._getUniqueId=function(_a){var _b;var _c=_a.parent;while(true){if(_c instanceof nexacro.ChildFrame){break;}else{_c=_c.parent;}}_b=_c.name;if(_b.indexOf("win")> -1){_b=_c.form.divWork.form.name;}var _d=_a.parent.parent;if(_d instanceof nexacro.Tabpage){_b+="_"+_d.parent.name+"_"+_d.name;}else if(_d instanceof nexacro.Div&&_d.name!="divWork"){_b+="_"+_d.name;}_b+="_"+_a.name;return _b;};pForm._gfnGridPersonalizeExcute=function(_a){var _b=this._getUniqueId(_a);var _c=_a.getCurFormatString(false);var _d=_a.getFormatString();var _e=pForm.gfnGetApplication();var _f=_e.gdsGridPersonal;var _g=_f.findRow("sFormatId",_b);if(_g== -1){var _h=_f.addRow();_f.setColumn(_h,"sFormatId",_b);_f.setColumn(_h,"sFormat",_c);_f.setColumn(_h,"sOrgFormat",_d);}else{_f.setColumn(_g,"sFormat",_c);}var _i=_f.saveXML();nexacro.setPrivateProfile("gdsGridPersonal",_i);this.gfnAlert("msg.save.success","","saveSuccess","gfnGridFormatChangeMsgCallback");};pForm.gfnGridFormatChangeMsgCallback=function(_a,_b){};pForm.gfnReplaceCallback=function(_a,_b){};pForm.gfnGridFilterCallback=function(_a,_b){};pForm.gfnColumnHidCallback=function(_a,_b){};pForm.gfnFindGridText=function(_a,_b,_c){_a.lastFindText=_b;_a.lastFindOption=_c;var _d=_c.direction;var _e=_c.position;var _f=_c.scope;var _g=_c.condition;var _h=_c.strict;var _i=_a.getBindDataset();var _j=(_e=="current"?_a.currentcell:_a.lastFindCell);var _k=(_e=="current"?_a.currentrow:_a.lastFindRow);if(_f=="col"&&!this.gfnIsNull(_c.cell)){_j=_c.cell;}var _l=findCell= -1;var _m=_i.rowcount;var _n=_a.getCellCount("body");if(!_h){_b=_b.toUpperCase();}if(_d=="prev"){_k-=1;if(_k<0){_k=_m-1;}}else{_k+=1;if(_k>=_m){_k=0;}}var _o=_m;while(_o>0){if(this._compareFindText(_a,_k,_j,_b,_g,_h)){_l=_k;findCell=_j;break;}if(_d=="prev"){_k-=1;if(_k<0){_k=_m-1;}}else{_k+=1;if(_k>(_m-1)){_k=0;}}_o-- ;}if(_l> -1&&findCell> -1){_a.lastFindRow=_l;_a.lastFindCell=findCell;}return [_l,findCell];};pForm.gfnReplaceGridText=function(_a,_b,_c,_d,_e){_a.lastFindText=_b;_a.lastFindOption=_d;if(this.gfnIsNull(_e)){_e=false;}var _f=_d.direction;var _g=_d.position;var _h=_d.condition;var _i=_d.strict;var _j=_d.cell;var _k=_a.getBindDataset();var _l=_d.cell;var _m;if(_g=="current"){_m=_a.currentrow;}else{var _n=_a.lastReplaceRow;if(this.gfnIsNull(_n)){_m=0;}else{_m=_n;}}var _o=[];var _p=findCell= -1;var _q=_k.rowcount;var _r=_a.getCellCount("body");if(!_i){_b=_b.toUpperCase();}var _s;var _t=_q;while(_t>0){if(this._compareFindText(_a,_m,_l,_b,_h,_i)){_p=_m;findCell=_l;_s=this._replaceGridCellText(_a,_p,findCell,_b,_c,_i);_o.push(_s);if(!_e){break;}}if(_f=="prev"){_m-=1;if(_m<0){_m=_q-1;}}else{_m+=1;if(_m>(_q-1)){_m=0;}}_t-- ;}_a.lastReplaceRow=_p;return _o;};pForm._replaceGridCellText=function(_a,_b,_c,_d,_e,_f){var _g={'replace':true,'message':'처리되었습니다.','row':_b,'cell':_c};var _h=_a.getBindDataset();_h.set_rowposition(_b);_a.setCellPos(_c);var _i=_a.getCellProperty("body",_c,"displaytype");var _j=_a.getCellProperty("body",_c,"edittype");var _k=_a.getCellProperty("body",_c,"text");var _l=_k.replace("bind:","");var _m=this.gfnGetBindColumnType(_a,_c);if(this.gfnIsNull(_i)||_i=="normal"){switch(_m){case 'INT':case 'FLOAT':case 'BIGDECIMAL':_i="number";break;case 'DATE':case 'DATETIME':case 'TIME':_i="date";break;default:_i="text";}}var _n;var _o;var _p=_h.getColumn(_b,_l);var _q=_a.getCellText(_b,_c);if(_i=="number"||_i=="currency"){if(_i=="currency"){var _r=_d.charCodeAt(0);if(_r==65510||_r==92){_d=_d.substr(1);}_r=_e.charCodeAt(0);if(_r==65510||_r==92){_e=_e.substr(1);}_r=_q.charCodeAt(0);if(_r==65510||_r==92){_q=_q.substr(1);}}if(_f){_q=_q.replace(_d,_e);}else{_q=this.gfnReplaceIgnoreCase(_q,_d,_e);}_o=this._replaceNumberMaskValue(_q);}else if(_i=="date"||_i=="calendarcontrol"){if(_p==null){_g.replace=false;_g.message="유효한 날짜가 아닙니다.";}else{var _s=_a.getCellProperty("body",_c,"calendardateformat");var _t=this._replaceDateMaskValue(_p,_q,_d,_e,_s,_f);_o=_t[1];if(_t[0]==false){_g.replace=false;_g.message=_t[2];}}}else{if(_f){_o=_p.replace(_d,_e);}else{_o=this.gfnReplaceIgnoreCase(_p,_d,_e);}}if(_g.replace){_h.setColumn(_b,_l,_o);}return _g;};pForm.gfnReplaceIgnoreCase=function(_a,_b,_c){var _d,_e=0,_f="";while(1){_d=_a.toLowerCase().indexOf(_b.toLowerCase(),_e);if(_d<0){_f+=_a.substr(_e);break;}else{_f+=_a.substr(_e,_d-_e);_f+=_c;_e=_d+_b.length;}}return _f;};pForm._replaceDateMaskValue=function(_a,_b,_c,_d,_e,_f){if(this.gfnIsNull(_d)){_d=_d.padRight(_c.length," ");}var _g;if(_f){_g=_b.replace(_c,_d);}else{_g=this.gfnReplaceIgnoreCase(_b,_c,_d);}if(this.gfnIsNull(_g.trim())){return [true,null];}var _h=this._parseDateMask(_e);var _i="";var _j=true;var _k="";var _l=0;var _m=0;var _n=[];var _o=[];var _p;var _q= -1;var _r="";var _s="";for(var _w=0,_x=_h.length;_w<_x;_w++ ){_p=_h[_w];if(!this.gfnIsDigit(_p)){switch(_p){case 'yyyy':_i=_g.substr(_m,4);if(_i.length!=4||!nexacro.isNumeric(_i)){_j=false;_k="연도가 올바르지 않습니다.";}_r=_i;_n[_n.length]=_i.trim(" ");_o[_o.length]=_i.trim(" ");_m+=4;_l+=4;break;case 'yy':case 'MM':case 'dd':case 'hh':case 'HH':case 'mm':case 'ss':_i=_g.substr(_m,2);if(_i.length==2&&nexacro.isNumeric(_i)){if(_p=="yy"){_i=_a.substr(_l,2)+_i;_r=_i;}else if(_p=="MM"){if(parseInt(_i)<1||parseInt(_i)>12){_j=false;_k="월이 올바르지 않습니다.";}_s=_i;}else if(_p=="dd"){_q=_n.length;}else if(_p=="hh"||_p=="HH"){if(parseInt(_i)<0||parseInt(_i)>23){_j=false;_k="시간이 올바르지 않습니다.";}}else if(_p=="mm"||_p=="ss"){if(parseInt(_i)<0||parseInt(_i)>59){_j=false;_k="분이 올바르지 않습니다.";}}}else{_j=false;_k="날짜 형식이 올바르지 않습니다.";}_n[_n.length]=_i.trim(" ");_o[_o.length]=_i.trim(" ");_m+=2;_l+=2;break;}}else{_o[_o.length]=_b.charAt(_p);_m+=1;}}if(!this.gfnIsNull(_r)&&!this.gfnIsNull(_s)&&_q> -1){var _t=_r+_s+"01";var _u=parseInt(_n[_q]);var _v=this.gfnGetMonthLastDay(_t);}if(_j){return [_j,_n.join("")];}else{return [_j,_o.join(""),_k];}};pForm._parseDateMask=function(_a){arrMask=[];var _b;var _c=_a.split("");var _d="";var _e="";var _f=0;for(var _g=0,_h=_a.length;_g<_h;){_d=_a.substr(_g,4);if(_d=="yyyy"){arrMask[_f]=_d;_g+=4;_f++ ;continue;}_d=_a.substr(_g,3);if(_d=="ddd"){_g+=3;continue;}_d=_a.substr(_g,2);if(_d=="yy"||_d=="MM"||_d=="dd"||_d=="HH"||_d=="hh"||_d=="mm"||_d=="ss"){arrMask[_f]=_d;_g+=2;_f++ ;continue;}_e=_c[_g];if(_e=="H"||_e=="M"||_e=="d"||_e=="m"||_e=="s"){}else{arrMask[_f]=_g;_f++ ;}_g++ ;}return arrMask;};pForm._replaceNumberMaskValue=function(_a){_a=_a.trim();var _b=/[0-9]/;var _c=false;var _d=false;var _e,_f=[];for(var _g=0,_h=_a.length;_g<_h;_g++ ){_e=_a.charAt(_g);if((_e=='+'||_e=='-')&&(_d===false)){_f.push(_e);_d=true;}else if(_b.test(_e)){_f.push(_e);_d=true;}else if(_e=="."&&_c===false){_f.push(_e);_c=true;_d=true;}else if(_e!=","){return "";}}return _f.join("");};pForm._compareFindText=function(_a,_b,_c,_d,_e,_f){var _g=_a.getCellText(_b,_c);if(this.gfnIsNull(_g)){return;}var _h=_a.getCellProperty("body",_c,"displaytype");if(this.gfnIsNull(_h)||_h=="normal"){var _i=this.gfnGetBindColumnType(_a,_c);switch(_i){case 'INT':case 'FLOAT':case 'BIGDECIMAL':_h="number";break;case 'DATE':case 'DATETIME':case 'TIME':_h="date";break;default:_h="string";}}if(_h=="currency"){var _j=_g.charCodeAt(0);if(_j==65510||_j==92){_g=_g.substr(1);}_j=_d.charCodeAt(0);if(_j==65510||_j==92){_d=_d.substr(1);}}if(!_f){_g=_g.toUpperCase();}if(_e=="equal"){if(_d==_g){return true;}}else{if(_g.indexOf(_d)> -1){return true;}}return false;};pForm.gfnGetBindColumnType=function(_a,_b){var _c=null;var _d=this.gfnLookup(_a.parent,_a.binddataset);var _e=_a.getCellProperty("body",_b,"text");_e=_e.replace("bind:","");if(!this.gfnIsNull(_e)){var _f=_d.getColumnInfo(_e);if(!this.gfnIsNull(_f)){_c=_f.type;}}return _c;};pForm._gfnGridCopyEventForRuntime=function(_a,_b){var _c=nexacro.toNumber(_a.selectstartrow);if(_c== -9){return;}var _d=nexacro.toNumber(_a.selectendrow);if(_d== -9){return;}var _e=0;var _f=0;if(_a.selecttype=="row"||_a.selecttype=="multirow"){_e=0;_f=_a.getCellCount("body")-1;}else{_e=nexacro.toNumber(_a.selectstartcol);_f=nexacro.toNumber(_a.selectendcol);}var _g="\t";var _h="";var _i={};for(var _l=_c;_l<=_d;_l++ ){for(var _m=_e;_m<=_f;_m++ ){var _j=_a.getCellValue(_l,_m);if(!this.gfnIsNull(_j)){if(_m<_f){_h+=_a.getCellValue(_l,_m)+_g;}else{_h+=_a.getCellValue(_l,_m);}}}if(_l<_a.selectendrow){_h+="\r\n";}}_h+="\r\n";system.clearClipboard();system.setClipboard("CF_TEXT",_h);var _k={"startrow":_c,"startcol":_e,"endrow":_d,"endcol":_f};};pForm._gfnGirdGetPasteData=function(_a){var _b="";if(_a=="nexacro"||_a=="IE"){_b=system.getClipboard("CF_TEXT");_b=new String(_b);}else{var _c=this.tragetGrid["ta"];if(!_c){return;}_b=_c.value;document.body.removeChild(_c);this.tragetGrid["ta"]=undefined;}return _b;};pForm._gfnGridPasteEvent=function(_a,_b){var _c=system.navigatorname;var _d=this._gfnGirdGetPasteData(_c);if(this.gfnIsNull(_d)){var _d="";var _e=this._createTextarea("");nexacro._OnceCallbackTimer.callonce(this,function(){var _f="\t";var _g="";if(_c=="nexacro"||_c=="IE"){_g=_d.split("\r\n");if(_h<1){_b.stopPropagation();return;}}else{_d=_e.value;_g=_d.split(/[\n\f\r]/);}var _h=_g.length-1;_a.set_enableevent(false);_a.set_enableredraw(false);var _i=_a.binddataset;var _j=_a.getBindDataset();_j.set_enableevent(false);var _k=_a.getCellCount("body");var _l=_j.getRowCount();var _m=nexacro.toNumber(_a.selectstartrow);if(_m== -9){return;}var _n=nexacro.toNumber(_a.selectendrow);if(_n== -9){return;}var _o=0;var _p=0;if(_a.selecttype=="row"||_a.selecttype=="multirow"){_o=0;_p=_a.getCellCount("body")-1;}else{_o=nexacro.toNumber(_a.selectstartcol);_p=nexacro.toNumber(_a.selectendcol);}var _q=_m;var _r=_o;var _s=0;var _t={};for(var _ab=0;_ab<_h;_ab++ ){if(_l<=_q){_j.addRow();}var _u=_g[_ab].split(_f);var _v=_r+_u.length;if(_v>_k){_v=_k;}if(_s<_v){_s=_v;}var _w=0;for(var _ac=_r;_ac<_v;_ac++ ){var _x=_a.getCellProperty("body",_ac,"text");var _y;if(this.gfnIsNull(_x)){_y=_a.getCellProperty("body",_ac,"text");}else{_y=_a.getCellProperty("body",_ac,"text").substr(5);}var _z=_u[_w];if(!this.gfnIsNull(_z)){_j.setColumn(_q,_y,_z);}_w++ ;}_q++ ;}_j.rowposition=_q;_n=_n+_h-1;_p=_s-1;system.clearClipboard();_a.set_enableredraw(true);_a.set_enableevent(true);_j.set_enableevent(true);_a.selectArea(_m,_o,_n,_p);var _aa={"startrow":_m,"startcol":_o,"endrow":_n,"endcol":_p};_b.stopPropagation();},100);}else{var _f="\t";var _g="";if(_c=="nexacro"||_c=="IE"){_g=_d.split("\r\n");if(_h<1){_b.stopPropagation();return;}}else{_g=_d.split(/[\n\f\r]/);}var _h=_g.length-1;_a.set_enableevent(false);_a.set_enableredraw(false);var _i=_a.binddataset;var _j=_a.getBindDataset();_j.set_enableevent(false);var _k=_a.getCellCount("body");var _l=_j.getRowCount();var _m=nexacro.toNumber(_a.selectstartrow);if(_m== -9){return;}var _n=nexacro.toNumber(_a.selectendrow);if(_n== -9){return;}var _o=0;var _p=0;if(_a.selecttype=="row"||_a.selecttype=="multirow"){_o=0;_p=_a.getCellCount("body")-1;}else{_o=nexacro.toNumber(_a.selectstartcol);_p=nexacro.toNumber(_a.selectendcol);}var _q=_m;var _r=_o;var _s=0;var _t={};for(var _ab=0;_ab<_h;_ab++ ){if(_l<=_q){_j.addRow();}var _u=_g[_ab].split(_f);var _v=_r+_u.length;if(_v>_k){_v=_k;}if(_s<_v){_s=_v;}var _w=0;for(var _ac=_r;_ac<_v;_ac++ ){var _x=_a.getCellProperty("body",_ac,"text");var _y;if(this.gfnIsNull(_x)){_y=_a.getCellProperty("body",_ac,"text");}else{_y=_a.getCellProperty("body",_ac,"text").substr(5);}var _z=_u[_w];if(!this.gfnIsNull(_z)){_j.setColumn(_q,_y,_z);}_w++ ;}_q++ ;}_j.rowposition=_q;_n=_n+_h-1;_p=_s-1;system.clearClipboard();_a.set_enableredraw(true);_a.set_enableevent(true);_j.set_enableevent(true);_a.selectArea(_m,_o,_n,_p);var _aa={"startrow":_m,"startcol":_o,"endrow":_n,"endcol":_p};_b.stopPropagation();}};pForm._gfnGridCopyEventForChrome=function(_a,_b){var _c=nexacro.toNumber(_a.selectstartrow);if(_c== -9){return;}var _d=nexacro.toNumber(_a.selectendrow);if(_d== -9){return;}var _e=0;var _f=0;if(_a.selecttype=="row"||_a.selecttype=="multirow"){_e=0;_f=_a.getCellCount("body")-1;}else{_e=nexacro.toNumber(_a.selectstartcol);_f=nexacro.toNumber(_a.selectendcol);}var _g="\t";var _h="";for(var _l=_c;_l<=_d;_l++ ){for(var _m=_e;_m<=_f;_m++ ){var _i=_a.getCellValue(_l,_m);if(!this.gfnIsNull(_i)){if(_m<_f){_h+=_a.getCellValue(_l,_m)+_g;}else{_h+=_a.getCellValue(_l,_m);}}}if(_l<_a.selectendrow){_h+="\r\n";}}_h+="\r\n";var _j=this._createTextarea(_h);this.tragetGrid=_a;this.tragetGrid["ta"]=_j;var _k={"startrow":_c,"startcol":_e,"endrow":_d,"endcol":_f};_b.stopPropagation();};pForm._createTextarea=function(_a){var _b=document.createElement('textarea');_b.id="textAreabyCopyAndPaste";_b.style.position='absolute';_b.style.left='-1000px';_b.style.top=document.body.scrollTop+'px';_b.value=_a;document.body.appendChild(_b);_b.select();document.execCommand("copy");return _b;};pForm.G_GRID_PAGESIZE="records";pForm.G_GRID_STARTROW="recordsOffset";pForm.gfnsetGridAppend=function(_a,_b,_c,_d,_e,_f){_a.appendPagesize=_d;_a.appendDataset=_b;_a.appendSearchfunction=_c;_a.appendGridcount=_e;_b.appendPagesize=_d;_b.appendDataset=_a.getBindDataset();_b.appendGrid=_a;if(_e){_a.appendGridcount=_e;}if(_f){_a.nextBtn=_f;_f.set_enable(false);_f.appendGrid=_a;_f.addEventHandler("onclick",this.gfnGridAppendNextBtn,this);}_b.addColumn(this.G_GRID_PAGESIZE,"STRING");_b.addColumn(this.G_GRID_STARTROW,"STRING");if(_b.getRowCount()==0){_b.addRow();}_b.setColumn(0,this.G_GRID_STARTROW,0);_b.setColumn(0,this.G_GRID_PAGESIZE,parseInt(_d));_a.addEventHandler("onvscroll",this.gfnGridAppend,this);};pForm.gfnGridAppend=function(_a,_b){if(_b.pos==_a.vscrollbar.max){_a.removeEventHandler("onvscroll",this.gfnGridAppend,this);var _c=parseInt(_a.appendDataset.getColumn(0,this.G_GRID_STARTROW))+parseInt(_a.appendPagesize);var _d=parseInt(_c)+parseInt(_a.appendPagesize);_a.appendDataset.setColumn(0,this.G_GRID_STARTROW,_c);this.lookupFunc(_a.appendSearchfunction).call("functionCall");}};pForm.gfnGridAppendNextBtn=function(_a,_b){var _c=_a.appendGrid;_c.removeEventHandler("onvscroll",this.gfnGridAppend,this);var _d=parseInt(_c.appendDataset.getColumn(0,this.G_GRID_STARTROW))+parseInt(_c.appendPagesize);var _e=parseInt(_d)+parseInt(_c.appendPagesize);_c.appendDataset.setColumn(0,this.G_GRID_STARTROW,_d);this.lookupFunc(_c.appendSearchfunction).call("functionCall");};pForm.gfnAppendGridData=function(_a,_b){var _c=_a.getBindDataset();var _d=false;if(_b.getRowCount()>=_a.appendPagesize){_b.deleteRow(_a.appendPagesize);_d=false;}else{_d=true;}_a.set_enableredraw(false);_c.appendData(_b,true);_a.set_enableevent(false);if(this.gfnIsNull(_c.keystring)==false){_c.set_keystring(_c.keystring);}_a.set_enableevent(true);_a.set_enableredraw(true);if(!_d){_a.addEventHandler("onvscroll",this.gfnGridAppend,this);}else{_a.removeEventHandler("onvscroll",this.gfnGridAppend,this);}_b.clearData();if(_a.nextBtn){if(!_d){_a.nextBtn.set_enable(true);}else{_a.nextBtn.set_enable(false);}}if(_a.appendGridcount){_a.appendGridcount.set_text("총 "+parseFloat(_c.getRowCount())+" 건");if(!_d){_a.appendGridcount.set_enable(true);}else{_a.appendGridcount.set_enable(false);}}};pForm.gfnResetGridAppend=function(_a,_b){var _c=_a.getBindDataset();_c.clearData();_a.removeEventHandler("onvscroll",this.gfnGridAppend,this);_a.appendDataset.setColumn(0,this.G_GRID_STARTROW,0);};
var pForm=nexacro.Form.prototype;pForm.gfnExcelExport=function(_a,_b,_c){this.setWaitCursor(true);var _d=_a;var _e=/[?*:\/\[\]]/g;_c=_c.replace(_e,"");_b=_b.replace(_e,"");_c=this.gfnIsNull(_c)?this.gfnGetArgument("menuNm")+"_"+this.gfnGetDate():_c;_b=this.gfnIsNull(_b)?"sheet1":_b;if(String(_b).length>30){_b="sheet1";}var _f="SvcUrl::XExportImport.do";this.objExport=null;this.objExport=new ExcelExportObject();this.objExport.objgrid=_d;this.objExport.set_exporturl(_f);this.objExport.addExportItem(nexacro.ExportItemTypes.GRID,_d,_b+"!A1","allband","allrecord",null,null,"image");this.objExport.set_exportfilename(_c);this.objExport.set_exporteventtype("itemrecord");this.objExport.set_exportuitype("none");this.objExport.set_exporttype(288);this.objExport.set_exportmessageprocess("");this.objExport.set_exportfilepassword("1234");this.objExport.addEventHandler("onsuccess",this.gfnExportOnsuccess,this);this.objExport.addEventHandler("onerror",this.gfnExportOnerror,this);var _g=this.objExport.exportData();};pForm.gfnExportOnsuccess=function(_a,_b){this.setWaitCursor(false);};pForm.gfnExportOnerror=function(_a,_b){this.alert("Excel Export Error!!");this.setWaitCursor(false);};pForm.gfnExcelImportAll=function(_a,_b,_c,_d,_e,_f,_g){this.setWaitCursor(true);if(this.gfnIsNull(_b)){_b="sheet1";}if(this.gfnIsNull(_d)){_d="A2";}if(this.gfnIsNull(_c)){return false;}var _h="SvcUrl::XExportImport.do";var _i;_i=new nexacro.ExcelImportObject(_a+"_ExcelImport",this);_i.set_importurl(_h);_i.set_importtype(nexacro.ImportTypes.EXCEL);if(!this.gfnIsNull(_e)){_i.callback=_e;_i.importid=_f;_i.form=_g;}_i.addEventHandler("onsuccess",this.gfnImportAllOnsuccess,this);_i.addEventHandler("onerror",this.gfnImportAllOnerror,this);var _j="[Command=getsheetdata;Output=outds;Head="+_b+"!"+_c+";Body="+_b+"!"+_d+"]";var _k="["+_a+"=outds]";_i.importData("",_j,_k);_i=null;};pForm.gfnImportAllOnsuccess=function(_a,_b){this.setWaitCursor(false);var _c=_a.callback;var _d=_a.importid;if(!this.gfnIsNull(_c)){if(this[_c]){this.lookupFunc(_c).call(_d);}}};pForm.gfnExcelImport=function(_a,_b,_c,_d,_e,_f){this.setWaitCursor(true);if(this.gfnIsNull(_b)){_b="sheet1";}if(this.gfnIsNull(_c)){_c="A2";}var _g="SvcUrl::XExportImport.do";var _h;_h=new nexacro.ExcelImportObject(_a+"_ExcelImport",this);_h.set_importurl(_g);_h.set_importtype(nexacro.ImportTypes.EXCEL);_h.outds=_a;if(!this.gfnIsNull(_d)){_h.callback=_d;_h.importid=_e;_h.form=_f;}var _i=_a+"_outds";if(this.isValidObject(_i)){this.removeChild(_i);}var _j=new Dataset();_j.name=_i;this.addChild(_j.name,_j);_h.addEventHandler("onsuccess",this.gfnImportOnsuccess,this);_h.addEventHandler("onerror",this.gfnImportAllOnerror,this);var _k="[command=getsheetdata;output=outDs;body="+_b+"!"+_c+";]";var _l="["+_i+"=outDs]";_h.importData("",_k,_l);_h=null;this.setWaitCursor(false);};pForm.gfnImportOnsuccess=function(_a,_b){this.setWaitCursor(false);var _c=this.objects[_a.outds+"_outds"];var _d=this.objects[_a.outds];var _e=_a.callback;var _f=_a.importid;var _g=_a.form;var _h;for(var _i=0;_i<_d.getColCount();_i++ ){_h="Column"+_i;if(_h!=_d.getColID(_i)){_c.updateColID(_h,_d.getColID(_i));}}_d.clearData();_d.copyData(_c);if(!this.gfnIsNull(_e)){if(this[_e]){this.lookupFunc(_e).call(_f);}}};pForm.gfnImportAllOnerror=function(_a,_b){this.setWaitCursor(false);this.alert(_b.errormsg);};
var pForm=nexacro.Form.prototype;pForm.gfnGetCompId=function(_a){var _b=_a.name;var _c=_a.parent;while(true){if(_c instanceof nexacro.ChildFrame){break;}else{_b=_c.name+"."+_b;}_c=_c.parent;}return _b;};pForm.gfnCalMMOndropdown=function(_a){var _b=this.gfnGetCompId(_a);if(this.gfnIsNull(this.components[_b])){var _c=new PopupDiv();_c.init(_b,_a.getOffsetLeft(),_a.getOffsetBottom(),180,200,null,null);this.addChild(_b,_c);_c.show();_c.set_url("Cmm::CmmCalMMPdv.xfdl");_c.calObj=_a;_c.calVal=_a.value;}else{var _c=this.components[_b];var _d=_a.value;_c.calVal=_a.value;_c.form.staYYYY.set_text(_d.substr(0,4));}var _e=0;if(this.getOffsetWidth()<(_a.getOffsetRight()+180)){_e=_a.getOffsetWidth()-180;}else{_e=0;}var _f=0;if(this.getOffsetHeight()<(_a.getOffsetBottom()+200)){_f= -200;}else{_f=_a.getOffsetHeight();}_c.trackPopupByComponent(_a,_e,_f);return false;};pForm.gfnSetAccordion=function(_a,_b){var _c=new Array();for(var _g in _a){var _d=eval("this."+_g);if(!this.gfnIsNull(_a[_g])){if(_a[_g].valueOf()=="[object Div]"){_d.accordionbody=_a[_g];}else{_d.accordionbody=eval("this."+_a[_g]);}_d.accordionbody.orgheight=_d.accordionbody.height;}_c.push(_d);}var _e;for(var _h=0;_h<_c.length;_h++ ){if(this.gfnIsNull(_c[_h].accordionbody)){_c[_h].accordionopenstatus=true;}var _f=_c[_h].form.components;for(var _i=0;_i<_f.length;_i++ ){if(_f[_i].valueOf()=="[object Button]"&&_f[_i].cssclass.indexOf("btn_WF_Acc")!= -1){_f[_i].addEventHandler("onclick",this._gfnHandleAccordionButtonClick,this);_f[_i].accordionlist=_c;_f[_i].accordionhead=_c[_h];if(this.gfnIsNull(_e)){_e=_f[_i];}if(this.gfnIsBoolean(_b)){_f[_i].accordionopenstatus=_b;if(_b==true){_f[_i].set_cssclass("btn_WF_AccClose");_f[_i].set_text("CLOSE");}else{_f[_i].set_cssclass("btn_WF_AccOpen");_f[_i].set_text("OPEN");}_c[_h].accordionopenstatus=_b;}else{if(_b==_h){_f[_i].accordionopenstatus=true;_f[_i].set_cssclass("btn_WF_AccClose");_f[_i].set_text("CLOSE");_c[_h].accordionopenstatus=true;}else{_f[_i].accordionopenstatus=false;_f[_i].set_cssclass("btn_WF_AccOpen");_f[_i].set_text("OPEN");_c[_h].accordionopenstatus=false;}}break;}}}this._gfnRedrawAccordion(_e);};pForm._gfnHandleAccordionButtonClick=function(_a,_b){if(_a.accordionopenstatus==true){_a.accordionopenstatus=false;_a.set_cssclass("btn_WF_AccOpen");_a.set_text("OPEN");_a.accordionhead.accordionopenstatus=false;}else{_a.accordionopenstatus=true;_a.set_cssclass("btn_WF_AccClose");_a.set_text("CLOSE");_a.accordionhead.accordionopenstatus=true;}this._gfnRedrawAccordion(_a);};pForm._gfnRedrawAccordion=function(_a){var _b=0;var _c=_a.accordionlist;var _d=_c[0].top;for(var _e=0;_e<_c.length;_e++ ){_c[_e].set_top(_d);if(_c[_e].accordionopenstatus==true){if(!this.gfnIsNull(_c[_e].accordionbody)){_c[_e].accordionbody.set_top(parseInt(_d)+parseInt(_c[_e].height));_c[_e].accordionbody.set_height(_c[_e].accordionbody.orgheight);_c[_e].accordionbody.set_visible(true);_c[_e].parent.resetScroll();_d=parseInt(_d)+parseInt(_c[_e].height)+parseInt(_c[_e].accordionbody.height)+parseInt(_b);}else{_d=parseInt(_d)+parseInt(_c[_e].height)+parseInt(_b);}}else{if(!this.gfnIsNull(_c[_e].accordionbody)){_c[_e].accordionbody.set_top(parseInt(_d)+parseInt(_c[_e].height));_c[_e].accordionbody.set_height(0);_c[_e].accordionbody.set_visible(false);_c[_e].parent.resetScroll();_d=parseInt(_d)+parseInt(_c[_e].height)+parseInt(_b);}else{_d=parseInt(_d)+parseInt(_c[_e].height)+parseInt(_b);}}}};pForm._gfnSetEditMsClear=function(_a){var _b=_a.parent;var _c=_a.name+"_"+"X";var _d=parseInt(_a.getOffsetWidth());var _e=parseInt(_a.getOffsetHeight());var _f=parseInt(_a.getOffsetTop());var _g=parseInt(_a.getOffsetLeft());var _h=_e-3;var _i=_e;var _j=new Button();_j.init(_c,_g+(_d-_h),_f,_h,_i,null,null);_j.set_left(_a.name+":"+(_h*  -1));_j.set_visible(false);_j.set_icon("URL('theme://btn_del.png')");_j.set_iconPosition("left");_j.set_background("transparent");_j.set_border("0px none");_j.set_tabstop(false);_b.addChild(_c,_j);_j.show();_j.addEventHandler("onclick",function(_k,_l){_a.set_value(null);_a.setCaretPos(0);_a.setFocus();_j.set_visible(false);},this);_j.addEventHandler("onsetfocus",function(_k,_l){_a.setFocus();},this);_a.addEventHandler("oneditclick",function(_k,_l){if(!this.gfnIsNull(_a.value)){_j.set_visible(true);}else{_j.set_visible(false);}},this);_a.addEventHandler("onsetfocus",function(_k,_l){if(!this.gfnIsNull(_a.value)){_j.set_visible(true);}},this);_a.addEventHandler("onkillfocus",function(_k,_l){if(_b.getFocus().name!=_j.name){_j.set_visible(false);}},this);_a.addEventHandler("oninput",function(_k,_l){if(!this.gfnIsNull(_a.value)){_j.set_visible(true);}else{_j.set_visible(false);}},this);};pForm._gfnSetEditMsClearRemove=function(_a){var _b=_a.parent;var _c=_a.name+"_"+"X";var _d=_b.lookup(_c);_b.removeChild(_c);_d.destroy();_d=null;};pForm.gfnSetEditMsClear=function(_a,_b){if(this.gfnIsNull(_a._ms_clear)||!_a._ms_clear){_a._ms_clear=true;}if(!this.gfnIsNull(_b)){_a._ms_clear=_b;}if(_a._ms_clear){pForm._gfnSetEditMsClear(_a);}else{pForm._gfnSetEditMsClearRemove(_a);}};pForm.gfnSetEditMsClearAll=function(_a,_b){var _c=_a.components;var _d=_c.length;for(var _f=0;_f<_d;_f++ ){if(_c[_f] instanceof nexacro.Div){this.gfnSetEditMsClearAll(_c[_f].form,_b);}else if(_c[_f] instanceof nexacro.Tab){this.gfnSetEditMsClearAll(_c[_f].form,_b);}else{if(_c[_f] instanceof nexacro.Edit){var _e=_c[_f];if(this.gfnIsNull(_e._ms_clear)||!_e._ms_clear){_e._ms_clear=true;}if(!this.gfnIsNull(_b)){_e._ms_clear=_b;}if(_e._ms_clear){pForm._gfnSetEditMsClear(_e);}else{pForm._gfnSetEditMsClearRemove(_e);}}}}};pForm.gfnGetDLLPath=function(_a){var _b="";var _c=nexacro.getProjectPath();if(_c.indexOf("file://")!= -1){_c=_c.replace("file://","");_b=nexacro.replaceAll(_c.substring(0,_c.lastIndexOf("/")),"/","\\")+"\\dll\\"+_a;}else{_b=system.convertRealPath("%USERAPP%\\Component\\"+_a);}trace(_b);return _b;};pForm.gfnOpenDLL=function(_a){var _b=this.gfnGetApplication();if(this.gfnIsNull(_b[_a])){_b[_a]={};}else{return _b[_a];}var _c=this.gfnGetDLLPath(_a);_b[_a]=nexacro._addExtensionModule(_c);return _b[_a];};pForm.gfnCloseDLL=function(_a){var _b=this.gfnGetDLLPath(_a);nexacro._clearExtensionModule(_b);var _c=this.gfnGetApplication();_c[_a]=null;};pForm.gfnGetExtCommon=function(){var _a="";var _b=system.navigatorfullname;if(_b=="Nexacro N Engine (x86)"){_a="ExtCommonV_N_32.dll";}else{_a="ExtCommonV_N_64.dll";}trace("==================== gfnGetExtCommon strFile : "+_a);return this.gfnOpenDLL(_a);};pForm.gfnCloseExtCommon=function(){var _a="";var _b=system.navigatorfullname;if(_b=="nexacro platform 17 Engine (Windows XP)"){_a="ExtCommonV17_XP.dll";}else if(_b=="nexacro platform 17 Engine (x86)"){_a="ExtCommonV17_32.dll";}else{_a="ExtCommonV17_64.dll";}this.gfnCloseDLL(_a);};
if(!nexacro.Grid.prototype.reCalcPivot){if(nexacro._Browser=="Runtime"){var _pForm=nexacro.Form.prototype;_pForm.orgReload=_pForm.reload;_pForm.reload=function(){if(this._usepivot&&this.onbeforeclose&&this.onbeforeclose._has_handlers){this._usepivot=false;this.onbeforeclose._fireEvent(this,"");}this.orgReload();};delete _pForm;}var _pGridCell=nexacro._GridCellControl.prototype;_pGridCell._originalGetRemoveLine=_pGridCell._getRemoveLine;_pGridCell._getRemoveLine=function(){var _a=this._grid;var _b=_a._binddataset;if(_b&&_a.pivotGroupSubSum===true&&_a.pivotGroupSubSumLineExpr===true){if(_a._groupArr&&_a._groupArr.length>0){var _c=_b._viewRecords;var _d=this._cellidx;var _e=this._rowidx;var _f=_a._groupArr.length;if(_f>=_d){if(_c&&_c[this._rowidx]){var _g=_c[this._rowidx]._level;if(_g>0){_g=_f-_g;if(_d==_f){return [true,true,false,false];}else{if(_g==_d){return [true,true,true,false];}else{if(_g<_d){return [true,true,true,false];}}}}}}else{if(_a.pivotSubSumColorUse===true&&_c&&_c[this._rowidx]){var _g=_c[this._rowidx]._level;if(_g>0){this.set_background(_a.pivotSubSumColor[_g-1]);}}}}}return this._originalGetRemoveLine();};delete _pGridCell;if(!nexacro.Dataset.prototype.setColumnDataOnly){nexacro.Dataset.prototype.setColumnDataOnly=function(_a,_b,_c){var _d,_e;_d=this.colinfos[_b];if(!_d){return false;}_e=_d._index;var _f=this._rawRecords[_a];if(_f==null){return false;}var _g=_d._fromVal(_c);_f[_e]=_g;return true;};nexacro.Dataset.prototype.getColumn2=function(_a,_b){var _c=this.colinfos[_b];if(!_c){return;}var _d=this._viewRecords[_a];if(_d==null){return undefined;}return _d[_c._index];};nexacro.Dataset.prototype.pivotSrcSort=function(_a){var _b=true;_a=_a.toString();this.keystring=_a;var _c=false;if(this.keystring==""||this.keystring=="S:"||this.keystring=="G:"){_c=true;}var _d,_e,_f;if(this.keystring&&!_c){_d=this._viewRecords;_e=this.rowposition;_f=_d[_e];this._clearKeyCols();if(!this.loadstatus&&this._rawRecords.length>0){this.pivotResetSortGroup();}}else{this._deleteAllGroupData();_d=this._viewRecords;_e=this.rowposition;_f=_d[_e];this._clearKeyCols();if(!this.loadstatus&&this._rawRecords.length>0){this._viewRecords=this._rawRecords;this._reFilter();}}};nexacro.Dataset.prototype.pivotResetSortGroup=function(){var _a=this.rowposition;if(this.rowposition== -1){var _a=0;}var _b=this._viewRecords[_a];if(this._parseKeyCols()>0&&this._rawRecords.length>0){if(this._rawRecords!=this._viewRecords){if(this._viewRecords.length==0){_b=null;return false;}}else{this._viewRecords=null;this._viewRecords=this._rawRecords.slice(0,this._rawRecords.length);}var _c=this._viewRecords;if(_c.length>0){if(this._viewRecords==this._rawRecords){_c=this._viewRecords=this._rawRecords.slice(0,this._rawRecords.length);}var _d=this._keycols;var _e=_d.length;var _f=this._getLocale();var _g=this.colinfos;var _h=(nexacro._BrowserLang.indexOf(_f)>=0);var _i=[];for(var _l=_e-1;_l>=0;_l-- ){var _j=_d[_l];_i[_l]=_g[_j.colidx].type.toLowerCase();}var _k=this.pivotCreateSortFunc(_d,_e,_f,_h,_i);_c.sort(_k);}}_b=null;};nexacro.Dataset.prototype.pivotCreateSortFunc=function(_a,_b,_c,_d,_e){return function(_f,_g){for(var _m=_b-1;_m>=0;_m-- ){var _h=_a[_m];var _i=_f[_h.colidx];var _j=_g[_h.colidx];var _k=0;var _l=_e[_m];if(_l!="bigdecimal"){if(_i!=null){var _l=_e[_m];if(_l=="datetime"||_l=="date"||_l=="time"){_i=_i.toString();_j=_j.toString();}if(_i!=_j){if(_j!=null){if(_l=="string"){if(_d){_k=(_i>_j?1: -1);}else{_k=_i.localeCompare(_j,_c);}}else{if((_j instanceof nexacro.Decimal)){_k=((_i.hi>_j.hi||(_i.hi>=_j.hi&&_i.lo>_j.lo))?1: -1);}else{_k=(_i>_j?1: -1);}}}else{_k=1;}}else{_k=0;}}else if(_i!=_j){_k= -1;}else{_k=0;}}else{if(_i==null){if(_j!=null){_k= -1;}}else{if(_j!=null){_k=(_i.hi==_j.hi&&_i.lo==_j.lo)?0:((_i.hi>_j.hi||(_i.hi>=_j.hi&&_i.lo>_j.lo))?1: -1);}else{_k=1;}}}if(_k!=0){return (_h.descending)? -_k:_k;}}return (_f._rawidx>_g._rawidx)?1: -1;};};nexacro.Dataset.prototype.getSum2=function(_a,_b){var _c=this._viewRecords;var _d=_c.length;var _e=[];var _f=[];var _g=[];var _h=[];var _i=[];var _j=[];var _k;for(var _p=0;_p<_a.length;_p++ ){_e[_p]=0;_f[_p]=0;_k=this.colinfos[_a[_p]];_g[_p]=_k._index;_i[_p]=_k.ntype;if(_b=="AVG"){_k=this.colinfos[_a[_p]+"__CNT"];_h[_p]=_k._index;_j[_p]=_k.ntype;}}var _l;var _m=0;var _n=0;var _o=0;function _getSumDecimal_loop(_q){if(_n<_d){_l=_c[_n];if(_l._rtype==16||_l._level!=0){_n++ ;return false;}for(var _r=0;_r<_g.length;_r++ ){_o=_l[_g[_r]];if(_o instanceof nexacro.Decimal){if((_o!=null)&&(_o!="")&&(_o!=undefined)){_e[_r]+=_o.valueOf();}}else{if(!nexacro._isNumber(_o)){if(!_o){_o=0;}else{_o=parseInt(_o,10);}}_e[_r]+=( +_o);}if(_b=="AVG"){_o=_l[_h[_r]];if(_o instanceof nexacro.Decimal){if((_o!=null)&&(_o!="")&&(_o!=undefined)){_f[_r]+=_o.valueOf();}}else{if(!nexacro._isNumber(_o)){if(!_o){_o=0;}else{_o=parseInt(_o,10);}}_f[_r]+=( +_o);}}}_n++ ;return false;}return true;}while(true){if(_getSumDecimal_loop(this)){break;}if(_getSumDecimal_loop(this)){break;}if(_getSumDecimal_loop(this)){break;}if(_getSumDecimal_loop(this)){break;}if(_getSumDecimal_loop(this)){break;}if(_getSumDecimal_loop(this)){break;}if(_getSumDecimal_loop(this)){break;}if(_getSumDecimal_loop(this)){break;}if(_getSumDecimal_loop(this)){break;}if(_getSumDecimal_loop(this)){break;}if(_getSumDecimal_loop(this)){break;}if(_getSumDecimal_loop(this)){break;}if(_getSumDecimal_loop(this)){break;}if(_getSumDecimal_loop(this)){break;}if(_getSumDecimal_loop(this)){break;}if(_getSumDecimal_loop(this)){break;}if(_getSumDecimal_loop(this)){break;}if(_getSumDecimal_loop(this)){break;}if(_getSumDecimal_loop(this)){break;}if(_getSumDecimal_loop(this)){break;}}for(var _p=0;_p<_e.length;_p++ ){if(!_e[_p]){_e[_p]=0;}if(_b=="AVG"){if(!_f[_p]){_f[_p]=0;}}}return {sum:_e,cnt:_f};};}nexacro.Grid.prototype.pivotConvertData=function(_a){if(typeof (_a)=="string"){return _a;}if(_a instanceof nexacro.Decimal){_a=_a.valueOf();}else if(_a instanceof nexacro.Date){if(_a._timecheck){_a=_a.yyyymmddhhmmss();}else{_a=_a.yyyymmdd();}}return _a;};nexacro.Grid.prototype.createPivotProgress=function(_a,_b,_c){var _d=this._refform;var _e=_d.components["divPivotProgress"];if(!_e){_e=new Div("divPivotProgress","0","0","160","42");_e.set_background("white");_e.set_border("2px solid #808080");_e.form.set_scrolltype("none");_e.set_visible(false);_d.addChild(_e.id,_e);_e.show();var _f=new ProgressBar("ProgressBar00","3","4","148","14");_e.addChild(_f.id,_f);_f.show();_f=new Static("Static00","5","21","146","14");_f.set_text("Static00");_f.set_textAlign("center");_f.set_verticalAlign("middle");_f.set_font("8pt Verdana");_e.addChild(_f.id,_f);_f.show();}var _g=this.getOffsetLeft()+(this.getOffsetWidth()/2)-80;var _h=this.getOffsetTop()+(this.getOffsetHeight()/2)-40;_e.set_left(_g);_e.set_top(_h);_e.set_visible(_a);if(_a){_e.bringToFront();_e.form.ProgressBar00.set_pos(_b);_e.form.Static00.set_text(_c);}};nexacro.Grid.prototype.pivotDefaultUI=function(){if(!this.pivotShowUIConfig){this.pivotShowUIConfig={"showuiButtonText":"피봇설정","showuiButtonColor":"","showuiButtonFont":"","divbackground":"white","divborder":"2px solid #808080","gridFont":"9pt Verdana","allFiledText":"전체 컬럼","rowFiledText":"행","columnFiledText":"열","valueFiledText":"값","descRightTotalText":"우축 고정 합계","descSummaryText":"하위 합계","descSubSumText":"소계","textFont":"9pt Verdana","textColor":"","checkboxFont":"9pt Verdana","checkboxColor":"","applyButtonText":"적용","closeButtonText":"닫기","buttonFont":"9pt Verdana","buttonColor":"","radioValue":"1","radioSumText":"합계","radioAvgText":"평균","radioFont":"9pt Verdana","radioColor":""};}};nexacro.Grid.prototype.reCalcPivot=function(_a,_b,_c){var _d=new Date();if(!this.pivotSubSumColor){this.pivotSubSumColor=["#fbf0a1","#c4f8a4","#adefe0","#a5f7de","#a3dcf9","#c4b3e9"];}if(!this.pivotProcessCnt){this.pivotProcessCnt=4;}if(_b.rowcount<30000){this.pivotProcessBaseCnt=12342;}else{this.pivotProcessBaseCnt=nexacro.round(_b.rowcount/this.pivotProcessCnt);}if(!this.pivotSummaryRowHeight){this.pivotSummaryRowHeight=this._rowheight;}if(!this.pivotHeadRowHeight){this.pivotHeadRowHeight=this._rowheight;}if(!this.pivotBodyRowHeight){this.pivotBodyRowHeight=this._rowheight;}this.pivotLineColor="";if(!this.pivotFactorType){this.pivotFactorType="SUM";}this.pivotDefaultUI();this.set_binddataset("");if(!this.pivotMaxCellCount){this.pivotMaxCellCount=1500;}if(this.pivotFactorOnlyNumber===undefined||this.pivotFactorOnlyNumber===null){this.pivotFactorOnlyNumber=true;}if(this.pivotFactorOnlyNumberOrg===undefined||this.pivotFactorOnlyNumberOrg===null){this.pivotFactorOnlyNumberOrg=true;}if(this.pivotFactorOnlyNumber==false&&this.pivotFactorType=="AVG"){trace("평균인 경우 pivotFactorOnlyNumber는 true이어야 합니다."+this.pivotFactorOnlyNumberOrg);this.set_pivotFactorOnlyNumber(true);this.set_pivotFactorType("SUM");return;}if(_c){this.formatInfo=null;this.pivotInfoDataset=null;this.pivotSourceDataset=null;}if(this.pivotGroupSuppress===undefined){this.pivotGroupSuppress=true;}if(!this.formatInfo){this.formatInfo={grouplist:[],groupcolidxlist:[],pivotlist:[],pivotcolidxlist:[],factorlist:[],factorcolidxlist:[],infods:null,groupds:null,pivotds:null,factords:null};}if(!this.pivotInfoDataset||!this.pivotSourceDataset||this.pivotInfoDataset!=_a||this.pivotSourceDataset!=_b){this.pivotInfoDataset=_a;this.pivotSourceDataset=_b;_a.set_enableevent(false);if(!this.pivotCheckValidate()){_a.set_enableevent(true);this.set_binddataset("");this.set_formats('<Formats><Format id="default"></Format></Formats>');return;}}this.pivotSourceDataset.set_updatecontrol(false);this.pivotSourceDataset.set_enableevent(false);var _e=_b._refform;var _f=_b.id+"_DynamicPivotds";var _g=_e.objects[_f];if(!_g){_g=new Dataset;_e.addChild(_f,_g);_g.set_id(_f);_g.set_name(_f);}_g.clear();_g.set_updatecontrol(false);_g.set_enableevent(false);this.pivotDataset=_g;this.arrPivotColList=[];this.arrFactorColList=[];if(this.pivotUI){var _e=this._refform;var _h="comPivotBtn___"+this.id;var _i=_e.components[_h];var _j=this.getOffsetLeft()+this.getOffsetWidth()-80;var _k=this.getOffsetTop()-22;if(!_i){_i=new Button();_i.init(_h,_j,_k,80,20);_e.addChild(_h,_i);_i.set_text(this.pivotShowUIConfig.showuiButtonText);_i.set_font(this.pivotShowUIConfig.showuiButtonFont);_i.set_color(this.pivotShowUIConfig.showuiButtonColor);_i.show();var _l=this;_i.addEventHandler('onclick',function(_o,_p){_l.formatInfo.infods.applyChange();_l.formatInfo.groupds.applyChange();_l.formatInfo.pivotds.applyChange();_l.formatInfo.factords.applyChange();_l.showPivotUI();},this);this.addEventHandler("onsize",function(_o,_p){var _j=_o.getOffsetLeft()+_o.getOffsetWidth()-80;var _k=_o.getOffsetTop()-22;_i.set_left(_j);_i.set_top(_k);},this);}_i.set_left(_j);_i.set_top(_k);}_e=this._refform;if(!_e._pivotgridarr){_e._pivotgridarr=[];}var _m= -1;for(var _o=0;_o<_e._pivotgridarr.length;_o++ ){if(_e._pivotgridarr[_o]==this.id){_m=_o;break;}}if(_m<0){_e._pivotgridarr[_e._pivotgridarr.length]=this.id;}if(!_e._usepivot){_e.addEventHandler('onbeforeclose',function(_p,_q){var _r=_p._pivotgridarr;for(var _o=0;_o<_r.length;_o++ ){if(!_r[_o]){continue;}var _s=_p.components[_r[_o]];if(_s){_s.pivotsumsubcache=null;_s.formatInfo.grouplist=null;_s.formatInfo.groupcolidxlist=null;_s.formatInfo.pivotlist=null;_s.formatInfo.pivotcolidxlist=null;_s.formatInfo.factorlist=null;_s.formatInfo.factorcolidxlist=null;_p.removeChild(_s.formatInfo.infods.id);_s.formatInfo.infods.destroy();_s.formatInfo.infods=null;_p.removeChild(_s.formatInfo.groupds.id);_s.formatInfo.groupds.destroy();_s.formatInfo.groupds=null;_p.removeChild(_s.formatInfo.pivotds.id);_s.formatInfo.pivotds.destroy();_s.formatInfo.pivotds=null;_p.removeChild(_s.formatInfo.factords.id);_s.formatInfo.factords.destroy();_s.formatInfo.factords=null;_s.formatInfo=null;_s.pivotDataset.clear();_p.removeChild(_s.pivotDataset.id);_s.pivotDataset.destroy();_s.pivotDataset=null;_s.pivotSourceDataset=null;_s.pivotInfoDataset=null;_s.pivotShowUIConfig=null;_s.pivotGridMsg=null;_s.arrPivotColList=null;_s.arrFactorColList=null;_s._groupArr=null;_s.pivotSubSumColor=null;}var _h="comPivotBtn___"+_s.id;var _t=_p.components[_h];if(_t){_p.removeChild(_t.id);_t.destroy();}_r[_o]=null;}var _u="commonPivotUI";var _v=_p.components[_u];if(_v){try{_p.removeChild(_v.id);_v.destroy();_v=null;}catch(_q){}}var _w="stcommonPivot_dragText";var _x=_p.components[_w];if(_x){try{_p.removeChild(_x.id);_x.destroy();_x=null;}catch(_q){}}if(_p.pivottimer){_p.pivottimer=null;}_p._usepivot=null;},_e);_e._usepivot=true;this.pivotGridMsg={"M001":"Pivot Column은 3개 이하여야 합니다.","M002":"의 선택된 Column이 없습니다.","M003":"그리드 정보 저장에 실패하였습니다..","M004":"Factor 컬럼이 "+this.pivotMaxCellCount+"개를 초과하여 처리할 수 없습니다.","M005":this.pivotShowUIConfig.radioAvgText+"일 경우 "+this.pivotShowUIConfig.valueFiledText+"은 숫자형만 가능합니다.","P001":"그리드 정보 저장 중","P002":"데이터 변환 중","P003":"그리드 포멧생성 중"};}this.createPivotProgress(true,10,this.pivotGridMsg.P001);var _n=this;this._refform.pivottimer=nexacro._OnceCallbackTimer.callonce(this._refform,function(){try{_n.savePivotInfo();}catch(e){if(_n._refform.pivottimer){_n._refform.pivottimer.stop();}_n.pivotProc1(false);}},20);};nexacro.Grid.prototype.pivotProc1=function(_a){if(_a==false){this.createPivotProgress(false);this.pivotInfoDataset.set_enableevent(true);this.pivotSourceDataset.set_updatecontrol(true);this.pivotSourceDataset.set_enableevent(true);this.set_binddataset("");return;}this.createPivotProgress(true,30,this.pivotGridMsg.P002);var _b=this;this._refform.pivottimer=nexacro._OnceCallbackTimer.callonce(this._refform,function(){try{_b.processPivot();}catch(e){if(_b._refform.pivottimer){_b._refform.pivottimer.stop();}_b.pivotProc1(false);}},20);};nexacro.Grid.prototype.pivotProc2=function(){this.createPivotProgress(true,80,this.pivotGridMsg.P003);var _a=this;this._refform.pivottimer=nexacro._OnceCallbackTimer.callonce(this._refform,function(){try{_a.setPivotGridFormat();}catch(e){if(_a._refform.pivottimer){_a._refform.pivottimer.stop();}_a.pivotProc1(false);}},20);};nexacro.Grid.prototype.pivotProc3=function(){this.createPivotProgress(true,90,this.pivotGridMsg.P003);var _a=this.pivotDataset;this._groupArr=null;if(this.pivotGroupSubSum){var _b="G:";var _c=[];var _d=this.formatInfo.groupds;for(var _g=0;_g<_d.rowcount-1;_g++ ){var _e=_d.getColumn(_g,"colID");var _f=_d.getColumn(_g,"sort");if(_f===undefined||_f===null||_f==""){_f="+";}if(_f=="ASC"){_f="+";}else if(_f=="ASC"){_f="-";}if(_g>0){_b+=",";}_b+=(_f+""+_e);_c[_c.length]=_e;}if(_c.length>0){this._groupArr=_c;}_a.set_keystring(_b);}this.pivotSourceDataset.set_updatecontrol(true);this.pivotSourceDataset.set_enableevent(true);this.pivotInfoDataset.set_enableevent(true);this.set_enableevent(true);this.set_enableredraw(true);_a.set_updatecontrol(true);_a.set_enableevent(true);_a.set_rowposition(0);this.createPivotProgress(false);this.set_binddataset(_a.id);this.hscrollbar.set_pos(0);this.vscrollbar.set_pos(0);};nexacro.Grid.prototype.resetPivot=function(_a,_b,_c,_d){var _e=new Date();if(_d=="2"){var _f=this.formatInfo.factords;for(var _j=0;_j<_f.rowcount;_j++ ){var _g=this.pivotSourceDataset.colinfos[_f.getColumn(_j,"colID")];if(_g.type.toUpperCase()=="STRING"){alert(this.pivotGridMsg.M005+"\nCheck:"+_f.getColumn(_j,"titleText"));return false;}}this.pivotFactorOnlyNumber=true;this.set_pivotFactorType("AVG");}else{this.pivotFactorOnlyNumber=this.pivotFactorOnlyNumberOrg;this.set_pivotFactorType("SUM");}if(this.formatInfo.pivotds.rowcount>3){alert(this.pivotGridMsg.M001);return false;}if(this.formatInfo.groupds.rowcount==0){alert("[Group]"+this.pivotGridMsg.M002);return false;}if(this.formatInfo.pivotds.rowcount==0){alert("[Pivot]"+this.pivotGridMsg.M002);return false;}if(this.formatInfo.factords.rowcount==0){alert("[Factor]"+this.pivotGridMsg.M002);return false;}this.formatInfo.infods.applyChange();this.formatInfo.groupds.applyChange();this.formatInfo.pivotds.applyChange();this.formatInfo.factords.applyChange();var _h=this.pivotDataset;_h.clear();_h.set_updatecontrol(false);_h.set_enableevent(false);this.pivotSourceDataset.set_updatecontrol(false);this.pivotSourceDataset.set_enableevent(false);if(_a===undefined||_a===null){_a=false;}if(_b===undefined||_b===null){_b=false;}if(_c===undefined||_c===null){_c=false;}this.set_showPivotRightSummary(_a,this.pivotShowRightSummarySize,this.pivotShowRightSummaryText,this.pivotShowRightSummaryAlign,this.pivotShowRightSummaryBandRight);this.set_showPivotSummary(_b,this.pivotShowSummaryText,this.pivotShowSummaryAlign);this.set_pivotSubSum(_c,this.pivotGroupSubSumLineExpr);this.arrPivotColList=this.arrFactorColList=null;this.arrPivotColList=[];this.arrFactorColList=[];this.set_binddataset("");this.set_formats('<Formats><Format id="default"></Format></Formats>');var _i=this;this._refform.pivottimer=nexacro._OnceCallbackTimer.callonce(this._refform,function(){try{_i.savePivotInfo();}catch(e){if(_i._refform.pivottimer){_i._refform.pivottimer.stop();}_i.pivotProc1(false);}},20);return true;};nexacro.Grid.prototype.set_pivotUI=function(_a){this.pivotDefaultUI();if(!_a){_a=false;}this.pivotUI=_a;var _b="ds_SUMAVG_Radiods";var _c=this._refform.objects[_b];if(!_c){_c=new Dataset;this._refform.addChild(_b,_c);_c.set_name(_b);_c.set_enableevent(false);_c.addColumn("code","string",50);_c.addColumn("name","string",50);_c.addRow();_c.setColumn(0,"code","1");_c.setColumn(0,"name",this.pivotShowUIConfig.radioSumText);_c.addRow();_c.setColumn(1,"code","2");_c.setColumn(1,"name",this.pivotShowUIConfig.radioAvgText);}if(_a){var _d=this;var _e=this._refform;var _f="commonPivotUI";var _g=_e.components[_f];if(!_g){_g=new Div(_f,"0","0","317","345");_g.set_text("");_g.set_background(this.pivotShowUIConfig.divbackground);_g.set_border(this.pivotShowUIConfig.divborder);_g.form.set_scrolltype("none");_g.set_visible("false");_e.addChild(_f,_g);_g.show();var _h=new Grid("grdAll","7","17","151","169");_h.set_autofittype("col");_h.set_scrolltype("vertical");_h.set_font(this.pivotShowUIConfig.gridFont);_h._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"162\"/></Columns><Rows><Row size=\"24\"/></Rows><Band id=\"body\"><Cell textAlign=\"left\" text=\"bind:titleText\" tooltiptext=\"expr:dataset.getColumn(currow,&quot;titleText&quot;)\"/></Band></Format></Formats>");_g.addChild(_h.id,_h);_h.show();var _i=function(_h,_m){var _k="stcommonPivot_dragText";var _n=_e.components[_k];if(_n){_n.set_text("");_n._orgtext="";}_g._pivotdragrow=_m.row;_g._pivotdraggrid=_h.id;if(_h.id=="grdAll"){_g._pivotdragds=_d.formatInfo.infods;}else if(_h.id=="grdGroup"){_g._pivotdragds=_d.formatInfo.groupds;}else if(_h.id=="grdPivot"){_g._pivotdragds=_d.formatInfo.pivotds;}else if(_h.id=="grdFactor"){_g._pivotdragds=_d.formatInfo.factords;}return true;};var _j=function(_h,_m){if(_g._pivotdraggrid==_h.id){if(_m.row!=_g._pivotdragrow){var _n=_h.getBindDataset();_n.moveRow(_g._pivotdragrow,_m.row);_g._pivotdragrow="";_g._pivotdraggrid="";_g._pivotdragds="";var _k="stcommonPivot_dragText";var _o=_e.components[_k];if(_o){_o.set_text("");_o._orgtext="";_o.set_visible(false);}}}};_h.addEventHandler('ondrag',_i,_e);_h.addEventHandler('ondrop',_j,_e);_h=new Static("Static00","7","1","118","17");_h.set_text(this.pivotShowUIConfig.allFiledText);_g.addChild(_h.id,_h);_h.set_font(this.pivotShowUIConfig.textFont);_h.set_color(this.pivotShowUIConfig.textColor);_h.show();_h=new Static("Static01","7","189","118","17");_h.set_text(this.pivotShowUIConfig.rowFiledText);_h.set_color(this.pivotShowUIConfig.textColor);_g.addChild(_h.id,_h);_h.set_font("9pt Verdana");_h.show();_h=new Grid("grdGroup","7","207","148","103");_h.set_autofittype("col");_h.set_scrolltype("vertical");_h.set_font(this.pivotShowUIConfig.gridFont);_h._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"157\"/></Columns><Rows><Row size=\"24\"/></Rows><Band id=\"body\"><Cell textAlign=\"left\" text=\"bind:titleText\" tooltiptext=\"expr:dataset.getColumn(currow,&quot;titleText&quot;)\"/></Band></Format></Formats>");_g.addChild(_h.id,_h);_h.show();_h.addEventHandler('ondrag',_i,_e);_h.addEventHandler('ondrop',_j,_e);_h=new Grid("grdPivot","160","100","148","86");_h.set_autofittype("col");_h.set_scrolltype("vertical");_h.set_font(this.pivotShowUIConfig.gridFont);_h._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"157\"/></Columns><Rows><Row size=\"24\"/></Rows><Band id=\"body\"><Cell textAlign=\"left\" text=\"bind:titleText\" tooltiptext=\"expr:dataset.getColumn(currow,&quot;titleText&quot;)\"/></Band></Format></Formats>");_g.addChild(_h.id,_h);_h.show();_h.addEventHandler('ondrag',_i,_e);_h.addEventHandler('ondrop',_j,_e);_h=new Grid("grdFactor","160","206","148","103");_h.set_autofittype("col");_h.set_scrolltype("vertical");_h.set_font(this.pivotShowUIConfig.gridFont);_h._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"157\"/></Columns><Rows><Row size=\"24\"/></Rows><Band id=\"body\"><Cell textAlign=\"left\" text=\"bind:titleText\" tooltiptext=\"expr:dataset.getColumn(currow,&quot;titleText&quot;)\"/></Band></Format></Formats>");_g.addChild(_h.id,_h);_h.show();_h.addEventHandler('ondrag',_i,_e);_h.addEventHandler('ondrop',_j,_e);_h=new Static("Static03","161","188","118","17");_h.set_text(this.pivotShowUIConfig.valueFiledText);_h.set_color(this.pivotShowUIConfig.textColor);_h.set_font(this.pivotShowUIConfig.textFont);_g.addChild(_h.id,_h);_h.show();_h=new Static("Static02","160","83","118","17");_h.set_text(this.pivotShowUIConfig.columnFiledText);_h.set_color(this.pivotShowUIConfig.textColor);_h.set_font(this.pivotShowUIConfig.textFont);_g.addChild(_h.id,_h);_h.show();_h=new Button("btnClose","244","315","63","20");_h.set_text(this.pivotShowUIConfig.closeButtonText);_h.set_color(this.pivotShowUIConfig.buttonColor);_h.set_font(this.pivotShowUIConfig.buttonFont);_g.addChild(_h.id,_h);_h.show();_h.addEventHandler('onclick',function(_h,_m){_d.formatInfo.infods.reset();_d.formatInfo.groupds.reset();_d.formatInfo.pivotds.reset();_d.formatInfo.factords.reset();_g.set_visible(false);var _n="comPivotBtn___"+_d.id;var _o=_e.components[_n];_o.set_visible(true);},this);_h=new CheckBox("chkRightTotal","161","8","150","18");_h.set_text(this.pivotShowUIConfig.descRightTotalText);_h.set_value(this.pivotShowRightSummary);_h.set_font(this.pivotShowUIConfig.checkboxFont);_h.set_color(this.pivotShowUIConfig.checkboxColor);_g.addChild(_h.id,_h);_h.show();_h=new CheckBox("chkTotal","161","26","150","17");_h.set_text(this.pivotShowUIConfig.descSummaryText);_h.set_value(this.pivotShowSummary);_h.set_font(this.pivotShowUIConfig.checkboxFont);_h.set_color(this.pivotShowUIConfig.checkboxColor);_g.addChild(_h.id,_h);_h.show();_h=new CheckBox("chkSubsum","161","42","150","18");_h.set_text(this.pivotShowUIConfig.descSubSumText);_h.set_value(this.pivotGroupSubSum);_h.set_font(this.pivotShowUIConfig.checkboxFont);_h.set_color(this.pivotShowUIConfig.checkboxColor);_g.addChild(_h.id,_h);_h.show();_h=new Radio("Radio00","161","62","120","18");_g.addChild(_h.id,_h);_h.show();_h.set_codecolumn("code");_h.set_datacolumn("name");_h.set_innerdataset("ds_SUMAVG_Radiods");_h.set_columncount(2);_h.set_value(this.pivotShowUIConfig.radioValue);_h.set_font(this.pivotShowUIConfig.radioFont);_h.set_color(this.pivotShowUIConfig.radioColor);_h.addEventHandler('onitemchanged',function(_h,_m){if(_m.postvalue=="2"){_g.form.chkSubsum.set_value(0);_g.form.chkSubsum.set_enable(false);_d.pivotFactorOnlyNumber=true;}else{_d.pivotFactorOnlyNumber=_d.pivotFactorOnlyNumberOrg;_g.form.chkSubsum.set_enable(true);}},this);if(this.pivotShowAvg!==true){_h.set_visible(false);}_h=new Button("btnApply","177","315","63","20");_h.set_text(this.pivotShowUIConfig.applyButtonText);_h.set_color(this.pivotShowUIConfig.buttonColor);_h.set_font(this.pivotShowUIConfig.buttonFont);_g.addChild(_h.id,_h);_h.show();_h.addEventHandler('onclick',function(_h,_m){var _n=_d.resetPivot(_g.form.chkRightTotal.value,_g.form.chkTotal.value,_g.form.chkSubsum.value,_g.form.Radio00.value);if(_n==false){return;}_g.set_visible(false);var _o="comPivotBtn___"+_d.id;var _p=_e.components[_o];_p.set_visible(true);},this);}if(!_e.__pivotui){var _k="stcommonPivot_dragText";var _l=new Static(_k,"0","0","50","20");_l.set_usedecorate(true);_l.set_visible("false");_l.set_font("9pt Verdana");_e.addChild(_k,_l);_l.set_border("1px solid #808080");_l.set_background("beige");_l.show();_e.__pivotui=true;_e.addEventHandler('ondragmove',function(_h,_m){if(_g._pivotdragrow===null||_g._pivotdragrow===undefined||_g._pivotdragrow===""){_g._pivotdragrow="";return;}if(_g){if(_l.text==undefined||_l.text==""){var _n=new nexacro._FontObject("8pt Verdana");var _o=_g._pivotdragds.getColumn(_g._pivotdragrow,"titleText");var _p=nexacro._getTextSize(_o,_n);_l.set_width(_p[0]+20);_l.set_height(_p[1]+6);if(_l.width<50){_l.set_width(50);}if(_l.height<10){_l.set_height(10);}_l._orgtext=_o;_l.set_text(_o);_l.set_visible(true);}_l.bringToFront();_l.move(_m.clientx+5,_m.clienty-15);if(_m.fromobject&&_m.fromobject._type_name=="Grid"){var _q=_m.fromobject.id;if((_q=="grdAll")||(_q=="grdGroup")||(_q=="grdPivot")||(_q=="grdFactor")){var _r=_g._pivotdragds;var _s=_r.getColumn(_g._pivotdragrow,"colID");var _t=_d.pivotSourceDataset.getColumnInfo(_s);if(_d.pivotFactorOnlyNumber===true){if(_q=="grdFactor"){if(_t&&(_t.type!="BIGDECIMAL"&&_t.type!="INT"&&_t.type!="FLOAT")){_l.set_text("<fc v='red'>"+_l._orgtext+"</fc>");}}else if(_q=="grdGroup"||_q=="grdPivot"){if(_t&&(_t.type=="BIGDECIMAL"||_t.type=="INT"||_t.type=="FLOAT")){_l.set_text("<fc v='red'>"+_l._orgtext+"</fc>");}}else if(_q=="grdAll"){_l.set_text(_l._orgtext);}}else{_l.set_text(_l._orgtext);}}else{_g._pivotdragrow="";_g._pivotdraggrid="";_g._pivotdragds="";_l._orgtext="";_l.set_text("");_l.set_visible(false);}}else{if(_l.text!=_l._orgtext){_l.set_text(_l._orgtext);}}}},_e);_e.addEventHandler('ondrop',function(_h,_m){if(_g){if(_m.fromobject&&_m.fromobject._type_name=="Grid"){var _n=_m.fromobject.id;if((_n=="grdAll")||(_n=="grdGroup")||(_n=="grdPivot")||(_n=="grdFactor")){if(_l.text==_l._orgtext){var _o=_g._pivotdragds;var _p=_m.fromobject.getBindDataset();if(_o!==""&&_o.id!=_p.id){var _q=_p.findRow("colID",_o.getColumn(_g._pivotdragrow,"colID"));if(_q<0){var _q=_p.addRow();_p.copyRow(_q,_o,_g._pivotdragrow);_p.setColumn(_q,"show","1");var _r="";if(_n=="grdGroup"){_r="GROUP";}else if(_n=="grdPivot"){_r="PIVOT";}else if(_n=="grdFactor"){_r="FACTOR";}_p.setColumn(_q,"pivotInfo",_r);_o.deleteRow(_g._pivotdragrow);}}_o=_p=null;}}}_g._pivotdragrow="";_g._pivotdraggrid="";_g._pivotdragds="";_l._orgtext="";_l.set_text("");_l.set_visible(false);}},_e);}}};nexacro.Grid.prototype.set_showAvg=function(_a){if(_a===true){this.pivotShowAvg=true;}else{this.pivotShowAvg=false;}};nexacro.Grid.prototype.set_pivotProcessCnt=function(_a){this.pivotProcessCnt=_a;};nexacro.Grid.prototype.set_pivotFactorType=function(_a){if(_a=="SUM"||_a=="AVG"){this.pivotFactorType=_a;this.pivotShowUIConfig.radioValue=(_a=="SUM"?"1":"2");}};nexacro.Grid.prototype.set_pivotSumMask=function(_a){this.pivotSumMask=_a;};nexacro.Grid.prototype.set_pivotMaxCellCount=function(_a){this.pivotMaxCellCount=_a;};nexacro.Grid.prototype.set_pivotFactorOnlyNumber=function(_a,_b){this.pivotFactorOnlyNumber=_a;this.pivotFactorOnlyNumberOrg=_a;if(_b){this.pivotFactorStringMask=_b;}};nexacro.Grid.prototype.get_UIInfo=function(){this.pivotDefaultUI();return this.pivotShowUIConfig;};nexacro.Grid.prototype.set_showPivotSummary=function(_a,_b,_c){if(!_a){_a=false;}this.pivotShowSummary=_a;if(_a){this.pivotShowSummaryText=(_b&&_b!="")?_b:"TOTAL";this.pivotShowSummaryAlign=(_c&&_c!="")?_c:"center";}};nexacro.Grid.prototype.set_showPivotRightSummary=function(_a,_b,_c,_d,_e){if(!_a){_a=false;}this.pivotShowRightSummary=_a;if(!_e){_e=false;}if(_a){this.pivotShowRightSummarySize=(_b<50||!_b)?50:_b;this.pivotShowRightSummaryText=(_c&&_c!="")?_c:"TOTAL";this.pivotShowRightSummaryAlign=(_d&&_d!="")?_d:"left";this.pivotShowRightSummaryBandRight=_e;}};nexacro.Grid.prototype.set_pivotBodyRowHeight=function(_a){if(!_a){_a=24;}this.pivotBodyRowHeight=_a;};nexacro.Grid.prototype.set_pivotHeadRowHeight=function(_a){if(!_a){_a=24;}this.pivotHeadRowHeight=_a;};nexacro.Grid.prototype.set_pivotSummaryRowHeight=function(_a){if(!_a){_a=24;}this.pivotSummaryRowHeight=_a;};nexacro.Grid.prototype.set_pivotSubSum=function(_a,_b){this.pivotGroupSubSum=_a;this.pivotGroupSubSumLineExpr=_b;};nexacro.Grid.prototype.set_pivotSubSumColor=function(_a,_b){if(_b){this.pivotSubSumColor=_b;}this.pivotSubSumColorUse=_a;};nexacro.Grid.prototype.set_defaultMask=function(_a){this.pivotDefaultMask=_a;};nexacro.Grid.prototype.set_pivotUseGroupSuppress=function(_a){this.pivotGroupSuppress=_a;};nexacro.Grid.prototype.showPivotUI=function(_a){var _b=this.getOffsetLeft()+this.getOffsetWidth()-320;var _c=this.getOffsetTop();var _d=this._refform;var _e="comPivotBtn___"+this.id;var _f=_d.components[_e];_f.set_visible(false);var _g="commonPivotUI";var _h=_d.components[_g];_h.set_left(_b);_h.set_top(_c);var _i=this.formatInfo.infods;var _j=this.formatInfo.groupds;var _k=this.formatInfo.pivotds;var _l=this.formatInfo.factords;var _m,_n,_o= -1;var _p="";_i.set_enableevent(false);for(var _r=_i.rowcount-1;_r>=0;_r-- ){_p=_i.getColumn(_r,"colID");_m=_j.findRow("colID",_p);if(_m<0){_n=_k.findRow("colID",_p);if(_n<0){_o=_l.findRow("colID",_p);if(_o<0){}else{_i.deleteRow(_r);}}else{_i.deleteRow(_r);}}else{_i.deleteRow(_r);}}_i.filter("");_i.set_enableevent(true);_h.form.grdAll.set_binddataset(_i.id);_h.form.grdGroup.set_binddataset(_j.id);_h.form.grdPivot.set_binddataset(_k.id);_h.form.grdFactor.set_binddataset(_l.id);var _q=false;if(this.pivotShowRightSummary===null||this.pivotShowRightSummary===undefined||this.pivotShowRightSummary==""){_q=false;}else{_q=this.pivotShowRightSummary;}_h.form.chkRightTotal.set_value(_q);if(this.pivotShowSummary===null||this.pivotShowSummary===undefined||this.pivotShowSummary===""){_q=false;}else{_q=this.pivotShowSummary;}_h.form.chkTotal.set_value(_q);if(this.pivotGroupSubSum===null||this.pivotGroupSubSum===undefined||this.pivotGroupSubSum==""){_q=false;}else{_q=this.pivotGroupSubSum;}_h.form.chkSubsum.set_value(_q);if(this.pivotShowUIConfig.radioValue=="1"){_h.form.Radio00.set_value("1");}else{_h.form.Radio00.set_value("2");}_h.set_visible(true);_h.bringToFront();};nexacro.Grid.prototype.pivotCheckValidate=function(){var _a=this.pivotInfoDataset;var _b=this.pivotSourceDataset;if(!(_b instanceof nexacro.Dataset)){trace("[Error - original dataset(object) not found]");return false;}if(_a==false){trace("[Error - dataset(object) not found]");return false;}var _c=_a.getCaseCount("pivotInfo=='GROUP' && show=='1'");if(_c==0){trace("[Error - group info count : 0] "+_a.id);return false;}_c=_a.getCaseCount("pivotInfo=='PIVOT' && show=='1'");if(_c==0){trace("[Error - pivot info count : 0] "+_a.id);return false;}_c=_a.getCaseCount("pivotInfo=='FACTOR' && show=='1'");if(_c==0){trace("[Error - factor info count : 0] "+_a.id);return false;}for(var _h=0;_h<_a.rowcount;_h++ ){if(!_b.colinfos[_a.getColumn(_h,"colID")]){trace("[Error - column info not found] "+_a.getColumn(_h,"colID"));return false;}if(_a.getColumn(_h,"sort")==undefined||_a.getColumn(_h,"sort")==null||_a.getColumn(_h,"sort")==""){_a.setColumn(_h,"sort","ASC");}if(_a.getColumn(_h,"show")==undefined||_a.getColumn(_h,"show")==null||_a.getColumn(_h,"show")==""){_a.setColumn(_h,"show","1");}if(_a.getColumn(_h,"pivotInfo")=="GROUP"){if(!_a.getColumn(_h,"headAlign")||_a.getColumn(_h,"headAlign")==""){_a.setColumn(_h,"headAlign","left");}if(!_a.getColumn(_h,"bodyAlign")||_a.getColumn(_h,"bodyAlign")==""){_a.setColumn(_h,"bodyAlign","left");}}else if(_a.getColumn(_h,"pivotInfo")=="PIVOT"){if(!_a.getColumn(_h,"headAlign")||_a.getColumn(_h,"headAlign")==""){_a.setColumn(_h,"headAlign","left");}}else if(_a.getColumn(_h,"pivotInfo")=="FACTOR"){if(!_a.getColumn(_h,"headAlign")||_a.getColumn(_h,"headAlign")==""){_a.setColumn(_h,"headAlign","left");}if(!_a.getColumn(_h,"bodyAlign")||_a.getColumn(_h,"bodyAlign")==""){_a.setColumn(_h,"bodyAlign","right");}if(!_a.getColumn(_h,"displayType")||_a.getColumn(_h,"displayType")==""){_a.setColumn(_h,"displayType","number");}}}_a.filter("");var _d=_a._refform;var _e=_a.id+"_infoall";var _f=_d.objects[_e];if(!_f){_f=new Dataset;_d.addChild(_e,_f);_f.set_id(_e);_f.set_name(_e);}_f.copyData(_a,true);this.formatInfo.infods=_f;_e=_a.id+"_group";_f=_d.objects[_e];if(!_f){_f=new Dataset;_d.addChild(_e,_f);_f.set_id(_e);_f.set_name(_e);}_a.filter("pivotInfo=='GROUP' && show=='1'");_a.set_keystring("S:seq");_f.copyData(_a,true);this.formatInfo.groupds=_f;_e=_a.id+"_pivot";_f=_d.objects[_e];if(!_f){_f=new Dataset;_d.addChild(_e,_f);_f.set_id(_e);_f.set_name(_e);}_a.filter("pivotInfo=='PIVOT' && show=='1'");_a.set_keystring("S:seq");_f.copyData(_a,true);this.formatInfo.pivotds=_f;_e=_a.id+"_factor";_f=_d.objects[_e];if(!_f){_f=new Dataset;_d.addChild(_e,_f);_f.set_id(_e);_f.set_name(_e);}_a.filter("pivotInfo=='FACTOR' && show=='1'");_a.set_keystring("S:seq");_f.copyData(_a,true);this.formatInfo.factords=_f;for(var _i=0;_i<_f.rowcount;_i++ ){var _g=_b.colinfos[_f.getColumn(_i,"colID")];if(_g.type.toUpperCase()=="STRING"&&this.pivotFactorOnlyNumber==true){trace("pivotFactorOnlyNumber=true\n"+this.pivotGridMsg.M005+"\nCheck:"+_f.getColumn(_i,"titleText"));return false;}}_a=_b=_c=null;return true;};nexacro.Grid.prototype.findPivotCol=function(_a,_b,_c,_d){for(var _e=0;_e<_a.length;_e++ ){if(_a[_e].name==_b&&_a[_e].lvl==_c&&_a[_e].parentid==_d){return _e;}}return  -1;};nexacro.Grid.prototype.savePivotInfo=function(){var _a=this.pivotSourceDataset;var _b=this.pivotDataset;var _c="";var _d=[];var _e=this.formatInfo.pivotds;for(var _ae=0;_ae<_e.rowcount;_ae++ ){var _f=_e.getColumn(_ae,"colID");_c+=("+"+_f);_d.push(_a.colinfos[_f]._index);}var _g=[];_e=this.formatInfo.factords;for(var _ae=0;_ae<_e.rowcount;_ae++ ){var _f=_e.getColumn(_ae,"colID");var _h=_a.colinfos[_f];_g[_ae]={"colid":_f,"type":_h.type,"size":_h.size};}_a.pivotSrcSort("S:"+_c);var _i=_a._viewRecords;var _j=[];var _k="",_l="",_m="";this.arrPivotColList=[];this.arrFactorColList=[];var _n=[];var _o={"id":"AAAA_ROOT","name":"AAAA_ROOT","lvl": -1,"parentid":""};_n[0]=_o;var _p= -1;var _q= -1;var _r=0;var _s=0;var _t="";var _u="";var _v="";var _w="";var _x="";for(var _ae=0;_ae<_i.length;_ae++ ){if(_i[_ae]._level>0){continue;}_j=[];for(var _af=0;_af<_d.length;_af++ ){_m=this.pivotConvertData(_i[_ae][_d[_af]]);if(!_m||_m==""){_m=" ";}_j.push(_m);}_k=_j.join("");if(_k==_l){_i[_ae]["PVSEQ"]=(_s-1).toString().padLeft(4,'0');}else{_v=_w="AAAA_ROOT";for(var _af=0;_af<_j.length;_af++ ){_u=_w;_x=_j[_af].replace(/ /g,"_");_v+=_x;_q=this.findPivotCol(_n,_j[_af],_af,_u);if(_q== -1){var _y={"id":_v,"name":_j[_af],"lvl":_af,"parentid":_u};_n[_n.length]=_y;_y=null;}_w+=_x;}var _z=_s.toString().padLeft(4,'0');for(var _af=0;_af<_g.length;_af++ ){_t=_g[_af].colid+"__"+_af.toString().padLeft(2,'0')+"__"+_z;this.arrFactorColList[this.arrFactorColList.length]=_t;if(this.pivotFactorOnlyNumber===true){_b.addColumn(_t,_g[_af].type,_g[_af].size);if(this.pivotFactorType=="AVG"){_b.addColumn(_t+"__CNT",_g[_af].type,_g[_af].size);_b.addColumn(_t+"__AVG",_g[_af].type,_g[_af].size);}}else{_b.addColumn(_t,"BIGDECIMAL",_g[_af].size);}}_i[_ae]["PVSEQ"]=_z;_s=_s+1;_l=_k;}}this.nFactorAllCnt=_s;if(this.arrFactorColList.length>this.pivotMaxCellCount){alert(this.pivotGridMsg.M004);this.pivotProc1(false);return;}if(_n.length==0){this.pivotProc1(false);return;}_d=_g=_j=_k=null;_l=_u=_v=_w=null;var _aa={};var _ab=null,_ac=null;for(var _ae=0;_ae<_n.length;_ae++ ){var _ad=_n[_ae];_ad.children=[];_aa[_ad.id]=_ad;if(_ad.parentid==""){_ab=_ad;}else{_ac=_aa[_ad.parentid];_ac.children.push(_ad);}}this.arrPivotColList=_ab;this.pivotProc1(true);};nexacro.Grid.prototype.pivotCopyFactorRecord=function(_a,_b,_c,_d,_e,_f){var _g=_e["PVSEQ"];var _h="";var _i=0;var _j=0;var _k=0;var _l=0;for(var _r=0;_r<_d.length;_r++ ){_h=_c[_r]+"__"+_r.toString().padLeft(2,'0')+"__"+_g;_i=_a.getColumn2(_b,_h);if(this.pivotFactorOnlyNumber===false&&_f[_r]=="STRING"){if(!_i){_i=0;}}if(_i instanceof nexacro.Decimal){_i=_i.valueOf();}if(this.pivotFactorType=="AVG"){var _m=_a.getColumn2(_b,_h+"__CNT");if(!_m){_k=0;}else{_k=_m;}}if(this.pivotFactorOnlyNumber===false&&_f[_r]=="STRING"){_j=1;}else{_j=_e[_d[_r]];}if(_j instanceof nexacro.Decimal){_j=_j.valueOf();}if(this.pivotFactorType=="AVG"){_l=1;}if(_i&&_j){_a.setColumnDataOnly(_b,_h,(_i+_j));}else{_a.setColumnDataOnly(_b,_h,_j);}if(this.pivotFactorType=="AVG"){var _n=nexacro.toNumber(_k)+nexacro.toNumber(_l);_a.setColumnDataOnly(_b,_h+"__CNT",_n);if(_i&&_j){_a.setColumnDataOnly(_b,_h+"__AVG",((_i+_j)/_n));}else{_a.setColumnDataOnly(_b,_h+"__AVG",(_j/_n));}}if(this.pivotShowRightSummary){var _o="PV_SUBSUM_"+_r.toString();var _p=_a.getColumn2(_b,_o);if(!_p){_p=0;}_a.setColumnDataOnly(_b,_o,(_p+_j));if(this.pivotFactorType=="AVG"){var _q=_a.getColumn2(_b,_o+"__CNT");if(!_q){_q=0;}_q++ ;_a.setColumnDataOnly(_b,_o+"__CNT",_q);_a.setColumnDataOnly(_b,_o+"__AVG",(_p+_j)/_q);}}}_h=_i=_j=_k=_l=null;};nexacro.Grid.prototype.pivotCopyFixRecord=function(_a,_b,_c,_d,_e,_f){for(var _g=0;_g<_d.length;_g++ ){_a.setColumnDataOnly(_b,_f[_g],_e[_d[_g]]);}};nexacro.Grid.prototype.processPivot=function(){this.pivotsumsubcache=[];var _a=this.pivotSourceDataset;var _b=this.pivotDataset;this.set_enableevent(false);this.set_enableredraw(false);var _c=[];var _d=[];var _e=[];var _f=[];var _g=[];var _h=[];var _i=[];var _j=[];var _k="",_l="";var _m=this.formatInfo.groupds;var _n="";var _o;for(var _z=0;_z<_m.rowcount;_z++ ){_k=_m.getColumn(_z,"colID");_l=_m.getColumn(_z,"sort");if(!_l||_l==""){_l="+";}if(_l=="ASC"){_l="+";}else if(_l!="DESC"){_l="+";}else{_l="+";}_n+=(_l+_k);_c.push(_k);_o=_a.colinfos[_k];_d.push(_o._index);_b.addColumn(_k,_o.type,_o.size);_o=_b.colinfos[_k];_e.push(_o._index);}this.formatInfo.grouplist=_c;this.formatInfo.groupcolidxlist=_d;_m=this.formatInfo.pivotds;for(var _z=0;_z<_m.rowcount;_z++ ){_k=_m.getColumn(_z,"colID");_l=_m.getColumn(_z,"sort");if(!_l||_l==""){_l="+";}if(_l=="ASC"){_l="+";}else if(_l!="DESC"){_l="+";}else{_l="+";}_n+=(_l+_k);_f.push(_k);_g.push(_a.colinfos[_k]._index);}this.formatInfo.pivotlist=_f;this.formatInfo.pivotcolidxlist=_g;_m=this.formatInfo.factords;for(var _z=0;_z<_m.rowcount;_z++ ){_k=_m.getColumn(_z,"colID");_o=_a.colinfos[_k];_j.push(_o.type.toUpperCase());_h.push(_k);_i.push(_a.colinfos[_k]._index);}this.formatInfo.factorlist=_h;this.formatInfo.factorcolidxlist=_i;if(this.pivotShowRightSummary){for(var _z=0;_z<_h.length;_z++ ){_b.addColumn("PV_SUBSUM_"+_z.toString(),"BIGDECIMAL",255);if(this.pivotFactorType=="AVG"){_b.addColumn("PV_SUBSUM_"+_z.toString()+"__CNT","BIGDECIMAL",255);_b.addColumn("PV_SUBSUM_"+_z.toString()+"__AVG","BIGDECIMAL",255);}}}_a.pivotSrcSort("S:"+_n);var _p=_a._viewRecords;var _q=this.arrFactorColumnInfo;var _r="";var _s="";var _t="";var _u=String.fromCharCode(30);var _v=0;var _w,_x;var _y=_p.length;this.processPivotLoop(0,_p,_d,_u,_b,_v,_h,_i,_j,_c,_e);return;for(var _z=0;_z<_y;_z++ ){if(_p._level>0){continue;}_t=[];for(var _aa=0;_aa<_d.length;_aa++ ){_w=this.pivotConvertData(_p[_z][_d[_aa]]);_t.push(_w);}_s=_t.join("");if(_s==_u){this.pivotCopyFactorRecord(_b,_v,_h,_i,_p[_z],_j);}else{_v=_b.addRow();this.pivotCopyFixRecord(_b,_v,_c,_d,_p[_z],_e);this.pivotCopyFactorRecord(_b,_v,_h,_i,_p[_z],_j);}_u=_s;}_c=_d=_e=_j=_f=arrSaveColIndex=_g=_h=_i=null;this.pivotProc2();};nexacro.Grid.prototype.processPivotLoop=function(_a,_b,_c,_d,_e,_f,_g,_h,_i,_j,_k){var _l="";var _m=_b.length;var _n="";var _o="";var _p=this;for(var _s=_a;_s<_m;_s++ ){if(_b._level>0){continue;}_l=[];for(var _t=0;_t<_c.length;_t++ ){_n=this.pivotConvertData(_b[_s][_c[_t]]);_l.push(_n);}_o=_l.join("");if(_o==_d){this.pivotCopyFactorRecord(_e,_f,_g,_h,_b[_s],_i);}else{_f=_e.addRow();this.pivotCopyFixRecord(_e,_f,_j,_c,_b[_s],_k);this.pivotCopyFactorRecord(_e,_f,_g,_h,_b[_s],_i);}_d=_o;if(_s>0&&(_s%this.pivotProcessBaseCnt==0)){var _q=30+parseInt(((_s/_m)* 100)/2);var _r="["+_s+"/"+_m+"]";nexacro._OnceCallbackTimer.callonce(this._refform,function(){try{_p.createPivotProgress(true,_q,_r);_p.processPivotLoop(_s+1,_b,_c,_d,_e,_f,_g,_h,_i,_j,_k);}catch(e){}},10);return;}}_j=_c=_k=_i=null;arrPivotCol=arrSaveColIndex=arrPivotColIdx=_g=_h=null;this.pivotProc2();};nexacro.Grid.prototype.pivotValueReplace=function(_a,_b,_c,_d,_e){if(_b=="TEXT"){if(!_e){return "";}if(typeof (_e)!="string"){return _e;}}else{var _f=_a.getColumn(_c,"colID");if(_e.indexOf(_f)>=0){_e=nexacro.replaceAll(_e,_f,_d);}}_e=nexacro.replaceAll(_e,"&","&amp;");_e=nexacro.replaceAll(_e,"<","&lt;");_e=nexacro.replaceAll(_e,">","&gt;");_e=nexacro.replaceAll(_e,"\"","&quot;");_e=nexacro.replaceAll(_e,"'","&apos;");_e=nexacro.replaceAll(_e,'"',"&quot;");_e=nexacro.replaceAll(_e," ","&#32;");var _g=String.fromCharCode(13);_e=nexacro.replaceAll(_e,_g,"&#13;");return _e;};nexacro.Grid.prototype.getPivotContent=function(_a,_b,_c,_d,_e,_f,_g,_h,_i){var _j="";_j='\t\t<Cell col="'+_d+'" colspan="'+_e+'" row="'+_f+'" ';_j+='rowspan="'+_g+'" ';var _k=' ';if(_b=="BODY"){var _l=false;if(_i=="F"){var _m=_a.getColumn(_c,"colID");var _n=this.pivotSourceDataset.colinfos[_m];if(_n&&_n.type.toUpperCase()=="STRING"){_l=true;}_m=_n=null;}if(_a.getColumn(_c,"cssclass")!==undefined&&_a.getColumn(_c,"cssclass")!==null&&_a.getColumn(_c,"cssclass")!=""){var _o=(this.pivotValueReplace(_a,_b,_c,_h,_a.getColumn(_c,"cssclass")));_k+='cssclass="'+_o+'" ';}if(_a.getColumn(_c,"color")!==undefined&&_a.getColumn(_c,"color")!==null&&_a.getColumn(_c,"color")!=""){var _o=(this.pivotValueReplace(_a,_b,_c,_h,_a.getColumn(_c,"color")));_k+='color="'+_o+'" ';}var _p=_a.getColumn(_c,"bkColor");if(_p!==undefined&&_p!==null&&_p!=""){var _o=(this.pivotValueReplace(_a,_b,_c,_h,_p));_k+='background="'+_o+'" ';}_p=null;if(_i=="F"&&this.pivotFactorOnlyNumber===false&&_l==true){_k+='textAlign="'+"right"+'" ';}else{var _q=_a.getColumn(_c,"bodyAlign");if(_a.getColumn(_c,"bodyAlign")!==undefined&&_q!==null&&_q!=""){_k+='textAlign="'+(this.pivotValueReplace(_a,_b,_c,_h,_q))+'" ';}}if(this.pivotFactorType=="AVG"){if(_i=="F"&&_l==false){_j+='text="bind:'+(_h+"__AVG")+'" ';}else{_j+='text="bind:'+_h+'" ';}}else{_j+='text="bind:'+_h+'" ';}if(_i=="F"&&this.pivotFactorOnlyNumber===false&&_l==true){if(this.pivotFactorStringMask){_j+='maskeditformat="'+this.pivotFactorStringMask+'" ';}else{if(this.pivotDefaultMask){_j+='maskeditformat="'+this.pivotDefaultMask+'" ';}else{_j+='maskeditformat="#,###.##" ';}}}else{var _r=_a.getColumn(_c,"mask");if(_r!==undefined&&_r!==null&&_r!=""){_j+='maskeditformat="'+(this.pivotValueReplace(_a,_b,_c,_h,_r))+'" ';}else{if(_i=="F"&&this.pivotFactorType=="AVG"&&_l==false){if(this.pivotDefaultMask){_j+='maskeditformat="'+this.pivotDefaultMask+'" ';}else{_j+='maskeditformat="#,###.##" ';}}}_r=null;}if(_i=="F"&&this.pivotFactorOnlyNumber===false&&_l==true){if(_j.indexOf("maskeditformat")>=0){_j+='displaytype="mask" ';}else{_j+='displaytype="number" ';}}else{var _s=_a.getColumn(_c,"displaytype");if(_s!==undefined&&_s!==null&&_s!=""){if(_j.indexOf("maskeditformat")>=0){_j+='displaytype="mask" ';}else{_j+='displaytype="'+(this.pivotValueReplace(_a,_b,_c,_h,_s))+'" ';}}else{if(_j.indexOf("maskeditformat")>=0){_j+='displaytype="mask" ';}else{_j+='displaytype="normal" ';}}}var _t=_a.getColumn(_c,"comboDataset");if(_t!==undefined&&_t!==null&&_t!=""){_j+='combodataset="'+_t+'" ';var _u=_a.getColumn(_c,"comboCode");var _v=_a.getColumn(_c,"comboText");if(_u!==undefined&&_u!==null&&_u!=""){_j+='combocodecol="'+_u+'" ';}if(_v!==undefined&&_v!==null&&_v!=""){_j+='combodatacol="'+_v+'" ';}}if(_a.getColumn(_c,"pivotInfo")=="GROUP"){if(this.pivotGroupSuppress){if(_a.getColumn(_c,"pivotInfo")=="GROUP"){_j+='suppress="'+(_c+1)+'" ';}}}}else{if(_b=="HEAD"){if(_a.getColumn(_c,"headAlign")&&_a.getColumn(_c,"headAlign")!=""){_k+='textAlign="'+_a.getColumn(_c,"headAlign")+'" ';}else{_k+='textAlign="'+"center"+'" ';}}else if(_b=="SUMMARY"){if(_i=="F"){if(this.pivotFactorType=="AVG"){if(this.pivotSumMask){_j+='mask="'+this.pivotSumMask+'" ';}else if(this.pivotDefaultMask){_j+='mask="'+this.pivotDefaultMask+'" ';}else{_j+='maskeditformat="#,###.##" ';}}else{var _r=_a.getColumn(_c,"mask");if(_r!==undefined&&_r!==null&&_r!=""){_j+='maskeditformat="'+(this.pivotValueReplace(_a,_b,_c,_h,_r))+'" ';}}if(_j.indexOf("maskeditformat")>=0){_j+='displaytype="mask" ';}else{_j+='displaytype="number" ';}_k+='textAlign="right" ';}else{var _w="center";if(this.pivotShowSummaryAlign&&this.pivotShowSummaryAlign!=""){_w=this.pivotShowSummaryAlign;}else if(_a.getColumn(_c,"headAlign")&&_a.getColumn(_c,"headAlign")!=""){_w=_a.getColumn(_c,"headAlign");}_k+='textAlign="'+_w+'" ';}}_j+='text="'+this.pivotValueReplace("","TEXT",0,"",_h)+'" ';}_j=_j+_k+'/>\n';return _j;};nexacro.Grid.prototype.setPivotGridFormat=function(){var _a=this.pivotSourceDataset;var _b=this.pivotDataset;var _c="";var _d=[];_d.push('<Formats>\n');_d.push('<Format id="default">\n');_d.push('\t<Columns>\n');var _e=this.formatInfo.groupds;var _f="";for(var _y=0;_y<_e.rowcount;_y++ ){_f=_e.getColumn(_y,"size");_c='\t\t<Column size="'+(_f>0?_f:80)+'" band="left"/>\n';_d.push(_c);}_e=this.formatInfo.factords;var _g=[];for(var _y=0;_y<_e.rowcount;_y++ ){_g[_y]={"size":_e.getColumn(_y,"size")?_e.getColumn(_y,"size"):"80","headAlign":_e.getColumn(_y,"headAlign")?_e.getColumn(_y,"headAlign"):"center","bodyAlign":_e.getColumn(_y,"bodyAlign")?_e.getColumn(_y,"bodyAlign"):"right","bkColor":_e.getColumn(_y,"bkColor")?_e.getColumn(_y,"bkColor"):"","color":_e.getColumn(_y,"color")?_e.getColumn(_y,"color"):"","mask":_e.getColumn(_y,"mask")?_e.getColumn(_y,"mask"):"","titleText":_e.getColumn(_y,"titleText")?_e.getColumn(_y,"titleText"):""};}var _h=this.arrFactorColList.length/_e.rowcount;for(var _y=0;_y<_h;_y++ ){for(var _z=0;_z<_e.rowcount;_z++ ){_c='\t\t<Column size="'+_g[_z].size+'"/>\n';_d.push(_c);}}if(this.pivotShowRightSummary){for(var _z=0;_z<_e.rowcount;_z++ ){_c='\t\t<Column size="'+this.pivotShowRightSummarySize+'"';if(this.pivotShowRightSummaryBandRight){_c+=' band="right"';}_c+='/>\n';_d.push(_c);}}_d.push('\t</Columns>\n');_d.push('\t<Rows>\n');var _i=0;var _j=24;if(this.getRealRowSize( -1)>0){_j=this.getRealRowSize( -1);}for(var _y=0;_y<this.formatInfo.pivotlist.length;_y++ ){_c='\t\t<Row size="'+this.pivotHeadRowHeight+'"'+' band="head"/>\n';_d.push(_c);_i++ ;}if(this.formatInfo.factorlist.length>1){_c='\t\t<Row size="'+this.pivotHeadRowHeight+'"'+' band="head"/>\n';_d.push(_c);_i++ ;}_c='\t\t<Row size="'+this.pivotBodyRowHeight+'"/>\n';_d.push(_c);if(this.pivotShowSummary){_c='\t\t<Row size="'+this.pivotSummaryRowHeight+'"'+' band="summ"/>\n';_d.push(_c);}_d.push('\t</Rows>\n');var _k=0;_d.push('\t<Band id="head">\n');_e=this.formatInfo.groupds;for(var _y=0;_y<_e.rowcount;_y++ ){_c=this.getPivotContent(_e,"HEAD",_y,_k,1,0,_i,_e.getColumn(_y,"titleText"),"G");_d.push(_c);_k++ ;}var _l=this.formatInfo.factorlist.length;var _m=[];for(var _y=0;_y<_i;_y++ ){_m[_y]=_k;}_e=this.formatInfo.pivotds;var _n=this;var _o=function(_aa){if(_aa.children&&_aa.children.length>0){var _ab=0;_aa.children.forEach(function(_ac){_ab+=_o(_ac);});return _ab;}else{return 1;}};var _p=function(_aa){if(_aa.children){_aa.children.forEach(function(_ab){var _ac=_o(_ab);var _ad=_n.getPivotContent(_e,"HEAD",_ab.lvl,_m[_ab.lvl],(_ac* _l),_ab.lvl,1,_ab.name);_d.push(_ad);_m[_ab.lvl]+=(_ac* _l);if(_ab.children&&_ab.children.length>0){_p(_ab);}else{if(_l>1){for(var _y=0;_y<_l;_y++ ){var _u=' textAlign="'+_g[_y].headAlign+'" background="'+_g[_y].bkColor+'" color="'+_g[_y].color+'"';_ad='\t\t<Cell col="'+_m[_ab.lvl+1]+'" row="'+(_ab.lvl+1)+'" '+'text="'+_n.pivotValueReplace("","TEXT",0,"",_g[_y].titleText)+'" '+_u+'/>\n';_d.push(_ad);_m[_ab.lvl+1]+=1;_ad=_u=null;}}}});}};var _q=this.arrPivotColList;_p(_q);_k=_m[_i-1];if(this.pivotShowRightSummary){if(_g.length==1){_c='\t\t<Cell col="'+_k+'" rowspan="'+_i+'" '+'text="'+this.pivotValueReplace("","TEXT",0,"",this.pivotShowRightSummaryText)+'" textAlign="'+this.pivotShowRightSummaryAlign+'"/>\n';_d.push(_c);_k++ ;}else{_c='\t\t<Cell col="'+_k+'" rowspan="'+(_i-1)+'" colspan="'+(_g.length)+'" '+'text="'+this.pivotValueReplace("","TEXT",0,"",this.pivotShowRightSummaryText)+'" textAlign="'+this.pivotShowRightSummaryAlign+'"/>\n';_d.push(_c);for(var _y=0;_y<_g.length;_y++ ){_c='\t\t<Cell col="'+_k+'" row="'+(_i-1)+'" '+'text="'+this.pivotValueReplace("","TEXT",0,"",_g[_y].titleText)+'" textAlign="'+this.pivotShowRightSummaryAlign+'"/>\n';_d.push(_c);_k++ ;}}}_d.push('\t</Band>\n');_k=0;_d.push('\t<Band id="body">\n');_e=this.formatInfo.groupds;for(var _y=0;_y<_e.rowcount;_y++ ){_c=this.getPivotContent(_e,"BODY",_y,_k,1,0,1,_e.getColumn(_y,"colID"),"G");_d.push(_c);_k++ ;}_e=this.formatInfo.factords;var _r=0;for(var _y=0;_y<_h;_y++ ){for(var _z=0;_z<_e.rowcount;_z++ ){_c=this.getPivotContent(_e,"BODY",_z,_k,1,0,1,this.arrFactorColList[_r],"F");_d.push(_c);_k++ ;_r++ ;}}if(this.pivotShowRightSummary){var _s="";for(var _y=0;_y<_g.length;_y++ ){var _t="PV_SUBSUM_"+_y.toString();if(this.pivotFactorType=="AVG"){_t=_t+"__AVG";}var _u=' textAlign="'+_g[_y].bodyAlign+'"';if(_g[_y].mask&&_g[_y].mask.length>0){_s=_g[_y].mask;}else{if(this.pivotSumMask){_s=this.pivotSumMask;}else if(this.pivotDefaultMask){_s=this.pivotDefaultMask;}else{_s="#,###.##";}}_c='\t\t<Cell maskeditformat="'+_s+'" displaytype="mask" col="'+_k+'" text="bind:'+_t+'" textAlign="right"/>\n';_d.push(_c);_k++ ;}}_d.push('\t</Band>\n');if(this.pivotShowSummary){_d.push('\t<Band id="summary">\n');_k=0;_e=this.formatInfo.groupds;_c=this.getPivotContent(_e,"SUMMARY",0,_k,_e.rowcount,0,1,this.pivotShowSummaryText);_d.push(_c);_k=_e.rowcount;_e=this.formatInfo.factords;var _r=0;var _v=0;var _h=0;var _w=_b.getSum2(this.arrFactorColList,this.pivotFactorType);for(var _y=0;_y<this.arrFactorColList.length;_y++ ){if(this.pivotFactorType=="AVG"){_v=_w.sum[_y]/_w.cnt[_y];}else{_v=_w.sum[_y];}_h=(_y%_e.rowcount);_c=this.getPivotContent(_e,"SUMMARY",_h,_k,1,0,1,_v,"F");_d.push(_c);_k++ ;}if(this.pivotShowRightSummary){var _x=[];for(var _y=0;_y<_g.length;_y++ ){_x[_y]="PV_SUBSUM_"+_y.toString();}_w=_b.getSum2(_x,this.pivotFactorType);for(var _y=0;_y<_g.length;_y++ ){var _t="PV_SUBSUM_"+_y.toString();if(this.pivotFactorType=="AVG"){_v=_w.sum[_y]/_w.cnt[_y];}else{_v=_w.sum[_y];}_c=this.getPivotContent(_e,"SUMMARY",_y,_k,1,0,1,_v,"F");_d.push(_c);_k++ ;}}_w=null;_d.push('\t</Band>\n');}_d.push('\t</Format>\n');_d.push('\t</Formats>\n');try{this.set_formats(_d.join(""));}catch(e){}_d=_g=_m=null;this.arrPivotColList=_q=_p=_m=null;this.pivotProc3();};if(!Date.prototype.yyyymmdd){Date.prototype.yyyymmdd=function(){var _a=this.getFullYear();var _b=this.getMonth()<9?"0"+(this.getMonth()+1):(this.getMonth()+1);var _c=this.getDate()<10?"0"+this.getDate():this.getDate();return "".concat(_a).concat(_b).concat(_c);};Date.prototype.yyyymmddhhmm=function(){var _a=this.getFullYear();var _b=this.getMonth()<9?"0"+(this.getMonth()+1):(this.getMonth()+1);var _c=this.getDate()<10?"0"+this.getDate():this.getDate();var _d=this.getHours()<10?"0"+this.getHours():this.getHours();var _e=this.getMinutes()<10?"0"+this.getMinutes():this.getMinutes();return "".concat(_a).concat(_b).concat(_c).concat(_d).concat(_e);};Date.prototype.yyyymmddhhmmss=function(){var _a=this.getFullYear();var _b=this.getMonth()<9?"0"+(this.getMonth()+1):(this.getMonth()+1);var _c=this.getDate()<10?"0"+this.getDate():this.getDate();var _d=this.getHours()<10?"0"+this.getHours():this.getHours();var _e=this.getMinutes()<10?"0"+this.getMinutes():this.getMinutes();var _f=this.getSeconds()<10?"0"+this.getSeconds():this.getSeconds();return "".concat(_a).concat(_b).concat(_c).concat(_d).concat(_e).concat(_f);};}if(!Array.prototype.forEach){Array.prototype.forEach=function(_a,_b){var _c,_d;if(this===null){throw new TypeError(' this is null or not defined');}var _e=Object(this);var _f=_e.length>>>0;if(typeof _a!=="function"){throw new TypeError(_a+' is not a function');}if(arguments.length>1){_c=_b;}_d=0;while(_d<_f){var _g;if(_d in _e){_g=_e[_d];_a.call(_c,_g,_d,_e);}_d++ ;}};}if(!Array.prototype.reduce){Array.prototype.reduce=function(_a){if(this==null){throw new TypeError('Array.prototype.reduce called on null or undefined');}if(typeof _a!=='function'){throw new TypeError(_a+' is not a function');}var _b=Object(this),_c=_b.length>>>0,_d=0,_e;if(arguments.length==2){_e=arguments[1];}else{while(_d<_c&&!(_d in _b)){_d++ ;}if(_d>=_c){throw new TypeError('Reduce of empty array with no initial value');}_e=_b[_d++ ];}for(;_d<_c;_d++ ){if(_d in _b){_e=_a(_e,_b[_d],_d,_b);}}return _e;};}}
var pForm=nexacro.Form.prototype;pForm.gfnCreateChart=function(_a){var _b=this.gfnGetServerUrl();var _c=_b+"rMateChartH5/nexacroChartH5Sample.html";var _d=_b+"rMateChartH5/rMateChartH5";this.rMateChartCreate(_a,_d,_c,this.gfnMakeChartVars());};pForm.gfnMakeChartVars=function(){var _a="";var _b="rMateChartOnLoad";_a+="rMateOnLoadCallFunction="+_b;return _a;};pForm.gfnSetChart=function(_a,_b,_c,_d){var _e="";if(_c=="Line"){_e+="<rMateChart backgroundColor='0xFFFFFF' cornerRadius='12' borderThickness='1' borderStyle='none'>\n";_e+="<Options>\n";_e+="<Caption text='"+_d.title+"' />\n";_e+="<SubCaption text='"+_d.subtitle+"' textAlign='right' />\n";_e+="<Legend />\n";_e+="</Options>\n";_e+="<Line2DChart showDataTips='true' dataTipDisplayMode='axis' paddingTop='0' fontFamily='Dotum' color='#555555'>\n";_e+="<horizontalAxis>\n";_e+="<CategoryAxis categoryField='"+_d.xfield+"'/>\n";_e+="</horizontalAxis>\n";_e+="<verticalAxis>\n";_e+="<LinearAxis minimum='"+_d.minimum+"' maximum='"+_d.maximum+"' interval='"+_d.interval+"' />\n";_e+="</verticalAxis>\n";_e+="<series>\n";_e+="<Line2DSeries yField='"+_d.yfield+"' displayName='"+_d.displayName+"'>\n";_e+="<showDataEffect>\n";_e+="<SeriesInterpolate/>\n";_e+="</showDataEffect>\n";_e+="</Line2DSeries>\n";_e+="</series>\n";_e+="</Line2DChart>\n";_e+="</rMateChart>\n";}else if(_c=="Bar"){_e+="<rMateChart backgroundColor='#FFFFFF'  borderStyle='none'>\n";_e+="<Options>\n";_e+="<Caption text='"+_d.title+"' />\n";_e+="<SubCaption text='"+_d.subtitle+"' textAlign='right' />\n";_e+="<Legend />\n";_e+="</Options>\n";_e+="<Bar2DChart showDataTips='true'>\n";_e+="<horizontalAxis>\n";_e+="<LinearAxis minimum='"+_d.minimum+"' maximum='"+_d.maximum+"' interval='"+_d.interval+"'/>\n";_e+="</horizontalAxis>\n";_e+="<verticalAxis>\n";_e+="<CategoryAxis categoryField='"+_d.yfield+"'/>\n";_e+="</verticalAxis>\n";_e+="<series>\n";_e+="<Bar2DSeries labelPosition='outside' xField='"+_d.xfield+"' displayName='"+_d.xfielddisplayname+"' itemRenderer='SemiCircleBarItemRenderer' color='#ffffff'>\n";_e+="<showDataEffect>\n";_e+="<SeriesInterpolate/>\n";_e+="</showDataEffect>\n";_e+="</Bar2DSeries>\n";_e+="</series>\n";_e+="</Bar2DChart>\n";_e+="</rMateChart>\n";}else if(_c=="Column"){_e+="<rMateChart backgroundColor='0xFFFFFF' cornerRadius='12' borderThickness='1' borderStyle='none'>\n";_e+="<Options>\n";_e+="<Caption text='"+_d.title+"' />\n";_e+="<SubCaption text='"+_d.subtitle+"' textAlign='right' />\n";_e+="<Legend />\n";_e+="</Options>\n";_e+="<Column2DChart showDataTips='true' dataTipDisplayMode='axis' paddingTop='0' fontFamily='Dotum' color='#555555'>\n";_e+="<horizontalAxis>\n";_e+="<CategoryAxis categoryField='"+_d.xfield+"'/>\n";_e+="</horizontalAxis>\n";_e+="<verticalAxis>\n";_e+="<LinearAxis minimum='"+_d.minimum+"' maximum='"+_d.maximum+"' interval='"+_d.interval+"' />\n";_e+="</verticalAxis>\n";_e+="<series>\n";_e+="<Column2DSeries yField='"+_d.yfield+"' displayName='"+_d.displayName+"'>\n";_e+="<showDataEffect>\n";_e+="<SeriesInterpolate/>\n";_e+="</showDataEffect>\n";_e+="</Column2DSeries>\n";_e+="</series>\n";_e+="</Column2DChart>\n";_e+="</rMateChart>\n";}else if(_c=="Pie"){_e+="<rMateChart backgroundColor='0xFFFFFF' borderStyle='none' cornerRadius='5'>\n";_e+="<Options>\n";_e+="<Caption text='"+_d.title+"'/>\n";_e+="<SubCaption text='"+_d.subtitle+"'/>\n";_e+="<Legend position='right' direction='vertical' labelPlacement='right'/>\n";_e+="</Options>\n";_e+="<Pie2DChart showDataTips='true'>\n";_e+="<series>\n";_e+="<Pie2DSeries nameField='"+_d.fieldname+"' field='"+_d.field+"' labelPosition='callout' startAngle='90' fontFamily='Dotum' color='#555555'>\n";_e+="<showDataEffect>\n";_e+="<SeriesInterpolate duration='500'/>\n";_e+="</showDataEffect>\n";_e+="</Pie2DSeries>\n";_e+="</series>\n";_e+="</Pie2DChart>\n";_e+="</rMateChart>\n";}this.rMateChartSetLayout(_a,_e);this.rMateChartSetData(_a,this.rMateChartDataSetToXml(_b));};pForm.gfnSetMultiChart=function(_a,_b,_c,_d){var _e="";if(_c=="Line"){var _f=_d.yfield.split(",");var _g=_d.displayName.split(",");_e+="<rMateChart backgroundColor='0xFFFFFF' cornerRadius='12' borderThickness='1' borderStyle='none'>\n";_e+="<Options>\n";_e+="<Caption text='"+_d.title+"' />\n";_e+="<SubCaption text='"+_d.subtitle+"' textAlign='right' />\n";_e+="<Legend />\n";_e+="</Options>\n";_e+="<Line2DChart showDataTips='true'>\n";_e+="<horizontalAxis>\n";_e+="<CategoryAxis categoryField='"+_d.xfield+"'/>\n";_e+="</horizontalAxis>\n";_e+="<verticalAxis>\n";_e+="<LinearAxis minimum='"+_d.minimum+"' maximum='"+_d.maximum+"' interval='"+_d.interval+"' />\n";_e+="</verticalAxis>\n";_e+="<series>\n";for(var _j=0;_j<_f.length;_j++ ){_e+="<Line2DSeries yField='"+_f[_j]+"' displayName='"+_g[_j]+"'>\n";_e+="<showDataEffect>\n";_e+="<SeriesInterpolate/>\n";_e+="</showDataEffect>\n";_e+="</Line2DSeries>\n";}_e+="</series>\n";_e+="</Line2DChart>\n";_e+="</rMateChart>\n";}else if(_c=="Bar"){var _h=_d.xfield.split(",");var _i=_d.xfielddisplayname.split(",");_e+="<rMateChart backgroundColor='#FFFFFF'  borderStyle='none'>\n";_e+="<Options>\n";_e+="<Caption text='"+_d.title+"' />\n";_e+="<SubCaption text='"+_d.subtitle+"' textAlign='right' />\n";_e+="<Legend />\n";_e+="</Options>\n";_e+="<Bar2DChart showDataTips='true'>\n";_e+="<horizontalAxis>\n";_e+="<LinearAxis minimum='"+_d.minimum+"' maximum='"+_d.maximum+"' interval='"+_d.interval+"'/>\n";_e+="</horizontalAxis>\n";_e+="<verticalAxis>\n";_e+="<CategoryAxis categoryField='"+_d.yfield+"'/>\n";_e+="</verticalAxis>\n";_e+="<series>\n";for(var _j=0;_j<_h.length;_j++ ){_e+="<Bar2DSeries labelPosition='outside' xField='"+_h[_j]+"' displayName='"+_i[_j]+"' itemRenderer='SemiCircleBarItemRenderer'>\n";_e+="<showDataEffect>\n";_e+="<SeriesInterpolate/>\n";_e+="</showDataEffect>\n";_e+="</Bar2DSeries>\"n";}_e+="</series>\n";_e+="</Bar2DChart>\n";_e+="</rMateChart>\n";}else if(_c=="Column"){var _f=_d.yfield.split(",");var _g=_d.displayName.split(",");_e+="<rMateChart backgroundColor='0xFFFFFF' cornerRadius='12' borderThickness='1' borderStyle='none'>\n";_e+="<Options>\n";_e+="<Caption text='"+_d.title+"' />\n";_e+="<SubCaption text='"+_d.subtitle+"' textAlign='right' />\n";_e+="<Legend />\n";_e+="</Options>\n";_e+="<Column2DChart showDataTips='true'>\n";_e+="<horizontalAxis>\n";_e+="<CategoryAxis categoryField='"+_d.xfield+"'/>\n";_e+="</horizontalAxis>\n";_e+="<verticalAxis>\n";_e+="<LinearAxis minimum='"+_d.minimum+"' maximum='"+_d.maximum+"' interval='"+_d.interval+"' />\n";_e+="</verticalAxis>\n";_e+="<series>\n";for(var _j=0;_j<_f.length;_j++ ){_e+="<Column2DSeries yField='"+_f[_j]+"' displayName='"+_g[_j]+"'>\n";_e+="<showDataEffect>\n";_e+="<SeriesInterpolate/>\n";_e+="</showDataEffect>\n";_e+="</Column2DSeries>\n";}_e+="</series>\n";_e+="</Column2DChart>\n";_e+="</rMateChart>\n";}this.rMateChartSetLayout(_a,_e);this.rMateChartSetData(_a,this.rMateChartDataSetToXml(_b));};pForm.gfnSetCombinationChart=function(_a,_b,_c){var _d="";var _e=_c.yfield.split(",");var _f=_c.displayName.split(",");_d+="<rMateChart backgroundColor='#FFFFFF'  borderStyle='none'>\n";_d+="<Options>\n";_d+="<Caption text='Annual Report'/>\n";_d+="</Options>\n";_d+="<NumberFormatter id='numfmt' useThousandsSeparator='true'/>\n";_d+="<Combination2DChart showDataTips='true'>\n";_d+="<horizontalAxis>\n";_d+="<CategoryAxis categoryField='Month' padding='1'/>\n";_d+="</horizontalAxis>\n";_d+="<verticalAxis>\n";_d+="<LinearAxis id='vAxis1' formatter='{numfmt}' maximum='100' interval='10'/>\n";_d+="</verticalAxis>\n";_d+="<series>\n";_d+="<Column2DSeries labelPosition='outside' yField='"+_e[0]+"' displayName='"+_f[0]+"'>\n";_d+="<fill>\n";_d+="<SolidColor color='#41b2e6'/>\n";_d+="</fill>\n";_d+="<showDataEffect>\n";_d+="<SeriesInterpolate/>\n";_d+="</showDataEffect>\n";_d+="</Column2DSeries>\n";_d+="<Line2DSeries radius='6' yField='"+_e[1]+"' displayName='"+_f[1]+"'>\n";_d+="<verticalAxis>\n";_d+="<LinearAxis id='vAxis2'/>\n";_d+="</verticalAxis>\n";_d+="<showDataEffect>\n";_d+="<SeriesInterpolate/>\n";_d+="</showDataEffect>\n";_d+="<lineStroke>\n";_d+="<Stroke color='#f9bd03' weight='4'/>\n";_d+="</lineStroke>\n";_d+="<stroke>\n";_d+="<Stroke color='#f9bd03' weight='3'/>\n";_d+="</stroke>\n";_d+="</Line2DSeries>\n";_d+="</series>\n";_d+="<verticalAxisRenderers>\n";_d+="<Axis2DRenderer axis='{vAxis1}' showLine='false'/>\n";_d+="<Axis2DRenderer axis='{vAxis2}' showLine='false'/>\n";_d+="</verticalAxisRenderers>\n";_d+="</Combination2DChart>\n";_d+="</rMateChart>\n";this.rMateChartSetLayout(_a,_d);this.rMateChartSetData(_a,this.rMateChartDataSetToXml(_b));};
