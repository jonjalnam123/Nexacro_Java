(function(){return function(){if(!this._is_form){return;}var _a=null;this.on_create=function(){this.set_name("TE_CertificateInfoReg");this.set_titletext("수료증출력");this.set_cssclass("frm_popBg");if(Form==this.constructor){this._setFormPosition(400,296);}_a=new Dataset("ds_Product",this);_a._setContents("<ColumnInfo><Column id=\"CODE\" type=\"STRING\" size=\"256\"/><Column id=\"NAME\" type=\"STRING\" size=\"256\"/></ColumnInfo><Rows><Row><Col id=\"CODE\">MP</Col><Col id=\"NAME\">v3.2</Col></Row><Row><Col id=\"CODE\">MP</Col><Col id=\"NAME\">v3.3</Col></Row><Row><Col id=\"CODE\">XP</Col><Col id=\"NAME\">v9.1</Col></Row><Row><Col id=\"CODE\">XP</Col><Col id=\"NAME\">v9.2</Col></Row><Row><Col id=\"CODE\">NP14</Col><Col id=\"NAME\">nexacro platform 14</Col></Row><Row><Col id=\"CODE\">NP17</Col><Col id=\"NAME\">nexacro platform 17</Col></Row><Row><Col id=\"CODE\">NPN</Col><Col id=\"NAME\">NEXACRO N</Col></Row></Rows>");this.addChild(_a.name,_a);_a=new Dataset("ds_print",this);_a._setContents("<ColumnInfo><Column id=\"cer_no\" type=\"STRING\" size=\"256\"/><Column id=\"req_nm\" type=\"STRING\" size=\"256\"/><Column id=\"company_nm\" type=\"STRING\" size=\"256\"/><Column id=\"course_nm\" type=\"STRING\" size=\"256\"/><Column id=\"period\" type=\"STRING\" size=\"256\"/><Column id=\"yyyy\" type=\"STRING\" size=\"256\"/><Column id=\"mm\" type=\"STRING\" size=\"256\"/><Column id=\"dd\" type=\"STRING\" size=\"256\"/><Column id=\"imgLogo\" type=\"STRING\" size=\"256\"/><Column id=\"imgStamp\" type=\"STRING\" size=\"256\"/><Column id=\"outLine\" type=\"STRING\" size=\"256\"/><Column id=\"getTime\" type=\"STRING\" size=\"256\"/><Column id=\"CEO_NAME\" type=\"STRING\" size=\"256\"/><Column id=\"EMAIL\" type=\"STRING\" size=\"256\"/><Column id=\"ESL_SEQ\" type=\"STRING\" size=\"256\"/><Column id=\"product_nm\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_main",this);_a._setContents("<ColumnInfo><Column id=\"ESL_SEQ\" type=\"BIGDECIMAL\" size=\"18\"/><Column id=\"EDU_PRODUCT_CODE\" type=\"STRING\" size=\"20\"/><Column id=\"ES_SEQ\" type=\"INT\" size=\"10\"/><Column id=\"EMP_NAME\" type=\"STRING\" size=\"100\"/><Column id=\"COMPANY_NAME\" type=\"STRING\" size=\"100\"/><Column id=\"DEPT_NAME\" type=\"STRING\" size=\"100\"/><Column id=\"DUTY_NAME\" type=\"STRING\" size=\"100\"/><Column id=\"PHONE_NO\" type=\"STRING\" size=\"20\"/><Column id=\"EMAIL\" type=\"STRING\" size=\"200\"/><Column id=\"STATUS_CD\" type=\"STRING\" size=\"20\"/><Column id=\"REQ_REASON\" type=\"STRING\" size=\"20\"/><Column id=\"REQ_REASON_ETC\" type=\"STRING\" size=\"512\"/><Column id=\"QUESTION\" type=\"STRING\" size=\"512\"/><Column id=\"ATTEND_FLAG\" type=\"STRING\" size=\"1\"/><Column id=\"CERTIFICATES_FLAG\" type=\"STRING\" size=\"1\"/><Column id=\"CONSULTING_FLAG\" type=\"STRING\" size=\"1\"/><Column id=\"MARKETING_AGREE_FLAG\" type=\"STRING\" size=\"1\"/><Column id=\"INSERT_DATE\" type=\"DATETIME\" size=\"23\"/><Column id=\"INSERT_EMP_NO\" type=\"STRING\" size=\"60\"/><Column id=\"INSERT_DEPT_CD\" type=\"STRING\" size=\"60\"/><Column id=\"INSERT_DEPT_NM\" type=\"STRING\" size=\"100\"/><Column id=\"INSERT_MODEL\" type=\"STRING\" size=\"100\"/><Column id=\"UPDATE_DATE\" type=\"DATETIME\" size=\"23\"/><Column id=\"UPDATE_EMP_NO\" type=\"STRING\" size=\"60\"/><Column id=\"UPDATE_DEPT_CD\" type=\"STRING\" size=\"60\"/><Column id=\"UPDATE_DEPT_NM\" type=\"STRING\" size=\"100\"/><Column id=\"UPDATE_MODEL\" type=\"STRING\" size=\"100\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("dsCompanyList",this);_a._setContents("<ColumnInfo><Column id=\"COMPANY_NAME\" type=\"STRING\" size=\"100\"/><Column id=\"COMPANY_REG_NO\" type=\"STRING\" size=\"30\"/><Column id=\"CEO_NAME\" type=\"STRING\" size=\"100\"/><Column id=\"BUSINESS_FORM_NAME\" type=\"STRING\" size=\"30\"/><Column id=\"BUSINESS_KIND_NAME\" type=\"STRING\" size=\"30\"/><Column id=\"PHONE_NO\" type=\"STRING\" size=\"30\"/><Column id=\"FAX_NO\" type=\"STRING\" size=\"30\"/><Column id=\"POST_NO\" type=\"STRING\" size=\"10\"/><Column id=\"POST_ADDR\" type=\"STRING\" size=\"255\"/><Column id=\"DETAIL_ADDR\" type=\"STRING\" size=\"255\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_SendMail",this);_a._setContents("<ColumnInfo><Column id=\"USER_ID\" type=\"STRING\" size=\"256\"/><Column id=\"FROM\" type=\"STRING\" size=\"256\"/><Column id=\"FROM_NAME\" type=\"STRING\" size=\"256\"/><Column id=\"TO\" type=\"STRING\" size=\"256\"/><Column id=\"TO_NAME\" type=\"STRING\" size=\"256\"/><Column id=\"TITLE\" type=\"STRING\" size=\"256\"/><Column id=\"CONTENTS\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("ds_insendmail",this);_a._setContents("<ColumnInfo><Column id=\"USER_ID\" type=\"STRING\" size=\"256\"/><Column id=\"FROM\" type=\"STRING\" size=\"256\"/><Column id=\"TO\" type=\"STRING\" size=\"256\"/><Column id=\"TO_NAME\" type=\"STRING\" size=\"256\"/><Column id=\"PRODUCT_NAME\" type=\"STRING\" size=\"256\"/><Column id=\"TITLE\" type=\"STRING\" size=\"256\"/><Column id=\"CONTENTS\" type=\"STRING\" size=\"256\"/><Column id=\"ESL_SEQ\" type=\"STRING\" size=\"256\"/><Column id=\"CER_NO\" type=\"STRING\" size=\"256\"/><Column id=\"COURSE_NM\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Static("stc_BottomFrame","1",null,null,"38","1","1",null,null,null,null,this);_a.set_taborder("10");_a.set_cssclass("sta_POP_BtnBg");_a.set_text("");this.addChild(_a.name,_a);_a=new Static("stc_CertificateReg","4","39",null,null,"4","44",null,null,null,null,this);_a.set_taborder("0");_a.set_text("");_a.set_cssclass("sta_WF_detailBg");this.addChild(_a.name,_a);_a=new Static("stc_ProductVer","14","48","54","22",null,null,null,null,null,null,this);_a.set_taborder("1");_a.set_text("제품 버전");_a.set_cssclass("sta_WF_DetailTit");_a.set_textAlign("right");this.addChild(_a.name,_a);_a=new Static("stc_Count","375","78","14","22",null,null,null,null,null,null,this);_a.set_taborder("2");_a.set_text("명");_a.set_cssclass("sta_WF_DetailTit");_a.set_textAlign("left");this.addChild(_a.name,_a);_a=new Static("stc_Total","337","78","30","22",null,null,null,null,null,null,this);_a.set_taborder("3");_a.set_text("");_a.set_cssclass("sta_WF_DetailTit");_a.set_textAlign("right");this.addChild(_a.name,_a);_a=new Static("stc_Border","246","48","54","22",null,null,null,null,null,null,this);_a.set_taborder("4");_a.set_text("테두리");_a.set_cssclass("sta_WF_DetailTit");_a.set_textAlign("right");this.addChild(_a.name,_a);_a=new Combo("cmb_ProductVer","76","48","155","22",null,null,null,null,null,null,this);_a.set_taborder("5");_a.set_innerdataset("ds_Product");_a.set_codecolumn("CODE");_a.set_datacolumn("NAME");_a.set_text("");_a.set_index("-1");this.addChild(_a.name,_a);_a=new Combo("cmb_Border","308","48","80","22",null,null,null,null,null,null,this);_a.set_taborder("6");_a.set_codecolumn("codecolumn");_a.set_datacolumn("datacolumn");var _b=new nexacro.NormalDataset("cmb_Border_innerdataset",_a);_b._setContents("<ColumnInfo><Column id=\"codecolumn\" size=\"256\"/><Column id=\"datacolumn\" size=\"256\"/></ColumnInfo><Rows><Row><Col id=\"codecolumn\">n</Col><Col id=\"datacolumn\">무</Col></Row><Row><Col id=\"codecolumn\">y</Col><Col id=\"datacolumn\">유</Col></Row></Rows>");_a.set_innerdataset(_b);_a.set_text("유");_a.set_value("y");_a.set_index("1");this.addChild(_a.name,_a);_a=new Button("btn_Close",null,"9","15","15","10",null,null,null,null,null,this);_a.set_taborder("7");_a.set_cssclass("btn_POP_Cls");_a.set_escapebutton("true");this.addChild(_a.name,_a);_a=new Button("btn_Preview",null,null,"84","22","14","9",null,null,null,null,this);_a.set_taborder("8");_a.set_text("미리보기");_a.set_cssclass("btn_WF_tran");this.addChild(_a.name,_a);_a=new Static("st_Title","10","0","70","35",null,null,null,null,null,null,this);_a.set_taborder("9");_a.set_text("수료증출력");_a.set_cssclass("sta_POP_Title");this.addChild(_a.name,_a);_a=new Button("btn_EmailSend",null,null,"120","22","103","9",null,null,null,null,this);_a.set_taborder("11");_a.set_text("수료증 메일 전송");this.addChild(_a.name,_a);_a=new TextArea("ta_Email","12","108",null,null,"12","52",null,null,null,null,this);_a.set_taborder("12");_a.set_value("안녕하세요\n투비소프트 교육팀입니다.");this.addChild(_a.name,_a);_a=new Static("stc_ProductVer00","14","78","94","22",null,null,null,null,null,null,this);_a.set_taborder("13");_a.set_text("수료증 메일 내용");_a.set_cssclass("sta_WF_DetailTit");_a.set_textAlign("right");this.addChild(_a.name,_a);_a=new Static("stc_ProductVer00_00","246","78","94","22",null,null,null,null,null,null,this);_a.set_taborder("14");_a.set_text("수료증 출력 대상");_a.set_cssclass("sta_WF_DetailTit");_a.set_textAlign("right");this.addChild(_a.name,_a);_a=new Layout("default","",400,296,this,function(_c){});_a.set_mobileorientation("landscape");this.addLayout(_a.name,_a);};this.loadPreloadList=function(){};this.addIncludeScript("TE_CertificateInfoReg.xfdl","Script::CommSystem.xjs");this.addIncludeScript("TE_CertificateInfoReg.xfdl","Script::CommTrans.xjs");this.addIncludeScript("TE_CertificateInfoReg.xfdl","Script::CommUtil.xjs");this.addIncludeScript("TE_CertificateInfoReg.xfdl","Script::CommGrid.xjs");this.addIncludeScript("TE_CertificateInfoReg.xfdl","Script::ext_Report.xjs");this.registerScript("TE_CertificateInfoReg.xfdl",function(){this.executeIncludeScript("Script::CommSystem.xjs");this.executeIncludeScript("Script::CommTrans.xjs");this.executeIncludeScript("Script::CommUtil.xjs");this.executeIncludeScript("Script::CommGrid.xjs");this.executeIncludeScript("Script::ext_Report.xjs");this.FV_LOGIN_EMP_NO=nexacro.getApplication().gdsUserInfo.getColumn(0,"EMP_NO");this.FV_LOGIN_EMP_NM=nexacro.getApplication().gdsUserInfo.getColumn(0,"EMP_NM");this.FV_LOGIN_EMAIL=nexacro.getApplication().gdsUserInfo.getColumn(0,"EMAIL");this.FV_TEL_NO="02-2140-7700";this.TE_CertificateInfoReg_onload=function(_a,_b){this.fnFormInit();};this.fnFormInit=function(){this.fnGetCompanyList();if(!this.gfnIsEmpty(this.parent.Office_TelNo)){this.FV_TEL_NO=this.parent.Office_TelNo;}if(this.gfnIsEmpty(this.parent.Product_Name)){this.cmb_ProductVer.set_enable(false);this.cmb_ProductVer.set_index( -1);this.cmb_Border.set_index(1);}else{this.ds_Product.filter("CODE == '"+this.parent.Product_Name+"'");this.cmb_ProductVer.set_index(this.ds_Product.rowcount-1);}this.ds_main.assign(this.parent.dsPrint);this.stc_Total.set_text(this.ds_main.rowcount);};this.fn_setSendMailInputDs=function(){this.ds_insendmail.clearData();for(var _e=0;_e<this.ds_print.rowcount;_e++ ){var _b=this.ds_insendmail.addRow();var _c=this.ds_print.getColumn(_e,"product_nm");this.ds_insendmail.setColumn(_b,"USER_ID",this.FV_LOGIN_EMP_NO);this.ds_insendmail.setColumn(_b,"FROM",this.FV_LOGIN_EMAIL);this.ds_insendmail.setColumn(_b,"TO",this.ds_print.getColumn(_e,"EMAIL"));this.ds_insendmail.setColumn(_b,"TO_NAME",this.ds_print.getColumn(_e,"req_nm"));this.ds_insendmail.setColumn(_b,"PRODUCT_NAME",_c);this.ds_insendmail.setColumn(_b,"TITLE","[투비소프트]"+_c+" 수료증");this.ds_insendmail.setColumn(_b,"ESL_SEQ",this.ds_print.getColumn(_e,"ESL_SEQ"));this.ds_insendmail.setColumn(_b,"CER_NO",this.ds_print.getColumn(_e,"cer_no"));this.ds_insendmail.setColumn(_b,"COURSE_NM",this.ds_print.getColumn(_e,"course_nm"));var _d="<DIV style='MARGIN: auto'> "+"	<DIV style='HEIGHT: 300px; WIDTH: 650px; BACKGROUND-IMAGE: url(http://www.tobesoft.co.kr/upload/license/images/tobe_bg2.png); PADDING-TOP: 90px; MARGIN: auto'> "+"		<TABLE style='MARGIN: auto' borderColor=#db0003 cellSpacing=12 width=580 align=center border=0 cstyle='table-layout'> "+"			<TBODY> "+"				<TR> "+"					<TD vAlign=top align=left> "+"						<SPAN style='FONT-SIZE: 18pt; FONT-FAMILY: 돋움; FONT-WEIGHT: bold'>"+_c+"수료증</SPAN> <br/><br/>"+"						<pre style='FONT-SIZE: 10pt; FONT-FAMILY: 돋움'>"+this.ta_Email.text+"</pre> <br/>"+"						<SPAN style='FONT-SIZE: 10pt; FONT-FAMILY: 돋움'> "+"							"+this.ds_print.getColumn(_e,"course_nm")+" 과정 교육에 참여해 주셔서 감사합니다.  <p/> "+"						</SPAN> "+"					</TD> "+"				</TR> "+"			</TBODY> "+"		</TABLE> "+"	</DIV> "+" "+"	<DIV style='BORDER-TOP: #bdbdbd 1px solid; HEIGHT: 100px; BORDER-RIGHT: #bdbdbd 1px solid; WIDTH: 650px; BORDER-BOTTOM: #bdbdbd 1px solid; BORDER-LEFT: #bdbdbd 1px solid;  MARGIN: auto'>  "+"		<TABLE height=100 cellSpacing=0 cellPadding=0 align=right border=0> "+"		<TBODY> "+"			<TR> "+"				<TD width=400 align=right><FONT color=#676666 size=2 face=돋움>(주)투비소프트</FONT></TD> "+"				<TD rowSpan=3 width=130 align=center><A href='http://www.tobesoft.co.kr'><IMG border=0 alt=TOBESOFT_LOGO src='http://www.tobesoft.co.kr/upload/license/images/tobe_logo.png' width=90 height=30></A></TD>"+"			</TR> "+"			<TR> "+"				<TD><DIV align=right><FONT color=#676666 size=2 face=돋움>서울시 강남구 봉은사로 617 인탑스빌딩 2-5층</FONT></DIV></TD> "+"			</TR> "+"			<TR> "+"				<TD align=right><FONT color=#676666 size=2 face=돋움>Tel : "+this.FV_TEL_NO+" &nbsp; <A href='http://www.tobesoft.co.kr'>www.tobesoft.co.kr</A></FONT></TD> "+"			</TR> "+"		</TBODY> "+"		</TABLE> "+"	</DIV> "+"</DIV> ";this.ds_insendmail.setColumn(_b,"CONTENTS",_d);}};this.fnGetCompanyList=function(){this.gfnAddOutputDataset("dsCompanyList","dsOutput");this.gfnCommonTransaction("fnGetCompanyList","SP_PurchaseRegSiReport_S01",null,false);};this.fn_EduCertificateFileSave=function(){this.fnSetPrintInput(true);var _b="ServiceURL::ubi4/ubiexport_Certificate.jsp";var _c="ds_Print=ds_print";var _d="";this.transaction("PDF_Save",_b,_c,"",_d,"fnCallBack");};this.fnSendMail=function(){this.fn_setSendMailInputDs();this.gfnAddInputDataset("ds_insendmail","ds_input");this.gfnCommonTransaction("SendMail","TE_CertificateSendMail_R01");};this.fnCallBack=function(_b,_c,_d){if(_c!=0){alert("strSvcID : "+_b+"\n"+"nErrorCode : "+_c+"\n"+"strErrorMag : "+_d);return;}else{if(_b=="PDF_Save"){this.fnSendMail();}else if(_b=="SendMail"){this.alert("수료증 메일 전송이 완료 되었습니다.");}}};this.comm_Click=function(_a,_b){switch(_a.name){case "btn_Close":this.commUtil.popupClose();break;case "btn_Preview":this.fnSetPrintInput(false);this.gfn_SetAddInputDs("ds_print",this.ds_print);this.gfnPopupReportViewer("EDU_CERTIFICATE.jrf");break;case "btn_EmailSend":this.fn_EduCertificateFileSave();break;}};this.fnSetPrintInput=function(_b){this.ds_print.clearData();var _c="";var _d=nexacro.getEnvironment();var _e=_d.services["ServiceURL"].url;for(var _t=0;_t<this.ds_main.rowcount;_t++ ){var _f=this.ds_print.addRow();var _g;var _h=this.ds_main.getColumn(_t,"EDU_PRODUCT_CODE");var _i=this.ds_main.getColumn(_t,"START_DATE");var _j=this.ds_main.getColumn(_t,"END_DATE");var _k=_j.split("-");var _l=parseInt(this.gfnGetDiffDay(_i.replace("-","").replace("-",""),_j.replace("-","").replace("-","")))+1;var _m=this.ds_main.getColumn(_t,"EDU_TYPE_DET_NAME");var _n=_l* 6;var _o=this.ds_main.getColumn(_t,"ESL_SEQ");this.ds_print.setColumn(_f,"ESL_SEQ",_o);this.ds_print.setColumn(_f,"EMAIL",this.ds_main.getColumn(_t,"EMAIL"));var _p=_i.substr(0,4)+" - "+_j.substr(5,2)+"-"+_i.substr(8,2)+_j.substr(8,2)+"-"+_o;this.ds_print.setColumn(_f,"cer_no",_p);var _q=this.ds_main.getColumn(_t,"EMP_NAME");this.ds_print.setColumn(_f,"req_nm",_q);var _r=this.ds_main.getColumn(_t,"COMPANY_NAME");this.ds_print.setColumn(_f,"company_nm",_r);var _s;if(_h=="MP"){_s=this.gfnIsEmpty(this.cmb_ProductVer.text)?"v3.2":this.cmb_ProductVer.text;_c="X-Internet 및 Miplatform™ "+_s+"(마이플랫폼)";_g="Miplatform "+_s;}else if(_h=="XP"){_s=this.gfnIsEmpty(this.cmb_ProductVer.text)?"v9.2":this.cmb_ProductVer.text;_c="REA 및 XPLATFORM™ "+_s+"(엑스플랫폼)";_g="XPLATFORM "+_s;}else if(_h=="NP14"){_c="nexacro platform 14™ "+_m;_g="nexacro platform 14";}else if(_h=="NP17"){_c="nexacro platform 17™ "+_m;_g="nexacro platform 17";}else if(_h=="NPN"){_c="NEXACRO N™ "+_m;_g="NEXACRO N";}this.ds_print.setColumn(_f,"product_nm",_g);this.ds_print.setColumn(_f,"course_nm",_c);this.ds_print.setColumn(_f,"getTime",_n);if(this.ds_main.getColumn(_t,"EDU_TYPE_DET")=="010"||this.ds_main.getColumn(_t,"EDU_TYPE_DET")=="011"){this.ds_print.setColumn(_f,"period",_i+" ~ "+_j);}else{this.ds_print.setColumn(_f,"period",_i);}this.ds_print.setColumn(_f,"yyyy",_k[0]);this.ds_print.setColumn(_f,"mm",_k[1]);this.ds_print.setColumn(_f,"dd",_k[2]);this.ds_print.setColumn(_f,"CEO_NAME",this.dsCompanyList.getColumn(0,"CEO_NAME"));this.ds_print.setColumn(_f,"imgLogo",_e+"NEXTp/Report/edu_Certificate_Logo.jpg");this.ds_print.setColumn(_f,"imgStamp",_e+"NEXTp/Report/edu_Certificate_Stamp.jpg");if(this.cmb_Border.value=="y"||_b){this.ds_print.setColumn(_f,"outLine",_e+"NEXTp/Report/edu_Certificate_Outline.jpg");}}};this.getDate=function(){var _b=new Date();var _c="",_d="",_e="",_f="";_c=parseInt(_b.getMonth())+1;_d=parseInt(_b.getDate());_e=_c.toString().padLeft(2,"0");_f=_d.toString().padLeft(2,"0");return _b.getYear()+"-"+_e+"-"+_f;};});this.on_initEvent=function(){this.addEventHandler("onload",this.TE_CertificateInfoReg_onload,this);this.btn_Close.addEventHandler("onclick",this.comm_Click,this);this.btn_Preview.addEventHandler("onclick",this.comm_Click,this);this.btn_EmailSend.addEventHandler("onclick",this.comm_Click,this);};this.loadIncludeScript("TE_CertificateInfoReg.xfdl");this.loadPreloadList();_a=null;};})();