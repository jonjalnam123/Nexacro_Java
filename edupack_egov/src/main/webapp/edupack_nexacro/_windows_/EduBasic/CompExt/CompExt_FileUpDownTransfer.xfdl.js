(function(){return function(){if(!this._is_form){return;}var _a=null;this.on_create=function(){this.set_name("FileUpDown");this.set_titletext("New Form");this.set_border("");this.set_background("");if(Form==this.constructor){this._setFormPosition(1038,650);}_a=new Dataset("dsUpload",this);_a._setContents("<ColumnInfo><Column id=\"CHK\" type=\"STRING\" size=\"256\"/><Column id=\"FILE_NAME\" type=\"STRING\" size=\"256\"/><Column id=\"FILE_PATH\" type=\"STRING\" size=\"256\"/><Column id=\"DEPTH\" type=\"STRING\" size=\"256\"/><Column id=\"STATUS\" type=\"STRING\" size=\"256\"/><Column id=\"FiLE_SIZE\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("dsDownload",this);_a._setContents("<ColumnInfo><Column id=\"CHK\" type=\"STRING\" size=\"256\"/><Column id=\"FILE_NAME\" type=\"STRING\" size=\"256\"/><Column id=\"FILE_PATH\" type=\"STRING\" size=\"256\"/><Column id=\"DEPTH\" type=\"STRING\" size=\"256\"/><Column id=\"STATUS\" type=\"STRING\" size=\"256\"/><Column id=\"FiLE_SIZE\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new FileUpTransfer("fileUpTrans",this);this.addChild(_a.name,_a);_a=new FileDownTransfer("fileDownTrans",this);this.addChild(_a.name,_a);_a=new FileDialog("fileDialog",this);this.addChild(_a.name,_a);_a=new Static("Static02","10","371","250","28",null,null,null,null,null,null,this);_a.set_taborder("0");_a.set_text("FileDownload");_a.set_positionstep("0");_a.set_cssclass("sta_WF_LabelTxt12");this.addChild(_a.name,_a);_a=new Static("Static56","10","73","250","28",null,null,null,null,null,null,this);_a.set_taborder("1");_a.set_text("FileUpload");_a.set_positionstep("0");_a.set_cssclass("sta_WF_LabelTxt12");this.addChild(_a.name,_a);_a=new Button("btnDel",null,"73","69","28","87",null,null,null,null,null,this);_a.set_taborder("2");_a.set_text("delete");_a.set_positionstep("0");this.addChild(_a.name,_a);_a=new Grid("grdFileUpload","10","106",null,"210","10",null,null,null,null,null,this);_a.set_taborder("3");_a.set_binddataset("dsUpload");_a.set_autofittype("col");_a.set_nodatatext("You can attach files by dragging them.");_a.set_positionstep("0");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"42\" band=\"left\"/><Column size=\"152\"/><Column size=\"320\"/><Column size=\"80\"/></Columns><Rows><Row size=\"30\" band=\"head\"/><Row size=\"30\"/></Rows><Band id=\"head\"><Cell displaytype=\"checkboxcontrol\" edittype=\"checkbox\" text=\"0\"/><Cell col=\"1\" text=\"FILE_NAME\"/><Cell col=\"2\" text=\"FILE_URL\"/><Cell col=\"3\" text=\"SIZE\"/></Band><Band id=\"body\"><Cell displaytype=\"checkboxcontrol\" edittype=\"checkbox\" text=\"bind:CHK\"/><Cell col=\"1\" text=\"bind:FILE_NAME\" displaytype=\"normal\" edittype=\"none\" treelevel=\"bind:DEPTH\"/><Cell col=\"2\" text=\"bind:FILE_PATH\"/><Cell col=\"3\" treelevel=\"bind:DEPTH\" text=\"bind:FiLE_SIZE\"/></Band></Format></Formats>");this.addChild(_a.name,_a);_a=new Button("btnSave",null,"73","69","28","14",null,null,null,null,null,this);_a.set_taborder("4");_a.set_text("upload");_a.set_positionstep("0");this.addChild(_a.name,_a);_a=new Grid("grdFileDownload","10","404",null,"240","10",null,null,null,null,null,this);_a.set_taborder("5");_a.set_binddataset("dsDownload");_a.set_autofittype("col");_a.set_positionstep("0");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"35\" band=\"left\"/><Column size=\"152\"/><Column size=\"320\"/><Column size=\"80\"/></Columns><Rows><Row size=\"30\" band=\"head\"/><Row size=\"30\"/></Rows><Band id=\"head\"><Cell displaytype=\"checkboxcontrol\" edittype=\"checkbox\" text=\"0\"/><Cell col=\"1\" text=\"FILE_NAME\"/><Cell col=\"2\" text=\"FILE_URL\"/><Cell col=\"3\" text=\"SIZE\"/></Band><Band id=\"body\"><Cell displaytype=\"checkboxcontrol\" edittype=\"checkbox\" text=\"bind:CHK\"/><Cell col=\"1\" text=\"bind:FILE_NAME\" displaytype=\"normal\" edittype=\"none\" treelevel=\"bind:DEPTH\"/><Cell col=\"2\" text=\"bind:FILE_PATH\"/><Cell col=\"3\" treelevel=\"bind:DEPTH\" text=\"bind:FiLE_SIZE\"/></Band></Format></Formats>");this.addChild(_a.name,_a);_a=new Button("btnDonwload",null,"371","106","28","12",null,null,null,null,null,this);_a.set_taborder("6");_a.set_text("All DownLoad");_a.set_positionstep("0");_a.set_cssclass("btn_WF_basic01");this.addChild(_a.name,_a);_a=new Button("btnSearch",null,"371","106","28","124",null,null,null,null,null,this);_a.set_taborder("7");_a.set_text("Get List");_a.set_positionstep("0");this.addChild(_a.name,_a);_a=new Button("btnAdd",null,"73","69","28","161",null,null,null,null,null,this);_a.set_taborder("8");_a.set_text("add");this.addChild(_a.name,_a);_a=new Static("Static03","10","40","250","28",null,null,null,null,null,null,this);_a.set_taborder("9");_a.set_text(" Basic Usage");_a.set_cssclass("sta_WF_TitleType1");this.addChild(_a.name,_a);_a=new Static("sta00","10","0","316","28",null,null,null,null,null,null,this);_a.set_taborder("10");_a.set_text("File Upload / Download Transfer");_a.set_cssclass("sta_WF_TitleMain");this.addChild(_a.name,_a);_a=new Layout("default","",1038,650,this,function(_b){var _c=_b;_b=_c;_b.set_titletext("New Form");_b.set_border("");_b.set_background("");_b.Static02.set_taborder("0");_b.Static02.set_text("FileDownload");_b.Static02.set_positionstep("0");_b.Static02.set_cssclass("sta_WF_LabelTxt12");_b.Static02.move("10","371","250","28",null,null);_b.Static56.set_taborder("1");_b.Static56.set_text("FileUpload");_b.Static56.set_positionstep("0");_b.Static56.set_cssclass("sta_WF_LabelTxt12");_b.Static56.move("10","73","250","28",null,null);_b.btnDel.set_taborder("2");_b.btnDel.set_text("delete");_b.btnDel.set_positionstep("0");_b.btnDel.move(null,"73","69","28","87",null);_b.grdFileUpload.set_taborder("3");_b.grdFileUpload.set_binddataset("dsUpload");_b.grdFileUpload.set_autofittype("col");_b.grdFileUpload.set_nodatatext("You can attach files by dragging them.");_b.grdFileUpload.set_positionstep("0");_b.grdFileUpload.move("10","106",null,"210","10",null);_b.btnSave.set_taborder("4");_b.btnSave.set_text("upload");_b.btnSave.set_positionstep("0");_b.btnSave.move(null,"73","69","28","14",null);_b.grdFileDownload.set_taborder("5");_b.grdFileDownload.set_binddataset("dsDownload");_b.grdFileDownload.set_autofittype("col");_b.grdFileDownload.set_positionstep("0");_b.grdFileDownload.move("10","404",null,"240","10",null);_b.btnDonwload.set_taborder("6");_b.btnDonwload.set_text("All DownLoad");_b.btnDonwload.set_positionstep("0");_b.btnDonwload.set_cssclass("btn_WF_basic01");_b.btnDonwload.move(null,"371","106","28","12",null);_b.btnSearch.set_taborder("7");_b.btnSearch.set_text("Get List");_b.btnSearch.set_positionstep("0");_b.btnSearch.move(null,"371","106","28","124",null);_b.btnAdd.set_taborder("8");_b.btnAdd.set_text("add");_b.btnAdd.move(null,"73","69","28","161",null);_b.Static03.set_taborder("9");_b.Static03.set_text(" Basic Usage");_b.Static03.set_cssclass("sta_WF_TitleType1");_b.Static03.move("10","40","250","28",null,null);_b.sta00.set_taborder("10");_b.sta00.set_text("File Upload / Download Transfer");_b.sta00.set_cssclass("sta_WF_TitleMain");_b.sta00.move("10","0","316","28",null,null);});_a.set_stepcount("0");this.addLayout(_a.name,_a);_a=new Layout("mobile","",480,1050,this,function(_b){var _c=_b;_b=_c;_b.Static02.set_text("FileDownload");_b.Static02.move("20","592","220","40",null,null);_b.Static56.move("20","144","220","40",null,null);_b.btnDel.move(null,"194","90","46","115",null);_b.grdFileUpload.set_cssclass("grd_WF_FileUpload");_b.grdFileUpload.move("20","247",null,"320","20",null);_b.btnSave.move(null,"194","90","46","20",null);_b.grdFileDownload.set_cssclass("grd_WF_FileDownload");_b.grdFileDownload.move("20","697",null,"320","20",null);_b.btnDonwload.move(null,"644","126","46","20",null);_b.btnSearch.move(null,"644","150","46","151",null);_b.btnAdd.move(null,"194","90","46","210",null);});_a.set_mobileorientation("portrait");_a.set_stepcount("0");this.addLayout(_a.name,_a);};this.loadPreloadList=function(){};this.registerScript("CompExt_FileUpDownTransfer.xfdl",function(){this.uploadPath="/upload";this.fnAddFileList=function(_b){var _c,_d;for(var _h=0;_h<_b.length;_h++ ){var _e=_b[_h].filename;var _f=this.fileUpTrans.addFile(_e,_b[_h]);var _g=this.dsUpload.addRow();this.dsUpload.setColumn(_g,"FILE_NAME",_e);}};this.fnUploadFile=function(){var _b="EduUrl::fileUpload.jsp?PATH="+this.uploadPath;this.fileUpTrans.upload(_b);};this.fnDownloadFile=function(_b){this.fileDownTrans.clearPostDataList();this.fileDownTrans.set_downloadfilename(this.dsDownload.getColumn(_b,"FILE_NAME"));this.fileDownTrans.setPostData("filepath",this.dsDownload.getColumn(_b,"FILE_URL"));this.fileDownTrans.setPostData("filename",this.dsDownload.getColumn(_b,"FILE_NAME"));this.fileDownTrans.setPostData("filefolder","fileSample");this.fileDownTrans.download("EduUrl::fileDownTransferSingle.jsp");};this.fnDownloadFileAll=function(){this.fileDownTrans.clearPostDataList();var _b=new Array();for(var _c=0;_c<this.dsDownload.getRowCount();_c++ ){if(this.dsDownload.getColumn(_c,"CHK")==1){_b.push(this.dsDownload.getColumn(_c,"FILE_NAME"));}}this.fileDownTrans.set_downloadfilename("fileSample.zip");this.fileDownTrans.setPostData("filenamelist",_b);this.fileDownTrans.download("EduUrl::fileDownTransferMulti.jsp?filefolder="+"fileSample");};this.fnGetFileSize=function(_b){var _c=_b+" bytes";for(var _d=["KB","MB","GB","TB","PB","EB","ZB","YB"],_e=0,_f=_b/1024;_f>1;_f/=1024,_e++ ){_c=_f.toFixed(3)+" "+_d[_e];}return _c;};this.fnCallbackTransaction=function(_b,_c,_d){trace(_c+" ========= "+_d);if(_b=="list"){this.dsDownload.set_enableevent(false);this.dsDownload.addColumn("CHK","STRING",255);for(var _e=0;_e<this.dsDownload.getRowCount();_e++ ){this.dsDownload.setColumn(_e,"CHK",0);this.dsDownload.setColumn(_e,"FiLE_SIZE",this.fnGetFileSize(this.dsDownload.getColumn(_e,"FiLE_SIZE")));}this.dsDownload.set_enableevent(true);}};this.btnAdd_onclick=function(_a,_b){this.fileDialog.open('fileselect',FileDialog.MULTILOAD);};this.btnDel_onclick=function(_a,_b){var _c=this.grdFileUpload.getCellPropertyValue(0,0,"text");var _d=this.dsUpload.rowcount;if(_c==1){for(var _g=0;_g<_d;_g++ ){this.dsUpload.deleteRow((this.dsUpload.rowcount-1));var _e=this.fileUpTrans.filelist[(this.dsUpload.rowcount-1)];this.fileUpTrans.removeFile(_e);}}else{var _f=this.dsUpload.rowposition;this.dsUpload.deleteRow(_f);var _e=this.fileUpTrans.filelist[_f];this.fileUpTrans.removeFile(_e);}};this.btnSave_onclick=function(_a,_b){this.setWaitCursor(true);this.fnUploadFile();};this.btnSearch_onclick=function(_a,_b){trace(this.serverURL+"fileDownload_servlet_list_XML.jsp");trace("filefolder="+this.uploadPath);this.transaction("list","EduUrl::fileDownTransferFileList.jsp","","dsDownload=dsList","filefolder="+this.uploadPath,"fnCallbackTransaction");};this.btnDonwload_onclick=function(_a,_b){if(this.dsDownload.getCaseCount("CHK == '1'")<1){alert("You must select 1 item.");}else{if(this.dsDownload.getCaseCount("CHK == '1'")>1){this.fnDownloadFileAll();}else{var _c=this.dsDownload.filterRow("CHK",1);this.fnDownloadFile(_c);}}};this.grdFileUpload_ondrop=function(_a,_b){if(_b.datatype=="file"){this.fnAddFileList(_b.filelist);}};this.fileDialog_onclose=function(_a,_b){this.fnAddFileList(_b.virtualfiles);};this.fileList_onsuccess=function(_a,_b){if(_b.reason==9){var _c=this.dsUpload.addRow();this.dsUpload.setColumn(_c,"FILE_NAME",_a.filename);this.dsUpload.setColumn(_c,"FiLE_SIZE",this.fnGetFileSize(_b.filesize));this.dsUpload.setColumn(_c,"FILE_PATH",_a.fullpath);}};this.fileList_onerror=function(_a,_b){trace("errortype: "+_b.errortype);trace("errormsg: "+_b.errormsg);trace("statuscode: "+_b.statuscode);};this.fileUpTrans_onsuccess=function(_a,_b){this.setWaitCursor(false);var _c=_b.datasets[0];trace(_b.datasets[0].saveXML());for(var _e=0;_e<_c.getRowCount();_e++ ){var _d=this.dsUpload.findRow("FILE_NAME",_c.getColumn(_e,"FILE_NAME"));if(_d> -1){this.dsUpload.setColumn(_d,"FILE_PATH",_c.getColumn(_e,"FILE_PATH"));this.dsUpload.setColumn(_d,"FiLE_SIZE",_c.getColumn(_e,"FiLE_SIZE"));}}alert("success");};this.fileUpTrans_onerror=function(_a,_b){this.setWaitCursor(false);alert(_b.errortype+">>"+_b.errormsg);};this.grdFileDownload_onheadclick=function(_a,_b){if(_b.col==0){var _c=_a.getCellPropertyValue(_b.row,_b.cell,"text");if(_c==0){_a.setCellProperty("head",_b.cell,"text",1);for(var _d=0;_d<this.dsDownload.rowcount;_d++ ){this.dsDownload.setColumn(_d,"CHK",1);}}else{_a.setCellProperty("head",_b.cell,"text",0);for(var _d=0;_d<this.dsDownload.rowcount;_d++ ){this.dsDownload.setColumn(_d,"CHK",0);}}}};this.grdFileDownload_oncelldblclick=function(_a,_b){this.fnDownloadFile(_b.row);};this.fileDownTrans_onsuccess=function(_a,_b){trace(_b.targetfullpath);};this.fileDownTrans_onerror=function(_a,_b){trace("error : "+_b.errormsg);};this.btn00_onclick=function(_a,_b){this.fileDialog.open('fileselect',FileDialog.MULTILOAD);};});this.on_initEvent=function(){this.btnDel.addEventHandler("onclick",this.btnDel_onclick,this);this.grdFileUpload.addEventHandler("ondrop",this.grdFileUpload_ondrop,this);this.btnSave.addEventHandler("onclick",this.btnSave_onclick,this);this.grdFileDownload.addEventHandler("oncelldblclick",this.grdFileDownload_oncelldblclick,this);this.grdFileDownload.addEventHandler("onheadclick",this.grdFileDownload_onheadclick,this);this.btnDonwload.addEventHandler("onclick",this.btnDonwload_onclick,this);this.btnSearch.addEventHandler("onclick",this.btnSearch_onclick,this);this.btnAdd.addEventHandler("onclick",this.btnAdd_onclick,this);this.fileUpTrans.addEventHandler("onerror",this.fileUpTrans_onerror,this);this.fileUpTrans.addEventHandler("onsuccess",this.fileUpTrans_onsuccess,this);this.fileDownTrans.addEventHandler("onsuccess",this.fileDownTrans_onsuccess,this);this.fileDownTrans.addEventHandler("onerror",this.fileDownTrans_onerror,this);this.fileDialog.addEventHandler("onclose",this.fileDialog_onclose,this);};this.loadIncludeScript("CompExt_FileUpDownTransfer.xfdl");this.loadPreloadList();_a=null;};})();