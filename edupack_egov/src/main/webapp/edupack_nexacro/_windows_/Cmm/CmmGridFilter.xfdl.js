(function(){return function(){if(!this._is_form){return;}var _a=null;this.on_create=function(){this.set_name("CmmGridFilter");this.set_titletext("그리드 필터");if(Form==this.constructor){this._setFormPosition(470,310);}_a=new Dataset("dsFilterType",this);_a._setContents("<ColumnInfo><Column id=\"code\" type=\"STRING\" size=\"256\"/><Column id=\"name\" type=\"STRING\" size=\"256\"/></ColumnInfo><Rows><Row/><Row><Col id=\"code\">=</Col><Col id=\"name\">같은</Col></Row><Row><Col id=\"code\">&gt;</Col><Col id=\"name\">보다 큰</Col></Row><Row><Col id=\"code\">&lt;</Col><Col id=\"name\">보다 작은</Col></Row><Row><Col id=\"code\">!=</Col><Col id=\"name\">같지않는</Col></Row><Row><Col id=\"code\">like</Col><Col id=\"name\">포함하는</Col></Row><Row><Col id=\"code\">nolike</Col><Col id=\"name\">포함하지 않는</Col></Row></Rows>");this.addChild(_a.name,_a);_a=new Dataset("dsFilter",this);_a.getSetter("firefirstcount").set("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"title\" type=\"STRING\" size=\"256\"/><Column id=\"filtertype\" type=\"STRING\" size=\"256\"/><Column id=\"columid\" type=\"STRING\" size=\"256\"/><Column id=\"filtervalue\" type=\"STRING\" size=\"256\"/><Column id=\"displaytype\" type=\"STRING\" size=\"256\"/><Column id=\"combocodecol\" type=\"STRING\" size=\"256\"/><Column id=\"combodatacol\" type=\"STRING\" size=\"256\"/><Column id=\"combodataset\" type=\"STRING\" size=\"256\"/><Column id=\"col\" type=\"INT\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Dataset("dsTemp",this);_a.getSetter("firefirstcount").set("0");_a.getSetter("firenextcount").set("0");_a.set_useclientlayout("false");_a.set_updatecontrol("true");_a.set_enableevent("true");_a.set_loadkeymode("keep");_a.set_loadfiltermode("keep");_a.set_reversesubsum("false");_a._setContents("<ColumnInfo><Column id=\"title\" type=\"STRING\" size=\"256\"/><Column id=\"col\" type=\"INT\" size=\"256\"/><Column id=\"body\" type=\"STRING\" size=\"256\"/><Column id=\"filtertype\" type=\"STRING\" size=\"256\"/><Column id=\"displaytype\" type=\"STRING\" size=\"256\"/><Column id=\"edittype\" type=\"STRING\" size=\"256\"/><Column id=\"combodatacol\" type=\"STRING\" size=\"256\"/><Column id=\"combocodecol\" type=\"STRING\" size=\"256\"/><Column id=\"combodataset\" type=\"STRING\" size=\"256\"/><Column id=\"filtervalue\" type=\"STRING\" size=\"256\"/></ColumnInfo>");this.addChild(_a.name,_a);_a=new Grid("grd00","11","45","449","220",null,null,null,null,null,null,this);_a.set_taborder("0");_a.set_binddataset("dsFilter");_a.set_autofittype("col");_a.getSetter("griduserproperty").set("!sort,!rowfix,!colfix,!filter,!initial");_a._setContents("<Formats><Format id=\"default\"><Columns><Column size=\"175\"/><Column size=\"66\"/><Column size=\"190\"/></Columns><Rows><Row size=\"28\" band=\"head\"/><Row size=\"32\"/></Rows><Band id=\"head\"><Cell text=\"컬럼명\" expandchar=\"popup.columnname\"/><Cell col=\"1\" text=\"필터기준\" expandchar=\"popup.filtercriteria\"/><Cell col=\"2\" text=\"찾을조건\" expandchar=\"popup.findcondition\"/></Band><Band id=\"body\"><Cell text=\"bind:title\" displaytype=\"text\" edittype=\"none\" combodataset=\"dsFilterCol\" combodatacol=\"columnName\" combocodecol=\"columnId\"/><Cell col=\"1\" displaytype=\"combocontrol\" edittype=\"combo\" combodataset=\"dsFilterType\" combodatacol=\"name\" combocodecol=\"code\" text=\"bind:filtertype\"/><Cell col=\"2\" text=\"bind:filtervalue\" displaytype=\"editcontrol\" edittype=\"text\"/></Band></Format></Formats>");this.addChild(_a.name,_a);_a=new Button("btnFilterCancel","326","10","65","30",null,null,null,null,null,null,this);_a.set_taborder("1");_a.set_text("필터취소");_a.getSetter("uWord").set("popup.cancel");this.addChild(_a.name,_a);_a=new Button("btnUp","396","10","30","30",null,null,null,null,null,null,this);_a.set_taborder("2");_a.set_cssclass("btn_WF_ShuttleT");this.addChild(_a.name,_a);_a=new Button("btnDown","431","10","30","30",null,null,null,null,null,null,this);_a.set_taborder("3");_a.set_cssclass("btn_WF_ShuttleB");this.addChild(_a.name,_a);_a=new Button("btnSetFilter","335","270","60","28",null,null,null,null,null,null,this);_a.set_taborder("4");_a.set_text("적용");_a.getSetter("uWord").set("popup.apply");_a.set_cssclass("btn_POP_Btn");this.addChild(_a.name,_a);_a=new Button("btnClose","400","270","60","28",null,null,null,null,null,null,this);_a.set_taborder("5");_a.set_text("닫기");_a.getSetter("uWord").set("popup.close");_a.set_cssclass("btn_POP_Btn");this.addChild(_a.name,_a);_a=new Layout("default","",470,310,this,function(_b){});_a.set_mobileorientation("landscape");this.addLayout(_a.name,_a);};this.loadPreloadList=function(){};this.registerScript("CmmGridFilter.xfdl",function(){this.fvTargetGrid;this.fvTargetDataset;this.form_onload=function(_a,_b){this.gfnFormOnLoad(this);this.fvTargetGrid=this.getOwnerFrame().pvGrid;this.fvTargetDataset=this.fvTargetGrid.getBindDataset();var _c=this._gfnGridUserHeaderFlg(this.fvTargetGrid);if(!_c){this.fnGetHeadText(this.fvTargetGrid);}else{this.fnGetUserHeader(this.fvTargetGrid);}};this.fnGetUserHeader=function(_b){var _c=_b.getCellCount("head");for(var _i=0;_i<_c;_i++ ){var _d=_b.getCellProperty("head",_i,"calendarweekformat");if(this.gfnIsNull(_d)){continue;}for(var _j=0;_j<_b.getCellCount("body");_j++ ){var _e=0;if(_d==_b.getCellProperty("body",_j,"text")){_e=_j;var _f=_b.getCellProperty("body",_e,"text");var _g=this.dsTemp.addRow();var _h=_b.getCellProperty("body",_e,"displaytype");if(_h=="combotext"||_h=="combocontrol"){_h="combo";_f=_b.getCellProperty("body",_e,"text").substring(5);this.fvTargetDataset.set_enableevent(false);this.fvTargetDataset.set_updatecontrol(false);this.fvTargetDataset.addColumn(_f+"_text");for(var _k=0;_k<this.fvTargetDataset.getRowCount();_k++ ){this.fvTargetDataset.setColumn(_k,_f+"_text",this.fvTargetGrid.getCellText(_k,_j));}this.fvTargetDataset.set_enableevent(true);this.fvTargetDataset.set_updatecontrol(true);trace("columname :: "+_f);this.dsTemp.setColumn(_g,"body","bind:"+_f+"_text");}else{this.dsTemp.setColumn(_g,"body",_f);}this.dsTemp.setColumn(_g,"col",_j);this.dsTemp.setColumn(_g,"displaytype",_h);this.dsTemp.setColumn(_g,"combocodecol",_b.getCellProperty("body",_j,"combocodecol"));this.dsTemp.setColumn(_g,"combodatacol",_b.getCellProperty("body",_j,"combodatacol"));this.dsTemp.setColumn(_g,"combodataset",_b.getCellProperty("body",_j,"combodataset"));this.dsTemp.setColumn(_g,"title",_b.getCellProperty("head",_i,"text"));}}}this.fnFilterSetup();};this.fnGetHeadText=function(_b){for(var _l=0;_l<_b.getCellCount("Body");_l++ ){if(_b.getCellProperty("Body",_l,"displaytype")!="image"){var _c=_b.getCellProperty("Body",_l,"text");if(_c=="bind:gridcmmcheck"){continue;}var _d;if(this.gfnIsNull(_c)==false){_d=_c.substr(0,5);}else{_d="";}if(_d=="bind:"){var _e=this.dsTemp.addRow();var _f="text";if(_b.getCellProperty("Body",_l,"displaytype")=="combotext"||_b.getCellProperty("Body",_l,"displaytype")=="combocontrol"){_f="combo";var _g=_b.getCellProperty("Body",_l,"text").substring(5);if(this.gfnIsNull(this.fvTargetDataset.getColumnInfo(_g+"_text"))){this.fvTargetDataset.set_enableevent(false);this.fvTargetDataset.set_updatecontrol(false);this.fvTargetDataset.addColumn(_g+"_text");for(var _m=0;_m<this.fvTargetDataset.getRowCount();_m++ ){this.fvTargetDataset.setColumn(_m,_g+"_text",this.fvTargetGrid.getCellText(_m,_l));}this.fvTargetDataset.set_enableevent(true);this.fvTargetDataset.set_updatecontrol(true);}this.dsTemp.setColumn(_e,"body","bind:"+_g+"_text");}else{this.dsTemp.setColumn(_e,"body",_b.getCellProperty("Body",_l,"text"));}this.dsTemp.setColumn(_e,"col",_l);this.dsTemp.setColumn(_e,"displaytype",_f);this.dsTemp.setColumn(_e,"combocodecol",_b.getCellProperty("Body",_l,"combocodecol"));this.dsTemp.setColumn(_e,"combodatacol",_b.getCellProperty("Body",_l,"combodatacol"));this.dsTemp.setColumn(_e,"combodataset",_b.getCellProperty("Body",_l,"combodataset"));}}}for(var _l=0;_l<_b.getCellCount("Head");_l++ ){var _h=_b.getCellProperty("Head",_l,"text");var _i=_b.getCellProperty("Head",_l,"col");var _j=_b.getCellProperty("Body",_l,"text");var _k=_b.getCellProperty("Body",_i,"displaytype");if(_k=="combotext"||_k=="combocontrol"){_j="bind:"+_j.substring(5)+"_text";}var _e=this.dsTemp.findRow("body",_j);if(_e!= -1){this.dsTemp.setColumn(_e,"title",_h);}}this.fnFilterSetup();};this.fnFilterSetup=function(){var _b=new Array();var _c=this.fvTargetDataset.filterstr;var _d=_c.split("&&");for(var _n=0;_n<_d.length;_n++ ){var _e=_d[_n].trim();var _f="";var _g="";var _h="";var _i=_e.split("'")[1];for(var _o=0;_o<_e.length;_o++ ){if("1234567890_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".indexOf(_e.charAt(_o))== -1){_f=_e.substring(0,_o);_g=_e.substring(_o);break;}}if(_g.indexOf("indexOf")!= -1){if(_g.indexOf("==")!= -1){_h="notlike";}else{_h="like";}}else{if(_g.indexOf("==")!= -1){_h="=";}else if(_g.indexOf("!=")!= -1){_h="!=";}else if(_g.indexOf(">")!= -1){_h=">";}else if(_g.indexOf("<")!= -1){_h="<";}}_b.push({body:"bind:"+_f,filtertype:_h,filtervalue:_i});}for(var _n=0;_n<_b.length;_n++ ){var _j=this.dsTemp.findRow("body",_b[_n].body);this.dsTemp.setColumn(_j,"col", -(_b.length-_n));this.dsTemp.setColumn(_j,"filtertype",_b[_n].filtertype);this.dsTemp.setColumn(_j,"filtervalue",_b[_n].filtervalue);}this.dsTemp.set_keystring("S:col");for(var _n=0;_n<this.dsTemp.getRowCount();_n++ ){var _k=this.dsTemp.getColumn(_n,"body").substring(5);var _l=this.dsTemp.getColumn(_n,"title");if(this.gfnIsNull(_l)==false){var _m=this.dsFilter.addRow();this.dsFilter.setColumn(_m,"title",_l);this.dsFilter.setColumn(_m,"filtertype",this.dsTemp.getColumn(_n,"filtertype"));this.dsFilter.setColumn(_m,"filtervalue",this.dsTemp.getColumn(_n,"filtervalue"));this.dsFilter.setColumn(_m,"columid",_k);this.dsFilter.setColumn(_m,"displaytype",this.dsTemp.getColumn(_n,"displaytype"));this.dsFilter.setColumn(_m,"combocodecol",this.dsTemp.getColumn(_n,"combocodecol"));this.dsFilter.setColumn(_m,"combodatacol",this.dsTemp.getColumn(_n,"combodatacol"));this.dsFilter.setColumn(_m,"combodataset",this.dsTemp.getColumn(_n,"combodataset"));}}this.dsFilter.set_rowposition( -1);};this.btnFilterCancel_onclick=function(_a,_b){this.fvTargetDataset.set_filterstr("");};this.btnUp_onclick=function(_a,_b){var _c=this.dsFilter.rowposition;if(_c==0){return;}this.dsFilter.moveRow(_c, --_c);};this.btnDown_onclick=function(_a,_b){var _c=this.dsFilter.rowposition;if(_c==this.dsFilter.getRowCount()-1){return;}this.dsFilter.moveRow(_c, ++_c);};this.btnSetFilter_onclick=function(_a,_b){var _c=this.fvTargetDataset;var _d="";for(var _i=0;_i<this.dsFilter.getRowCount();_i++ ){var _e=this.dsFilter.getColumn(_i,"columid");var _f=this.dsFilter.getColumn(_i,"filtervalue");var _g=this.dsFilter.getColumn(_i,"filtertype");if(!this.gfnIsNull(_g)&&!this.gfnIsNull(_f)){var _h="";if(_g=="="){_h=_e+"=='"+_f+"'";}else if(_g=="!="){_h=_e+"!='"+_f+"'";}else if(_g==">"){_h=_e+">'"+_f+"'";}else if(_g=="<"){_h=_e+"<'"+_f+"'";}else if(_g=="like"){_h=_e+".indexOf('"+_f+"')!=-1";}else if(_g=="notlike"){_h=_e+".indexOf('"+_f+"')==-1";}if(this.gfnIsNull(_d)){_d=_h;}else{_d+=" && "+_h;}}}_c.set_filterstr(_d);};this.btnClose_onclick=function(_a,_b){this.close();};});this.on_initEvent=function(){this.addEventHandler("onload",this.form_onload,this);this.btnFilterCancel.addEventHandler("onclick",this.btnFilterCancel_onclick,this);this.btnUp.addEventHandler("onclick",this.btnUp_onclick,this);this.btnDown.addEventHandler("onclick",this.btnDown_onclick,this);this.btnSetFilter.addEventHandler("onclick",this.btnSetFilter_onclick,this);this.btnClose.addEventHandler("onclick",this.btnClose_onclick,this);};this.loadIncludeScript("CmmGridFilter.xfdl");this.loadPreloadList();_a=null;};})();